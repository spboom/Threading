window.$P=function(){};optimizelyCode=function(data){var blankExperimentData={log_host:"log.optimizely.com",www_host:"www.optimizely.com"};var DATA=data||blankExperimentData;var integrator={};var optly={nativity:{},domain:{},Cleanse:{},taint:{},match:{}};var distributor={};var query={};var redirect={};var detect={};var directive={};var json={};var tracker={};var template={};var preview={};var ajax={};var cookie={};var user={};var iapi={};var evaluator={};var data={};var condition={};var main={};var segmenter={};var timer={};var api={};var common={};var plan={};optly.nativity.getNativeGetElementsByClassName=function(){var nativeGetByClass=document.getElementsByClassName;if(!optly.nativity.isNativeFunction(nativeGetByClass)){var optimizely=window.optimizely||{};var optimizelyGetByClass=optimizely.getElementsByClassName;var optly_=window.optly||{};var optlyGetByClass=optly_.getElementsByClassName;if(optly.nativity.isNativeFunction(optimizelyGetByClass)){nativeGetByClass=optimizelyGetByClass}else{if(optly.nativity.isNativeFunction(optlyGetByClass)){nativeGetByClass=optlyGetByClass}else{nativeGetByClass=null}}}return nativeGetByClass};optly.nativity.isNativeFunction=function(function_){return function_&&String(function_).indexOf("[native code]")!==-1};optly.Cleanse.each=function(object,function_,context){var hasLookupGetter=!!Object.prototype.__lookupGetter__;var hasLookupSetter=!!Object.prototype.__lookupSetter__;for(var key in object){if(object.hasOwnProperty(key)){var getter=hasLookupGetter?object.__lookupGetter__(key):null;var setter=hasLookupSetter?object.__lookupSetter__(key):null;try{var value=!getter?object[key]:null;function_.call(context,key,value,getter,setter)}catch(err){}}}};optly.Cleanse.finish=function(){if(optly.Cleanse.running){optly.Cleanse.running=false;optly.Cleanse.each(optly.Cleanse.types,function(typeName,type){if(Object.prototype.__defineGetter__){var getters=optly.Cleanse.getters[typeName];optly.Cleanse.each(getters,function(propertyName,getter){type.prototype.__defineGetter__(propertyName,getter);optly.Cleanse.log("restored getter",typeName,propertyName)})}if(Object.prototype.__defineSetter__){var setters=optly.Cleanse.setters[typeName];optly.Cleanse.each(setters,function(propertyName,setter){type.prototype.__defineSetter__(propertyName,setter);optly.Cleanse.log("restored setter",typeName,propertyName)})}var properties=optly.Cleanse.properties[typeName];optly.Cleanse.each(properties,function(propertyName,property){type.prototype[propertyName]=property;optly.Cleanse.log("restored property",typeName,propertyName)})});optly.Cleanse.unfixGetElementsByClassName();optly.Cleanse.log("finish");var console=window.console;var param="optimizely_log=true";var log=window.location.hash.indexOf(param)!==-1||window.location.search.indexOf(param)!==-1;if(log&&console&&console.log){var logs=optly.Cleanse.logs;for(var i=0;i<logs.length;i++){console.log(logs[i])}}}};optly.Cleanse.log=function(action,typeName,propertyName){if(typeName){typeName=typeName.replace(/_/g,"");optly.Cleanse.logs.push("Optimizely / Info / Cleanse / "+action+": "+typeName+"."+propertyName)}else{optly.Cleanse.logs.push("Optimizely / Info / Cleanse / "+action)}};optly.Cleanse.start=function(){var hostname=window.location.hostname;if(hostname.indexOf("optimizely")!==-1&&hostname.indexOf("edit")===-1&&hostname.indexOf("preview")===-1&&hostname.indexOf("test")===-1){return}if(optly.Cleanse.running){optly.Cleanse.log("already running so didn't start");return}optly.Cleanse.log("start");optly.Cleanse.running=true;for(var type in optly.Cleanse.types){if(!optly.Cleanse.types[type]){delete optly.Cleanse.types[type]}}optly.Cleanse.each(optly.Cleanse.types,function(typeName,type){optly.Cleanse.getters[typeName]={};optly.Cleanse.properties[typeName]={};optly.Cleanse.setters[typeName]={};optly.Cleanse.each(type.prototype,function(propertyName,property,getter,setter){if(optly.nativity.isNativeFunction(property)||optly.nativity.isNativeFunction(getter)||optly.nativity.isNativeFunction(setter)){optly.Cleanse.log("ignore native code",typeName,propertyName);return}if(getter){optly.Cleanse.getters[typeName][propertyName]=getter;optly.Cleanse.log("cleansed getter",typeName,propertyName)}else{optly.Cleanse.properties[typeName][propertyName]=property;optly.Cleanse.log("cleansed property",typeName,propertyName)}if(setter){optly.Cleanse.setters[typeName][propertyName]=setter;optly.Cleanse.log("cleansed setter",typeName,propertyName)}delete type.prototype[propertyName]})});optly.Cleanse.fixGetElementsByClassName();optly.Cleanse.hasRunStart=true};optly.Cleanse.fixGetElementsByClassName=function(){if(!optly.nativity.isNativeFunction(document.getElementsByClassName)){var nativeGetElementsByClassName=optly.nativity.getNativeGetElementsByClassName();if(nativeGetElementsByClassName){optly.Cleanse.getElementsByClassName=document.getElementsByClassName;document.getElementsByClassName=nativeGetElementsByClassName}else{optly.Cleanse.log("Error: native HTMLElement.prototype.getElementsByClassName missing")}}};optly.Cleanse.unfixGetElementsByClassName=function(){if(optly.Cleanse.getElementsByClassName){document.getElementsByClassName=optly.Cleanse.getElementsByClassName;optly.Cleanse.getElementsByClassName=null}};optly.Cleanse.getElementsByClassName=null;optly.Cleanse.getters={};optly.Cleanse.logs=[];optly.Cleanse.properties={};optly.Cleanse.setters={};optly.Cleanse.types={HTMLElement_:window.HTMLElement,Object_:Object};window.optly=window.optly||{};window.optly.Cleanse={finish:optly.Cleanse.finish,logs:optly.Cleanse.logs,start:optly.Cleanse.start};optly.domain.check=function(url){var location=optly.domain.getLocation(url);for(var i=0,nRules=optly.domain.PATH_BLACK_LIST.length;i<nRules;i++){var pattern=optly.domain.PATH_BLACK_LIST[i];if(pattern.test(location.pathname)){return false}}for(i=0,nRules=optly.domain.HOST_BLACK_LIST.length;i<nRules;i++){pattern=optly.domain.HOST_BLACK_LIST[i];if(pattern.test(location.hostname)){return false}}var whiteList=new RegExp(optly.domain.WHITE_LIST);return whiteList.test(location.hostname)};optly.domain.getLocation=function(url){var anchor=document.createElement("a");anchor.href=url;return anchor};optly.domain.HOST_BLACK_LIST=[/(edit|preview)(-local)?(-hrd)?\.optimizely\.(com|test)/,/optimizelyedit(-hrd)?\.appspot\.com/,/cdn[^\.]*\.optimizely\.com/];optly.domain.PATH_BLACK_LIST=[/^\/api\/client/];optly.domain.WHITE_LIST="(www-devel.optimizely.com$)|(www-devel.optimizely.appspot.com$)|(www-devel-dot-optimizely.appspot.com$)|(.optimizely.com$)|(.optimizely.at$)|(.optimizely.be$)|(.optimizely.bg$)|(.optimizely.by$)|(.optimizely.ch$)|(.optimizely.cl$)|(.optimizely.co.il$)|(.optimizely.co.nz$)|(.optimizely.co.uk$)|(.optimizely.com.br$)|(.optimizely.com.hr$)|(.optimizely.com.mx$)|(.optimizely.cz$)|(.optimizely.de$)|(.optimizely.es$)|(.optimizely.dk$)|(.optimizely.fr$)|(.optimizely.gr$)|(.optimizely.hk$)|(.optimizely.ie$)|(.optimizely.it$)|(.optimizely.jp$)|(.optimizely.lt$)|(.optimizely.lu$)|(.optimizely.lv$)|(.optimizely.nl$)|(.optimizely.mx$)|(.optimizely.pl$)|(.optimizely.pt$)|(.optimizely.ro$)|(.optimizely.ru$)|(.optimizely.se$)|(.optimizely.sg$)|(.optimisely.com$)|(.optimisely.at$)|(.optimisely.be$)|(.optimisely.bg$)|(.optimisely.by$)|(.optimisely.ch$)|(.optimisely.cl$)|(.optimisely.co.il$)|(.optimisely.co.nz$)|(.optimisely.co.uk$)|(.optimisely.com.br$)|(.optimisely.com.hr$)|(.optimisely.com.mx$)|(.optimisely.cz$)|(.optimisely.de$)|(.optimisely.es$)|(.optimisely.dk$)|(.optimisely.fr$)|(.optimisely.gr$)|(.optimisely.hk$)|(.optimisely.ie$)|(.optimisely.it$)|(.optimisely.jp$)|(.optimisely.lt$)|(.optimisely.lu$)|(.optimisely.lv$)|(.optimisely.nl$)|(.optimisely.mx$)|(.optimisely.pl$)|(.optimisely.pt$)|(.optimisely.ro$)|(.optimisely.ru$)|(.optimisely.se$)|(.optimisely.sg$)|(.optimizely.test$)|(.optimizely.appspot.com$)|(.optimizely-hrd.appspot.com$)|(-dot-optimizely.appspot.com$)|(-dot-optimizely-hrd.appspot.com$)";optly.Cleanse.start();var $=jQuery;optly.match.matchUrl=function(url,string,type){switch(type){case"exact":url=optly.match.stripUrl(url);url=optly.match.stripVarFromQuery(url,"optimizely_log");url=optly.match.stripVarFromQuery(url,"optimizely_verbose");return url===optly.match.stripUrl(string);case"regex":try{return Boolean(url.match(string))}catch(error){return false}case"simple":url=optly.match.simplifyUrl(url);string=optly.match.simplifyUrl(string);return url===string;case"substring":url=optly.match.stripUrl(url,true);string=optly.match.stripUrl(string,true);return url.indexOf(string)!==-1;default:return false}};optly.match.removeParameters=function(url){var index=url.indexOf("?");if(index!==-1){url=url.substring(0,index)}index=url.indexOf("#");if(index!==-1){url=url.substring(0,index)}return url};optly.match.simplifyUrl=function(url){return optly.match.stripUrl(optly.match.removeParameters(url))};optly.match.stripUrl=function(url,excludeOptionalPrefixesToStrip){url=url.toLowerCase().replace(/[/&?]+$/,"");var prefixesToStrip=optly.match.REQUIRED_PREFIXES_TO_STRIP.slice(0);if(!excludeOptionalPrefixesToStrip){prefixesToStrip=prefixesToStrip.concat(optly.match.OPTIONAL_PREFIXES_TO_STRIP)}var length=prefixesToStrip.length;for(var i=0;i<length;i++){var prefixToStrip=prefixesToStrip[i];var prefixRegEx=new RegExp("^"+prefixToStrip);url=url.replace(prefixRegEx,"")}return url};optly.match.stripVarFromQuery=function(url,stripVar){return url.replace("&"+stripVar+"=true","").replace("?"+stripVar+"=true&","?").replace("?"+stripVar+"=true","")};optly.match.REQUIRED_PREFIXES_TO_STRIP=["https?://(edit|preview)(-hrd|-devel)?.optimizely.(com|test)/","https?://.*?.?optimizelyedit(-hrd)?.appspot.com/","https?://"];optly.match.OPTIONAL_PREFIXES_TO_STRIP=["www."];integrator.activateSiteCatalyst=function(options){options=options||{};if(!directive.shouldTrackEvents){return}if(options&&options.sVariable){integrator.setSiteCatalystSVar(options.sVariable)}var siteCatalyst=integrator.getSiteCatalystSVar();if(!siteCatalyst){timer.addEvent("Integrator","Error with SiteCatalyst integration: 's' variable not defined");return}if(!integrator.hasIntegratedThirdParties){integrator.alsoActivateSiteCatalyst=true;return}integrator.fixSiteCatalystReferrer(siteCatalyst);log("Integrator","Tracking with SiteCatalyst");each(integrator.getRelevantVariationIds(),function(variationId){var experimentId=data.getVariationExperimentId(variationId);var keyValue=integrator.makeSendableNames(experimentId,variationId,100,100,25,true);var value=keyValue.key+": "+keyValue.value;each(integrator.getSiteCatalystKeys(experimentId),function(key){log("Integrator","Setting SiteCatalyst %s='%s'",key,value);siteCatalyst[key]=value})})};integrator.googleAnalyticsCustomVariableScope=function(scope){scope=isNumberLike(scope)?Number(scope):-1;if([1,2,3].indexOf(scope)!==-1){integrator._googleAnalyticsCustomVariableScope=scope}else{return integrator._googleAnalyticsCustomVariableScope}};integrator.loadThirdPartySegments=function(){timer.addEvent("Integrator","Loading third-party segments.");if(data.isBlueKaiEnabled()&&window.bk_results){integrator.loadBlueKaiSegments(window.bk_results)}};integrator.makeThirdPartyRequests=function(){if(!directive.shouldTrackEvents){return}integrator.initializeReferrerInfo();integrator.fixGoogleAnalyticsReferrer();each(integrator.getRelevantVariationIds(),function(variationId){var experimentId=data.getVariationExperimentId(variationId);if(data.isChartbeatEnabled(experimentId)){integrator.makeChartbeatRequest(experimentId,variationId)}if(data.isCrazyEggEnabled(experimentId)){integrator.makeCrazyEggRequest(experimentId,variationId)}if(data.isGoogleAnalyticsEnabled(experimentId)){integrator.makeGoogleAnalyticsRequest(experimentId,variationId)}if(data.isKissMetricsEnabled()){integrator.makeKissMetricsRequest(experimentId,variationId)}if(data.isMixpanelEnabled(experimentId)){integrator.makeMixpanelRequest(experimentId,variationId)}});integrator.makeChartbeatReferralRequest();integrator.hasIntegratedThirdParties=true;if(integrator.alsoActivateSiteCatalyst){integrator.activateSiteCatalyst();integrator.alsoActivateSiteCatalyst=false}};integrator.playbackClickTale=function(){if(window.ClickTaleContext){try{window.ClickTaleContext["getAggregationContextAsync"]("1",function(context){if(context.Location){window.optimizely.push(["overrideUrl",context.Location])}for(var key in context.PageEvents){var combinations=context.PageEvents[key][2].match(/x[0-9]+=[0-9_]+/g);log("Integrator","Playback ClickTale Integration - %s",combinations);for(var key=0;key<combinations.length;key++){log("Integrator","Playback ClickTale Integration - %s",combinations[key]);var experiment=combinations[key].split("=")[0].substr(1);var variations=combinations[key].split("=")[1].split("_");for(var variationIndex=0;variationIndex<variations.length;variationIndex++){if(!integrator.getRedirectURL(variations[variationIndex])){window.optimizely.push(["activate",experiment,variations[variationIndex],{force:true}])}else{log("Integrator","Skip activation for redirect.")}}}}})}catch(e){log("Integrator","Playback ClickTale Aggregation Integration failed.")}try{window.ClickTaleContext["getRecordingContextAsync"]("1.1",function(context){if(context.inSingleRecordingScope){if(context.location){window.optimizely.push(["overrideUrl",context.location])}log("Integrator","Playback ClickTale getRecordingContextAsync callback");for(var key in context.fields){log("Integrator","Playback ClickTale Integration - %s=%s",key,context.fields[key]);if(!integrator.getRedirectURL(context.fields[key])){window.optimizely.push(["activate",key,context.fields[key],{force:true}])}else{log("Integrator","Skip activation for redirect.")}}}})}catch(e){log("Integrator","Playback ClickTale Recording Integration failed.")}}else{log("Integrator","ClickTaleContext not defined.")}};integrator.recordClickTale=function(options){log("Integrator","Tracking with ClickTale.");if(typeof window.ClickTaleField=="function"){each(integrator.getRelevantVariationIds(),function(variationId){var experimentId=data.getVariationExperimentId(variationId);var keyValue=integrator.makeSendableNames(experimentId,variationId,100,100,15,false);var value=keyValue.key+": "+keyValue.value+" (x"+experimentId+"="+variationId+")";log("Integrator","Setting ClickTale - %s",value);window.ClickTaleField(experimentId,variationId);window.ClickTaleEvent(value)})}else{log("Integrator","ClickTaleField() not defined.")}};integrator.setPrefix=function(prefix){integrator.prefix=prefix};integrator.setSiteCatalystSVar=function(siteCatalystObject){integrator.siteCatalystObject=siteCatalystObject};integrator.cleanSegmentString=function(input,maxLength){return input.replace(/[^a-zA-Z0-9\.\~\!\*\(\)\']+/g,"_").substring(0,maxLength)};integrator.fixGoogleAnalyticsReferrer=function(){var referrer=integrator.actualReferrer;if(referrer){try{log("Integrator","Fixing _gaq._setReferrerOverride with %s",referrer);_gaq.push(["_setReferrerOverride",referrer])}catch(exception){log("Integrator","Error setting Google Analytics referrer: %s",exception)}}};integrator.fixSiteCatalystReferrer=function(siteCatalyst){var referrer=integrator.actualReferrer;if(referrer&&siteCatalyst){try{log("Integrator","Fixing SiteCatalyst referrer to %s",referrer);siteCatalyst.referrer=String(referrer)}catch(exception){log("Integrator","Error setting SiteCatalyst referrer: %s",exception)}}};integrator.getRelevantVariationIds=function(){var activeExperimentIds=evaluator.getActiveExperimentIds();var variationIds=[];each(plan.getVariationIds(),function(variationId){var experimentId=data.getVariationExperimentId(variationId);var relevant=false;if(data.isExperimentEnabled(experimentId)){var variationName=data.getVariationName(variationId);if(arrayContains(activeExperimentIds,experimentId)){log("Integrator",'"%s" relevant because experiment active',variationName);relevant=true}var isRedirectVariation=!!integrator.getRedirectURL(variationId);if(isRedirectVariation){var redirectVariationId=redirect.getRedirectCookie();if(redirectVariationId){integrator.redirectVariationId=redirectVariationId}if((integrator.redirectVariationId==variationId||redirect.detectNoCookieRedirect(data.getVariationCode(variationId)))){log("Integrator",'"%s" relevant because it redirected to here',variationName);relevant=true}}if(relevant){variationIds.push(variationId)}}});return variationIds};integrator.getSiteCatalystKeys=function(experimentId){var keys=[];var eVar=data.getSiteCatalystEVar(experimentId);var prop=data.getSiteCatalystProp(experimentId);if(eVar!==null){keys.push("eVar"+eVar)}if(prop!==null){keys.push("prop"+prop)}return keys};integrator.getSiteCatalystSVar=function(){return integrator.siteCatalystObject||(typeof window.s!=="undefined"?window.s:null)};integrator.initializeReferrerInfo=function(){var referrer=cookie.get(REFERRER_REDIRECT_COOKIE_NAME);if(referrer&&referrer.length>0){integrator.actualReferrer=referrer;cookie.set(REFERRER_REDIRECT_COOKIE_NAME,"")}};integrator.getRedirectURL=function(variationId){var redirectURLMatch=redirect.getRedirectURL(data.getVariationCode(variationId));if(redirectURLMatch){return redirectURLMatch[1]}return null};integrator.loadBlueKaiSegments=function(data){timer.addEvent("Integrator","Loading BlueKai segments.");try{var campaigns=data.campaigns;for(var campaignIndex=0;campaignIndex<campaigns.length;campaignIndex++){var categories=campaigns[campaignIndex]["categories"];for(var categoryIndex=0;categoryIndex<categories.length;categoryIndex++){var category=categories[categoryIndex];var segmentName="bk_segment_"+category.categoryID.toString();segmenter.addToSegment(segmentName,true)}}}catch(e){timer.addEvent("Integrator","Error loading BlueKai segments.")}};integrator.makeChartbeatReferralRequest=function(){var customValue=cookie.get(REFERRAL_CHARTBEAT_COOKIE_NAME)||"";try{if(customValue&&integrator.currentChartbeatExperiment!=customValue){log("Integrator","Calling _cbq.push for referral");_cbq.push(["_optlyr",customValue])}if(integrator.currentChartbeatExperiment!=customValue){log("Integrator","Set new Chartbeat referral cookie.");cookie.set(REFERRAL_CHARTBEAT_COOKIE_NAME,integrator.currentChartbeatExperiment)}}catch(error){timer.addEvent("Integrator","Error sending Chartbeat referral for "+customValue)}};integrator.makeChartbeatRequest=function(experimentId,variationId){var curPrefix=integrator.prefix;integrator.setPrefix("");var keyValue=integrator.makeSendableNames(experimentId,variationId,10,10,5,false);integrator.setPrefix(curPrefix);var variationIndex=data.getVariationIndex(variationId);integrator.currentChartbeatExperiment=keyValue.key+": "+String(variationIndex);try{log("Integrator","Calling _cbq.push");_cbq.push(["_optlyx",integrator.currentChartbeatExperiment])}catch(error){timer.addEvent("Integrator","Error sending Chartbeat data for "+data.getExperimentString(experimentId))}};integrator.makeCrazyEggRequest=function(experimentId,variationId){var keyValue=integrator.makeSendableNames(experimentId,variationId,100,100,15,false);try{log("Integrator","Defining CE_SNAPSHOT_NAME");window.CE_SNAPSHOT_NAME=keyValue.key+": "+keyValue.value}catch(error){timer.addEvent("Integrator","Error sending CrazyEgg data for "+data.getExperimentString(experimentId))}};integrator.makeGoogleAnalyticsRequest=function(experimentId,variationId){var slot=data.getGoogleAnalyticsSlot(experimentId);var tracker=data.getGoogleAnalyticsTracker(experimentId);var keyValue=integrator.makeSendableNames(experimentId,variationId,28,24,5,true);try{var prefix="";if(tracker!==""){prefix=tracker+"."}log("Integrator","Calling _gaq._setCustomVar for slot %d and scope %d",slot,integrator._googleAnalyticsCustomVariableScope);_gaq.push([prefix+"_setCustomVar",slot,keyValue.key,keyValue.value,integrator._googleAnalyticsCustomVariableScope])}catch(error){timer.addEvent("Integrator","Error sending Google Analytics data for "+data.getExperimentString(experimentId))}};integrator.makeKissMetricsRequest=function(experimentId,variationId){var keyValue=integrator.makeSendableNames(experimentId,variationId,100,100,15,true);var kissMetricsKeyValue={};kissMetricsKeyValue[keyValue.key]=keyValue.value;try{log("Integrator","Calling _kmq.set");_kmq.push(["set",kissMetricsKeyValue])}catch(error){timer.addEvent("Integrator","Error sending KISSmetrics data for "+data.getExperimentString(experimentId))}};integrator.makeMixpanelRequest=function(experimentId,variationId){var keyValue=integrator.makeSendableNames(experimentId,variationId,100,100,15,false);var mixpanelKeyValue={};mixpanelKeyValue[keyValue.key]=keyValue.value;try{log("Integrator","Calling mixpanel.push");mixpanel.push(["register",mixpanelKeyValue])}catch(error){timer.addEvent("Integrator","Error sending Mixpanel data for "+data.getExperimentString(experimentId))}};integrator.makeSendableNames=function(experimentId,variationId,expLength,varLength,mvtVarLength,makeClean){var expName=integrator.prefix+data.getExperimentName(experimentId);var varNamesArray=data.getVariationNamesArray(variationId);var varName;if(varNamesArray.length>1){varNamesArray=$.map(varNamesArray,(function(str){return str.substr(0,mvtVarLength-1)}));varName=varNamesArray.join("~")}else{varName=varNamesArray[0]}if(makeClean){expName=integrator.cleanSegmentString(expName,expLength);varName=integrator.cleanSegmentString(varName.replace("#",""),varLength)}else{expName=expName.substring(0,expLength);varName=varName.substring(0,varLength)}return{key:expName,value:varName}};integrator.alsoActivateSiteCatalyst=false;integrator.currentChartbeatExperiment="";integrator._googleAnalyticsCustomVariableScope=2;integrator.hasIntegratedThirdParties=false;integrator.prefix="Optimizely ";integrator.siteCatalystObject=null;integrator.actualReferrer=null;integrator.redirectVariationId=null;api.activate=function(activateExperimentId,variationIdOrForcedActivation,options){if(!directive.isEnabled){return false}var preferredVariationId=(typeof variationIdOrForcedActivation==="number"||typeof variationIdOrForcedActivation==="string")?String(variationIdOrForcedActivation):null;var forcedActivation=((variationIdOrForcedActivation===true)||(variationIdOrForcedActivation&&variationIdOrForcedActivation.force===true)||(options&&options.force===true));var skipBucketing=((typeof variationIdOrForcedActivation==="object"&&variationIdOrForcedActivation.skip===true)||(typeof options==="object"&&options.skip===true));var skipPageviewTracking=((typeof variationIdOrForcedActivation==="object"&&variationIdOrForcedActivation.skipPageview===true)||(typeof options==="object"&&options.skipPageview===true));if(preferredVariationId){try{api.bucketUser((activateExperimentId),preferredVariationId,true)}catch(err){timer.addEvent("API","Error while activating experiment "+activateExperimentId+" for variation "+preferredVariationId+" -- proceeding without bucketing user.")}}var pickedVariation=null;var experimentsToActivate=[];var experimentsToEvaluate=[];if(isNumberLike(activateExperimentId)){experimentsToActivate.push(activateExperimentId)}else{each(data.getExperimentIds(),function(experimentId){if(data.getExperimentManualMode(experimentId)){experimentsToActivate.push(experimentId)}})}timer.addEvent("API","Testing experiments to activate");each(experimentsToActivate,function(experimentId){if(!forcedActivation&&!condition.isReadyToTest(experimentId)){api.addGeoDelayedExperiment(experimentId)}else{if(forcedActivation||condition.passesTests(experimentId,{manualMode:true,objectType:"experiment"})){pickedVariation=distributor.distributeExperiment(experimentId,skipBucketing);if(pickedVariation){experimentsToEvaluate.push(experimentId)}}}});evaluator.evaluate(experimentsToEvaluate,experimentsToActivate);plan.writeCookie();integrator.makeThirdPartyRequests();if(directive.isEnabled&&!skipPageviewTracking){tracker.addLogEvent(document.location.href)}};api.activateGeoDelayedExperiments=function(){if(!directive.isEnabled){return false}timer.addEvent("API","Testing geodelayed segments");var segmentsToActivate=api.geoDelayedSegments;each(segmentsToActivate,function(segmentId){segmenter.evaluateSegment(segmentId)});var pickedVariation=null;var experimentsToActivate=api.geoDelayedExperiments;var experimentsToEvaluate=[];timer.addEvent("API","Testing geodelayed experiments");each(experimentsToActivate,function(experimentId){if(condition.passesTests(experimentId,{manualMode:true,objectType:"experiment"})){pickedVariation=distributor.distributeExperiment(experimentId);if(pickedVariation){experimentsToEvaluate.push(experimentId)}}});evaluator.evaluate(experimentsToEvaluate,experimentsToActivate);plan.writeCookie();integrator.makeThirdPartyRequests();if(directive.isEnabled&&!directive.shouldSkipPageTracking){tracker.addLogEvent(document.location.href)}api.invalidateGeoDelayedExperiments();api.invalidateGeoDelayedSegments();window.optimizelyGeo={};return true};api.addGeoDelayedExperiment=function(experimentId){api.geoDelayedExperiments.push(experimentId)};api.addGeoDelayedSegment=function(segmentId){api.geoDelayedSegments.push(segmentId)};api.areThereGeoDelayedExperiments=function(){return api.geoDelayedExperiments.length!==0};api.areThereGeoDelayedSegments=function(){return api.areThereGeoDelayedSegments.length!==0};api.bucketUser=function(experimentId,variationIdOrIndex,doNotSendPageviewTracking){doNotSendPageviewTracking=(doNotSendPageviewTracking===true);directive.shouldOverrideThirdPartyCookie=true;if(directive.isEnabled&&!doNotSendPageviewTracking){tracker.addLogEvent(document.location.href)}experimentId=String(experimentId);variationIdOrIndex=String(variationIdOrIndex);if(variationIdOrIndex==="-1"){plan.removeExperiment(experimentId)}else{var variationId=null;if(Number(variationIdOrIndex)<=256){variationId=String(data.getVariationIdByIndex(experimentId,variationIdOrIndex))}else{variationId=String(variationIdOrIndex)}var sectionIds=data.getExperimentSectionIds(experimentId);if(sectionIds&&sectionIds.length>0){distributor.preferMVTVariation(experimentId,variationId)}else{plan.addVariation(variationId,"api.bucketUser",false,true)}}plan.writeCookie()};api.disable=function(type){if(type&&type==="tracking"){directive.shouldTrackEvents=false}else{directive.isEnabled=false;directive.shouldTrackEvents=false}};api.finalize=function(){timer.addEvent("API","Finalizing API.");api.setPublicObjects();api.isFinalized=true};api.getVariationNamesMap=function(){return api.variationNamesMap};api.hasLocationDataArrived=function(){return window.optimizely["data"]["visitor"]["location"]["city"]!==""||window.optimizely["data"]["visitor"]["location"]["continent"]!==""||window.optimizely["data"]["visitor"]["location"]["country"]!==""||window.optimizely["data"]["visitor"]["location"]["region"]!==""};api.initialize=function(){api.isFinalized=false;segmenter.addChangeHandler(api.setPublicObjects);plan.addChangeHandler(api.setPublicObjects);var globals={"$":$,activeExperiments:evaluator.getEvaluatedExperimentIds()||[],allExperiments:data.getExperiments(),all_experiments:data.getExperiments(),allVariations:data.getVariations(),data:api.data,getElementsByClassName:document.getElementsByClassName,revision:data.getRevision(),variationIdsMap:api.variationIdsMap,variation_map:api.variationMap,variationMap:api.variationMap,variationNamesMap:api.variationNamesMap};var globalFunctions={};var push=curry(api.push,globalFunctions);extend(globalFunctions,{acknowledgePreviewMode:preview.acknowledge,activate:api.activate,activateGeoDelayedExperiments:api.activateGeoDelayedExperiments,activateSiteCatalyst:integrator.activateSiteCatalyst,addToSegment:segmenter.addToSegment,bindTrackElement:evaluator.bindTrackElementFromApi,bucketUser:api.bucketUser,bucketVisitor:api.bucketUser,clickTaleRecord:integrator.recordClickTale,clickTalePlayback:integrator.playbackClickTale,customTag:api.registerCustomTag,delayDomReadyEval:evaluator.setDelayDomExecute,delayPageviewTracking:api.delayPageviewTracking,disable:api.disable,log:timer.enableLogging,getAccountId:data.getAdminAccountId,getProjectId:data.getProjectId,googleAnalyticsCustomVariableScope:integrator.googleAnalyticsCustomVariableScope,integrationPrefix:integrator.setPrefix,optOut:tracker.optOut,overrideUrl:user.setCurrentUrl,preview:preview.enablePreview,push:push,removeFromAllSegments:segmenter.removeFromAllSegments,removeFromSegment:segmenter.removeFromSegment,sc_activate:integrator.activateSiteCatalyst,sc_svar:integrator.setSiteCatalystSVar,setCookieDomain:cookie.setApiPublicSuffix,skipPageTracking:api.skipPageTracking,optOutThirdPartyCookies:api.optOutThirdPartyCookies,timeout:api.disable,trackEvent:tracker.addLogEventFromAPI,verbose:timer.enableVerboseLogging});extend(globals,globalFunctions);var initialApiCalls=window.optimizely;if(isArrayLike(initialApiCalls)){each(initialApiCalls,function(apiCall){push(apiCall)})}window[GLOBAL]=globals};api.invalidateGeoDelayedExperiments=function(){api.geoDelayedExperiments=[]};api.invalidateGeoDelayedSegments=function(){api.geoDelayedSegments=[]};api.push=function(globalFunctions,apiCall){var arguments_=[];var functionName=apiCall;if(isArrayLike(apiCall)){arguments_=slice((apiCall),1);functionName=apiCall[0]}var function_=globalFunctions[functionName];if(function_){timer.addEvent("API",'Called function "'+functionName+'"');if(functionName!=="acknowledgePreviewMode"){preview.addEvent(functionName,{type:"api"})}function_.apply(null,arguments_)}else{timer.addEvent("API",'Error for unknown function "'+functionName+'"')}timer.flushLogs()};api.registerCustomTag=function(key,value){if(api.isFinalized){timer.addEvent("API","Error: can't add custom tags after Optimizely loads");return}api.customTags=api.customTags||{};if(arguments.length==2){api.customTags[key]=value}else{if(arguments.length==1){$.extend(true,api.customTags,key)}}};api.setPublicObjects=function(){api.variationIdsMap={};api.variationMap={};api.variationNamesMap={};each(plan.getVariationIds(),function(variationId){var experimentId=data.getVariationExperimentId(variationId);api.variationIdsMap[experimentId]=variationId.split(VARIATION_ID_DELIMITER);api.variationMap[experimentId]=data.getVariationIndex(variationId);api.variationNamesMap[experimentId]=data.getVariationName(variationId)});api.updateDataObject();extend(window[GLOBAL],{activeExperiments:evaluator.getEvaluatedExperimentIds(),allExperiments:data.getExperiments(),all_experiments:data.getExperiments(),data:api.data,variationIdsMap:api.variationIdsMap,variationMap:api.variationMap,variationNamesMap:api.variationNamesMap,variation_map:api.variationMap})};api.delayPageviewTracking=function(milliseconds){if(!isNumberLike(milliseconds)){return false}directive.delayPageviewTracking=Number(milliseconds)};api.optOutThirdPartyCookies=function(){directive.optOutThirdPartyCookies=true};api.skipPageTracking=function(){directive.shouldSkipPageTracking=true};api.updateDataObject=function(){api.data={};api.data.experiments={};api.data.sections={};api.data.segments={};api.data.state={};api.data.variations={};api.data.visitor={};api.data.customTags=api.customTags;var experimentIds=data.getExperimentIds();for(var i=0;i<experimentIds.length;i++){var experimentId=experimentIds[i];var experimentInfo={};experimentInfo.code=data.getExperimentCode(experimentId);experimentInfo.name=data.getExperimentName(experimentId);experimentInfo.manual=data.getExperimentManualMode(experimentId);experimentInfo.section_ids=data.getExperimentSectionIds(experimentId);experimentInfo.variation_ids=data.getExperimentVariationIds(experimentId);api.data.experiments[experimentId]=experimentInfo}var segmentIds=data.getSegmentIds();for(var i=0;i<segmentIds.length;i++){var segmentId=segmentIds[i];api.data.segments[segmentId]={name:data.getSegmentName(segmentId)}}var sectionIds=data.getSectionIds();for(var i=0;i<sectionIds.length;i++){var sectionId=sectionIds[i];var sectionInfo={};sectionInfo.name=data.getSectionName(sectionId);sectionInfo.variation_ids=data.getSectionVariationIds(sectionId);api.data.sections[sectionId]=sectionInfo}var variationIds=data.getVariationIds();for(var i=0;i<variationIds.length;i++){var variationId=variationIds[i];var variationInfo={};variationInfo.name=data.getVariationName(variationId);variationInfo.code=data.getVariationCode(variationId);api.data.variations[variationId]=variationInfo}var visitor={};var browser=user.getBrowserId();visitor.browser={ff:"Firefox",ie:"Internet Explorer",safari:"Safari",gc:"Google Chrome",opera:"Opera"}[browser]||"";var locationInfoFromData=user.getLocation();visitor.location={city:locationInfoFromData.city,continent:locationInfoFromData.continent,country:locationInfoFromData.country,region:locationInfoFromData.region};visitor.ip=user.getIP();visitor.params={};var urlParams=query.getAllParameters();urlParams.reverse();for(var i=0,nParams=urlParams.length;i<nParams;i++){visitor.params[urlParams[i][0]]=decodeURIComponent(urlParams[i][1])}visitor.referrer=String(document.referrer);visitor.segments=segmenter.getSegmentTrackingData();visitor.mobile=(user.getMobileId()!=="unknown");visitor.os=user.getOS();api.data.visitor=visitor;var state={};state.activeExperiments=evaluator.getEvaluatedExperimentIds()||[];state.variationIdsMap=api.variationIdsMap;state.variationMap=api.variationMap;state.variationNamesMap=api.variationNamesMap;api.data.state=state};api.data={};api.geoDelayedExperiments=[];api.geoDelayedSegments=[];api.variationIdsMap={};api.variationMap={};api.variationNamesMap={};distributor.distributeAll=function(){var previewingExperimentIds=preview.getPreviewingExperiments();each(data.getExperimentIds(),function(experimentId){if(!evaluator.isInQueue(experimentId)){if(!condition.isReadyToTest(experimentId)){if(!data.getExperimentManualMode(experimentId)){api.addGeoDelayedExperiment(experimentId)}}else{if(condition.passesTests(experimentId,{objectType:"experiment"})){timer.addEvent("Distributor","Going to distribute "+data.getExperimentString(experimentId));var shouldEnqueue=distributor.distributeExperiment(experimentId);var dontEvaluateBecausePreviewingOthers=false;if(previewingExperimentIds.length>0&&!arrayContains(previewingExperimentIds,experimentId)){timer.addEvent("Distributor","Not going to evaluate because of preview mode, for "+data.getExperimentString(experimentId));dontEvaluateBecausePreviewingOthers=true;preview.setReason(experimentId,"it is not being previewed")}if(shouldEnqueue&&!dontEvaluateBecausePreviewingOthers){evaluator.enqueue(experimentId)}}}}})};distributor.distributeExperiment=function(experimentId,forceIgnored){forceIgnored=(forceIgnored===true);var preferredVariation=plan.getVariationId(experimentId);if(preferredVariation&&preferredVariation.length>0){timer.addEvent("Distributor","Not distributing experiment "+experimentId+" (already in plan)");return true}if(forceIgnored||plan.isExperimentIgnored(experimentId)){timer.addEvent("Distributor","Not distributing experiment "+experimentId+" (is ignored)");preview.setReason(experimentId,"it is ignored");return false}var enabledVariationIds=data.getEnabledVariationIds(experimentId);if(enabledVariationIds.length===0){timer.addEvent("Distributor","Permanently ignoring experiment "+experimentId+" (no enabled variations)");preview.setReason(experimentId,"it has no enabled variations");plan.ignoreExperiment(experimentId);return false}else{var ignorePercentage=data.getExperimentIgnorePercentage(experimentId);if(ignorePercentage>getRandomNumber(100)){timer.addEvent("Distributor","Permanently ignoring experiment "+experimentId+"("+ignorePercentage+"% likelihood)");plan.ignoreExperiment(experimentId);return false}else{var variationIds=enabledVariationIds;if(distributor.preferredBucketUserMapping[experimentId]!==undefined){timer.addEvent("Distributor","Taking into account bucketUser variations for experiment "+experimentId);variationIds=distributor.getPotentialPreferredMVTVariations(experimentId)}var randomIndex=distributor.pickRandomVariationIndex(experimentId,variationIds);var variationId=variationIds[randomIndex];timer.addEvent("Distributor","Picked variation "+variationId+" [index "+randomIndex+" of "+enabledVariationIds.length+"]");plan.addVariation(variationId,"distributor",false);return true}}};distributor.pickRandomVariationIndex=function(experimentId,possibleVariationIds){var possibleWeights=[];var variationWeights=data.getExperimentVariationWeights(experimentId);each(possibleVariationIds,function(variationId){possibleWeights.push(variationWeights[variationId])});return chooseWeightedIndex(possibleWeights)};distributor.preferMVTVariation=function(experimentId,variationPartial){var sectionId=data.getExperimentVariationSectionId(experimentId,variationPartial);distributor.preferredBucketUserMapping[experimentId]=distributor.preferredBucketUserMapping[experimentId]||{};distributor.preferredBucketUserMapping[experimentId][sectionId]=variationPartial;timer.addEvent("Distributor","Preferring variation partial "+variationPartial+" of section "+sectionId+" of experiment "+experimentId);var variationIds=distributor.getPotentialPreferredMVTVariations(experimentId);if(variationIds.length===1){plan.addVariation(variationIds[0],"api.bucketUser",false,true)}};distributor.getPotentialPreferredMVTVariations=function(experimentId){var variationIds=[];each(data.getEnabledVariationIds(experimentId),function(variationId){if(distributor.containsPreferredMVTVariations(experimentId,variationId)){variationIds.push(variationId)}});return variationIds};distributor.containsPreferredMVTVariations=function(experimentId,variationId){var isAcceptable=true;for(var sectionId in distributor.preferredBucketUserMapping[experimentId]){var variationPartial=distributor.preferredBucketUserMapping[experimentId][sectionId];if(variationId.indexOf(variationPartial)===-1){isAcceptable=false}}return isAcceptable};distributor.preferredBucketUserMapping={};query.getAllParameters=function(){var queryString=window.location.search||"";if(queryString.indexOf("?")===0){queryString=queryString.substring(1)}var query=queryString.split("&");var nameValuePairs=[];for(var i=0;i<query.length;i++){var name="";var value="";var nameAndValue=query[i].split("=");if(nameAndValue.length>0){name=nameAndValue[0]}if(nameAndValue.length>1){value=nameAndValue[1]}nameValuePairs.push([name,value])}return nameValuePairs};query.getParameters=function(queryString){var match;var queryExpression=/optimizely_([^=]+)=([^&]*)/g;var queryParameters={};while(match=queryExpression.exec(queryString)){queryParameters[match[1]]=decodeURIComponent(match[2])}return queryParameters};query.getValue=function(queryParamName){var allQueryParams=query.getAllParameters();for(var i=0;i<allQueryParams.length;i++){var pair=allQueryParams[i];if(pair[0]===queryParamName){return pair[1]}}return null};query.findVariationId=function(experimentId,variationIndices){var sectionIds=data.getExperimentSectionIds(experimentId);var variationIds=[];if(sectionIds.length===variationIndices.length){each(sectionIds,function(sectionId,index){var variationIndex=variationIndices[index];var variationId=data.getSectionVariationIds(sectionId)[variationIndex];if(variationId){variationIds.push(variationId)}else{variationIds=[];return null}})}else{if(variationIndices.length===1){var experimentVariationIds=data.getExperimentVariationIds(experimentId);var variationIndex=variationIndices[0];var variationId=experimentVariationIds[variationIndex];if(!variationId&&arrayContains(experimentVariationIds,variationIndex)){variationId=variationIndex}if(variationId){variationIds.push(variationId)}}}return variationIds.join(VARIATION_ID_DELIMITER)};query.process=function(){var queryParameters=query.getParameters(window.location.search);var experimentExpression=/x(\d+)/;var hasPreviewParameters=false;each(queryParameters,function(key,value){var match=experimentExpression.exec(key);if(match){hasPreviewParameters=true;var experimentId=match[1];directive.previewExperimentId=experimentId;if(value!=="-1"){var variationIndices=value.split(VARIATION_ID_DELIMITER);var variationId=query.findVariationId(experimentId,variationIndices);var shouldEvaluate=!data.getExperimentManualMode(experimentId);plan.addVariation(variationId,"query",shouldEvaluate);preview.addExperiment(experimentId)}}});if(queryParameters.opt_out==="true"||queryParameters.opt_out==="false"){tracker.optOut(queryParameters.opt_out==="true")}directive.isEnabled=queryParameters.disable!=="true"&&queryParameters.opt_out!=="true"&&cookie.get(OPT_OUT_COOKIE_NAME)!=="true";directive.isEditor=queryParameters.editor==="true";directive.scriptToLoad=queryParameters.load_script;directive.shouldLoadPreview=queryParameters.preview==="true";directive.shouldLog=queryParameters.log==="true";directive.shouldLogVerbosely=queryParameters.verbose==="true";var forceTracking=queryParameters.force_tracking==="true";hasPreviewParameters=hasPreviewParameters||directive.shouldLoadPreview;directive.shouldTrackEvents=!hasPreviewParameters||forceTracking;if(queryParameters.client==="false"){directive.isEnabled=false;directive.scriptToLoad="js/"+data.getProjectId()+".js"}if(directive.scriptToLoad){if(!optly.domain.check(directive.scriptToLoad)){timer.addEvent("Query","Blocked request to load unsafe script: "+directive.scriptToLoad);directive.scriptToLoad=""}}};optly.nativity.getNativeGetElementsByClassName=function(){var nativeGetByClass=document.getElementsByClassName;if(!optly.nativity.isNativeFunction(nativeGetByClass)){var optimizely=window.optimizely||{};var optimizelyGetByClass=optimizely.getElementsByClassName;var optly_=window.optly||{};var optlyGetByClass=optly_.getElementsByClassName;if(optly.nativity.isNativeFunction(optimizelyGetByClass)){nativeGetByClass=optimizelyGetByClass}else{if(optly.nativity.isNativeFunction(optlyGetByClass)){nativeGetByClass=optlyGetByClass}else{nativeGetByClass=null}}}return nativeGetByClass};optly.nativity.isNativeFunction=function(function_){return function_&&String(function_).indexOf("[native code]")!==-1};redirect.getRedirectURL=function(code){var redirectPattern=/_optimizely_redirect(?:_no_cookie)?=(\S+)/;return code.match(redirectPattern)};redirect.detectNoCookieRedirect=function(code){return containsString(code,"_optimizely_redirect_no_cookie")};redirect.okToRedirect=function(code){code=code||"";if(redirect.detectNoCookieRedirect(code)){return true}var redirectCookie=redirect.getRedirectCookie();return !redirectCookie};redirect.getRedirectCookie=function(){return cookie.get(REDIRECT_COOKIE_NAME)};redirect.setRedirectCookie=function(variationId){cookie.set(REDIRECT_COOKIE_NAME,variationId||"unknown variation",REDIRECT_COOKIE_SECONDS)};redirect.setReferrerCookie=function(){cookie.set(REFERRER_REDIRECT_COOKIE_NAME,document.referrer,REDIRECT_COOKIE_SECONDS)};var detect=function(){var browserData=[{id:"gc",substring:"Chrome",versionPrefix:"Chrome"},{id:"safari",string:navigator.vendor,substring:"Apple",versionPrefix:"Version"},{id:"ff",substring:"Firefox",versionPrefix:"Firefox"},{id:"opera",prop:window.opera,versionPrefix:"Opera"},{id:"ie",substring:"MSIE",versionPrefix:"MSIE"}];var mobileData=[{id:"android",substring:"Android"},{id:"blackberry",substring:"BlackBerry"},{id:"ipad",substring:"iPad"},{id:"iphone",substring:"iPhone"},{id:"ipod",substring:"iPod"},{id:"windows phone",substring:"Windows Phone"}];var userAgent=navigator.userAgent;var browserDatum=detect.searchString(browserData,userAgent);var mobileDatum=detect.searchString(mobileData,userAgent);var version=null;var versionPrefix=browserDatum.versionPrefix;if(versionPrefix){version=detect.parseVersion(userAgent,versionPrefix)||detect.parseVersion(navigator.appVersion,versionPrefix)}return{browserId:browserDatum.id||"unknown",browserVersion:version||"unknown",mobileId:mobileDatum.id||"unknown"}};detect.parseVersion=function(versionString,versionPrefix){var index=versionString.indexOf(versionPrefix);var version=null;if(index!==-1){index+=versionPrefix.length+1;version=parseFloat(versionString.substring(index))}return version};detect.searchString=function(data,defaultString){return each(data,function(datum){var string=datum.string||defaultString;if(string&&containsString(string,datum.substring)||datum.prop){return datum}})||{}};directive.delayPageviewTracking=0;directive.isEnabled=true;directive.isEditor=false;directive.optOutThirdPartyCookies=false;directive.previewExperimentId=null;directive.scriptToLoad="";directive.shouldLoadPreview=false;directive.shouldLog=false;directive.shouldLogVerbosely=false;directive.shouldOverrideThirdPartyCookie=false;directive.shouldSkipPageTracking=false;directive.shouldTrackEvents=true;(function(){function f(n){return n<10?"0"+n:n}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){if(typeof rep[i]==="string"){k=rep[i];v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}json.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else{if(typeof space==="string"){indent=space}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":value})};json.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}());tracker.addLogEventFromAPI=function(name,revenueOrOptions){var options={};var fixedRevenue=undefined;var customRevenueGoals=data.getCustomRevenueGoals();if(customRevenueGoals&&name in customRevenueGoals&&isNumberLike(customRevenueGoals[name])){fixedRevenue=customRevenueGoals[name]}if(revenueOrOptions&&isNumberLike(revenueOrOptions)){options={revenue:Number(revenueOrOptions)}}else{if(revenueOrOptions&&revenueOrOptions.revenue){options={revenue:revenueOrOptions.revenue}}else{if(fixedRevenue){options={revenue:fixedRevenue}}else{options=revenueOrOptions}}}var enabledExperiments=data.getEnabledExperimentIds();var experimentIds={};each(enabledExperiments,function(experimentId){experimentIds[experimentId]=true});$.extend(options,{experimentIds:experimentIds});tracker.addLogEvent(name,"custom",options)};tracker.addLogEvent=function(name,type,options){options=options||{};preview.addEvent(name,options);if(!directive.shouldTrackEvents){return}tracker.logEvents.push({name:name,type:type,options:options});if(tracker.shouldSendLogEvents){tracker.sendLogEvents();timer.addEvent("Tracker","Tracking event '"+name+"'")}else{timer.addEvent("Tracker","Queued tracking event '"+name+"'")}};tracker.enableEngagementTracking=function(){$("html").one("mousedown touchstart",tracker.registerEngagement)};tracker.addPageviewEvent=function(url){var pageview_revenue_goals=data.getPageviewRevenueGoals();if(pageview_revenue_goals&&keys(pageview_revenue_goals)>0){each(keys(pageview_revenue_goals),function(key){tracker.addLogEvent(url,"pageview",{revenue:key,experimentIds:pageview_revenue_goals[key]})})}else{tracker.addLogEvent(url,"pageview")}};tracker.getMatchingGoalIds=function(event){var goals=data.getGoalExpressions();var goal_ids=[];for(var goal_id in goals){if(goals.hasOwnProperty(goal_id)){var expressions=goals[goal_id];$.each(expressions,function(i,expression){try{if(event.match(expression)){goal_ids.push(goal_id);return false}}catch(error){}return true})}}return goal_ids};tracker.getPendingLogEvents=function(){var pendingLogEventCookie=cookie.get(PENDING_LOG_EVENTS_COOKIE_NAME)||"[]";var values=[];try{values=json.parse(pendingLogEventCookie)}catch(e){}if(!isArrayLike(values)){values=[]}else{for(var i=0,nValues=values.length;i<nValues;i++){var value=values[i];if(typeof value!=="string"){values=[];break}else{try{var parsed=json.parse(value);values=[];break}catch(e){}}}}return values};tracker.makeLogRequest=function(query,doneCallback){timer.addEvent("Tracker","Making a log request.");tracker.makeRequest(data.getLogUrlRoot()+"?"+query,doneCallback)};tracker.makeImageRequest=function(fullUrl,doneCallback){var image=new Image();image.onload=doneCallback;fullUrl=tracker.stripXHRFlag(fullUrl);image.src=fullUrl;tracker.images.push(image)};tracker.ONLOAD_FIRED=false;tracker.onloadQueue=[];tracker.makeRequestAfterPageLoad=function(fullUrl,doneCallback){if(!tracker.ONLOAD_FIRED){tracker.onloadQueue.push({fullUrl:fullUrl,doneCallback:doneCallback})}else{$.each(tracker.onloadQueue,function(cnt,QueuedRequest){tracker.makeRequest(QueuedRequest.fullUrl,QueuedRequest.doneCallback)})}};$(window).load(function(){tracker.ONLOAD_FIRED=true;tracker.makeRequestAfterPageLoad()});tracker.makeRequest=function(fullUrl,doneCallback){if(!tracker.ONLOAD_FIRED){tracker.makeRequestAfterPageLoad(fullUrl,doneCallback);return}if(tracker.XHR_SUPPORTED){if(tracker.isXHRQuery(fullUrl)){try{var xhr=new XMLHttpRequest();if("withCredentials" in xhr){xhr.onload=doneCallback;xhr.open("GET",fullUrl,true);xhr.withCredentials=true;xhr.send();return}else{tracker.XHR_SUPPORTED=false;timer.addEvent("Tracker","Found that XHR with credentials is not supported in this browser.")}}catch(err){timer.addEvent("Tracker","XHR not supported");tracker.XHR_SUPPORTED=false}}}tracker.makeImageRequest(fullUrl,doneCallback)};tracker.isXHRQuery=function(query){return query.indexOf(tracker.XHR_FLAG)!==-1};tracker.stripXHRFlag=function(query){return query.replace("&"+tracker.XHR_FLAG,"")};tracker.optOut=function(shouldOptOut){shouldOptOut=(shouldOptOut===true||shouldOptOut==="true");var cookieValue=shouldOptOut?"true":"false";if(shouldOptOut){cookie.set(OPT_OUT_COOKIE_NAME,cookieValue,BUCKET_COOKIE_AGE);cookie.set(BUCKET_COOKIE_NAME,cookieValue,BUCKET_COOKIE_AGE);alert("You have successfully opted out of Optimizely for this domain.")}else{cookie.set(OPT_OUT_COOKIE_NAME,cookieValue,BUCKET_COOKIE_AGE);alert("You are NOT opted out of Optimizely for this domain.")}};tracker.registerEngagement=function(event){tracker.addLogEvent("engagement");$(this).unbind("mousedown touchstart",tracker.registerEngagement)};tracker.removePendingLogEvent=function(event){var pendingEvents=tracker.getPendingLogEvents();for(var i=0,nEvents=pendingEvents.length;i<nEvents;i++){if(pendingEvents[i]===event){pendingEvents.splice(i,1);break}}tracker.setPendingLogEventsCookie(pendingEvents);timer.addEvent("Tracker","Removed a pending log event from the pending events cookie.")};tracker.logEvents=[];tracker.shouldSendLogEvents=false;tracker.sendLogEvents=function(){var queryParameters=["a="+data.getProjectId(),"d="+data.getAdminAccountId(),"y="+data.getIPAnonymization()];if(directive.shouldOverrideThirdPartyCookie){queryParameters.push("override=true")}each(plan.getVariationIds(),function(variationId){var experimentId=data.getVariationExperimentId(variationId);queryParameters.push("x"+experimentId+"="+variationId)});each(segmenter.getSegmentTrackingData(),function(segmentId,segmentValue){queryParameters.push("s"+segmentId+"="+segmentValue)});var queryCommonSubstring=queryParameters.join("&");var individualQuerySubstrings=[];each(tracker.logEvents,function(event){var eventQueryParameters=[];if(event.name){eventQueryParameters.push("n="+encodeURIComponent(event.name));var goal_ids=tracker.getMatchingGoalIds(event.name);if(goal_ids.length>0){eventQueryParameters.push("g="+goal_ids.join(","))}}if(event.options.anonymous!==true){eventQueryParameters.push("u="+user.getId())}if(tracker.XHR_SUPPORTED&&tracker.shouldUseXHR(event)){eventQueryParameters.push(tracker.XHR_FLAG)}eventQueryParameters.push("t="+(+new Date()));if(directive.optOutThirdPartyCookies){eventQueryParameters.push("dtpc="+directive.optOutThirdPartyCookies)}if(event.options&&event.options.revenue){var enabledExperiments=data.getEnabledExperimentIds();var targetedExperiments=event.options.experimentIds;var nonTargetedExperiments=filter(enabledExperiments,function(elem){return !targetedExperiments[elem]});var eventPayload=[];if(nonTargetedExperiments.length>0){eventPayload=eventQueryParameters.concat(["f="+nonTargetedExperiments.join(",")]);individualQuerySubstrings.push(eventPayload.join("&"))}eventQueryParameters.push("v="+encodeURIComponent(event.options.revenue));if(keys(targetedExperiments).length>0){eventPayload=eventQueryParameters.concat(["f="+keys(targetedExperiments).join(",")]);individualQuerySubstrings.push(eventPayload.join("&"))}}else{eventQueryParameters.push("f="+data.getEnabledExperimentIds().join(","));individualQuerySubstrings.push(eventQueryParameters.join("&"))}if(event.type==="custom"){try{tracker.updateCustomEventCookie(event.name)}catch(e){}}});var pendingQueries=individualQuerySubstrings.concat(tracker.getPendingLogEvents());tracker.setPendingLogEventsCookie(pendingQueries);var eventsToSend=tracker.sentPendingLogEvents?individualQuerySubstrings:pendingQueries;tracker.sentPendingLogEvents=true;for(var i=0,nEvents=eventsToSend.length;i<nEvents;i++){var eventQuery=eventsToSend[i];tracker.makeLogRequest(queryCommonSubstring+"&"+eventQuery,function(){tracker.removePendingLogEvent(eventQuery)})}tracker.logEvents=[];tracker.shouldSendLogEvents=true};tracker.sendVerificationRequest=function(){if(!directive.shouldTrackEvents){return}var webHost=data.getWebHost();var fullUrl="//"+webHost+"/account/snippet_installed?project_id="+data.getProjectId()+"&wxhr=true";timer.addEvent("Tracker","Making snippet verification request.");tracker.makeRequest(fullUrl,null)};tracker.setPendingLogEventsCookie=function(events){var value=json.stringify(events);while(value.length>PENDING_LOG_EVENTS_COOKIE_MAX_LENGTH){events=events.slice(0,-1);value=json.stringify(events)}cookie.set(PENDING_LOG_EVENTS_COOKIE_NAME,value,PENDING_LOG_EVENTS_COOKIE_AGE)};tracker.updateCustomEventCookie=function(eventName){var MAX_NUMBER_OF_EVENTS_TRACKED_PER_PROJECT=10;var MAX_NUMBER_OF_PROJECTS_TRACKED_PER_PERSON=10;var userId=user.getId();var customEventCookies=cookie.get(CUSTOM_EVENTS_COOKIE_NAME)||"{}";try{customEventCookies=json.parse(customEventCookies)}catch(e){customEventCookies={}}var eventArray=customEventCookies[userId]||(customEventCookies[userId]=[]);eventArray=(isArrayLike(eventArray)?eventArray:[]);if($.inArray(eventName,eventArray)!==-1){eventArray.splice($.inArray(eventName,eventArray),1);eventArray.push(eventName)}else{eventArray.push(eventName)}if(eventArray.length>MAX_NUMBER_OF_EVENTS_TRACKED_PER_PROJECT){eventArray.shift()}customEventCookies[userId]=eventArray;var numberOfProjects=0;var smallestProjectId=null;var smallestProjectLength=0;for(var myProjectId in customEventCookies){if(customEventCookies.hasOwnProperty(myProjectId)){numberOfProjects++;if(customEventCookies[myProjectId].length>smallestProjectLength&&myProjectId!==userId){smallestProjectId=myProjectId;smallestProjectLength=customEventCookies[myProjectId].length}}}if(numberOfProjects>MAX_NUMBER_OF_PROJECTS_TRACKED_PER_PERSON&&smallestProjectId!==null){delete customEventCookies[smallestProjectId]}cookie.set(CUSTOM_EVENTS_COOKIE_NAME,json.stringify(customEventCookies),BUCKET_COOKIE_AGE)};tracker.shouldUseXHR=function(event){if(document.location.protocol==="https:"&&user.getBrowserId()==="ie"&&user.getBrowserVersion()>=10){return false}return event.type==="pageview"||event.type==="custom"};tracker.images=[];tracker.sentPendingLogEvents=false;tracker.XHR_FLAG="wxhr=true";tracker.XHR_SUPPORTED=true;template.evaluate=function(templateString){templateString=$.trim(templateString);var evaluatedValue="";if(window[GLOBAL]&&window[GLOBAL][GLOBAL_DATA]){var urlParamMatch=templateString.match(template.URL_PARAM_REGEX);if(urlParamMatch){var paramName=urlParamMatch[1];var paramValue=window[GLOBAL][GLOBAL_DATA]["visitor"]["params"][paramName];if(paramValue===undefined){paramValue=""}evaluatedValue=paramValue}else{var path=templateString.split(".");var value=window[GLOBAL];for(var i=0,nComponents=path.length;i<nComponents;i++){value=value[path[i]];if(value===undefined||value===null){value="";break}}evaluatedValue=""+value}}timer.addEvent("Template",templateString+" evaluated to: '"+evaluatedValue+"'");return evaluatedValue};template.render=function(originalCode){return originalCode.replace(template.TEMPLATE_REGEX,template.replacer)};template.replacer=function(matchedSubstring,capturedSubstring){return template.evaluate(capturedSubstring)};template.TEMPLATE_REGEX=/\{\{ *optimizely\.([^\n\r{}<>]*)\}\}/g;template.URL_PARAM_REGEX=/^data\.visitor\.params\.(.*)$/;preview.addEvent=function(event,options){options=options||{};var previewGlobal=window.optimizelyPreview;if(!previewGlobal){previewGlobal=[];window.optimizelyPreview=previewGlobal}if(!preview.hasAddedCurrentUrl){previewGlobal.push(["addEvent",window.location.href,{type:"url"}]);preview.hasAddedCurrentUrl=true}previewGlobal.push(["addEvent",event,options])};preview.acknowledge=function(){timer.addEvent("Preview","Preview acknowledgement received");preview.hasBeenAcknowledged=true};preview.addExperiment=function(experimentId){preview.previewingExperimentIds.push(experimentId)};preview.enablePreview=function(){if(!preview.hasBeenAcknowledged){preview.loadScript()}};preview.getPreviewingExperiments=function(){return preview.previewingExperimentIds};preview.hasCookie=function(){var previewCookie=cookie.get(PREVIEW_COOKIE_NAME||"{}");try{var parsedCookieObject=json.parse(previewCookie);for(var projectId in parsedCookieObject){if(projectId==data.getProjectId()){return true}}}catch(err){return false}return false};preview.initialize=function(){if(directive.shouldLoadPreview){preview.loadScript()}preview.hasRunInitialization=true};preview.loadScript=function(){timer.addEvent("Preview","Will load preview script");var parts=["https://",data.getWebHost(),"/js/preview-",data.getVersion(),".js?account_id=",data.getAdminAccountId()];var previewScriptUrl=parts.join("");timer.addEvent("Preview","Now loading preview script "+previewScriptUrl);loadScript(previewScriptUrl)};preview.setReason=function(objectId,reason){preview.reasons[objectId]=reason};preview.getReason=function(objectId){return preview.reasons[objectId]};preview.deleteReason=function(objectId){delete preview.reasons[objectId]};preview.hasAddedCurrentUrl=false;preview.hasBeenAcknowledged=false;preview.previewingExperimentIds=[];preview.reasons={};var BUCKET_COOKIE_AGE=60*60*24*365*10;var BUCKET_COOKIE_NAME="optimizelyBuckets";var CUSTOM_EVENTS_COOKIE_NAME="optimizelyCustomEvents";var EVALUATION_WAIT_INTERVAL=50;var FIRST_EVALUATION_WAIT_INTERVAL=10;var GLOBAL="optimizely";var GLOBAL_DATA="data";var GEO_CONDITION_WAIT_INTERVAL=1000;var IGNORED_VARIATION_ID="0";var OPT_OUT_COOKIE_NAME="optimizelyOptOut";var PENDING_LOG_EVENTS_COOKIE_AGE=15;var PENDING_LOG_EVENTS_COOKIE_MAX_LENGTH=1536;var PENDING_LOG_EVENTS_COOKIE_NAME="optimizelyPendingLogEvents";var PREVIEW_COOKIE_NAME="optimizelyPreview";var PUBLIC_SUFFIX_COOKIE_AGE=60*60*24*365*10;var PUBLIC_SUFFIX_COOKIE_NAME="optimizelyPublicSuffix";var REDIRECT_COOKIE_SECONDS=5;var REDIRECT_COOKIE_NAME="optimizelyRedirect";var REFERRAL_CHARTBEAT_COOKIE_NAME="optimizelyChartbeat";var REFERRER_REDIRECT_COOKIE_NAME="optimizelyReferrer";var SEGMENTS_COOKIE_AGE=60*60*24*365*10;var SEGMENTS_COOKIE_NAME="optimizelySegments";var SELECTOR_DELIMITER=",";var SOURCE_COOKIE_AGE=3;var SOURCE_COOKIE_DELIMITER="|||";var SOURCE_COOKIE_NAME="sourceCookie";var TEST_MODULE=window.OPTIMIZELY_TEST_MODULE;var TOP_LEVEL_DOMAINS=["com","local","net","org","xxx","edu","es","gov","biz","info","fr","nl","ca","de","kr","it","me","ly","tv","mx","cn","jp","il","in","iq"];var USER_ID_COOKIE_AGE=60*60*24*365*10;var USER_ID_COOKIE_NAME="optimizelyEndUserId";var VARIATION_CODE_DELIMITER="\n";var VARIATION_ID_DELIMITER="_";var VARIATION_URL_DELIMITER=" ";var VARIATION_URL_START="_optimizely_variation_url";var VARIATION_URL_START_RE=/\/\*\s*_optimizely_variation_url( +include="([^"]*)")?( +exclude="([^"]*)")?( +match_type="([^"]*)")?( +include_match_types="([^"]*)")?( +exclude_match_types="([^"]*)")?( +id="([^"]*)")?\s*\*\//;var VARIATION_URL_END="/* _optimizely_variation_url_end */";var VARIATION_URL_END_RE=/\/\*\s*_optimizely_variation_url_end\s*\*\//;ajax.makeCrossDomainRequest=function(url,callback){var callbackName=ajax.generateCallbackName();var document_=document;var head=document_.head||document_.getElementsByTagName("head")[0]||document_.documentElement;var script=document_.createElement("script");window[GLOBAL][callbackName]=callback;script.async="async";script.src=ajax.addCallbackQueryParameter(url,callbackName);head.insertBefore(script,head.firstChild)};ajax.addCallbackQueryParameter=function(url,callbackName){var containsQuery=url.indexOf("?")!==-1;var parts=[url,containsQuery?"&":"?","callback=",GLOBAL,".",callbackName];return parts.join("")};ajax.generateCallbackName=function(){return"callback"+Math.random().toString().replace("0.","")};cookie.get=function(name){var beginning=name+"=";var parts=(document.cookie||"").split(/\s*;\s*/);var values=[];each(parts,function(part){if(part.indexOf(beginning)===0){values.push(decodeURIComponent(part.substr(beginning.length)))}});var valueCount=values.length;if(valueCount>1){log("Cookie","Values found for %s: %s",name,valueCount)}return valueCount===0?null:values[0]};cookie.initialize=function(){var hostname=document.location.hostname;cookie.guessedPublicSuffix=cookie.guessPublicSuffix(hostname);log("Cookie","Guessed public suffix: %s",cookie.guessedPublicSuffix);cookie.publicSuffix=data.getPublicSuffix(hostname);log("Cookie","Public suffix (from data): %s",cookie.publicSuffix);if(cookie.apiPublicSuffix){log("Cookie","Api public suffix (from api): %s",cookie.apiPublicSuffix)}if(!cookie.publicSuffix){cookie.publicSuffix=cookie.get(PUBLIC_SUFFIX_COOKIE_NAME)||"";log("Cookie","Public suffix (from cookie): %s",cookie.publicSuffix)}if(!cookie.apiPublicSuffix&&!cookie.publicSuffix&&data.isRemotePublicSuffixEnabled()){log("Cookie","Making request for public suffix on DOM ready");$(curry(cookie.makePublicSuffixRequest,hostname))}};cookie.set=function(name,value,age){var domain=cookie.apiPublicSuffix||cookie.publicSuffix||cookie.guessedPublicSuffix;var hostname=document.location.hostname;if(!cookie.publicSuffix&&data.isRemotePublicSuffixEnabled()){cookie.queue.push({age:age,name:name,value:value})}if(domain&&domain===cookie.publicSuffix&&domain!==cookie.guessedPublicSuffix){cookie.deleteFromDomain(name,hostname);cookie.deleteFromDomain(name,cookie.guessedPublicSuffix)}cookie.setOnDomain(name,value,domain,age);var cookieValue=cookie.get(name);if(cookieValue===value){log("Cookie","Successful set %s=%s on %s",name,value,domain)}else{log("Cookie","Setting %s on %s apparently failed (%s != %s)",name,domain,cookieValue,value);log("Cookie","Setting %s on %s",name,hostname);cookie.setOnDomain(name,value,hostname,age);cookieValue=cookie.get(name);if(cookieValue===value){log("Cookie","Setting %s on %s worked; saving as new public suffix",name,hostname);cookie.guessedPublicSuffix=hostname}}};cookie.deleteFromDomain=function(name,domain){log("Cookie","Deleting %s on %s",name,domain);var parts=[name,"=","; domain=.",domain,"; path=/","; expires=",new Date(0).toUTCString()];document.cookie=parts.join("")};cookie.guessPublicSuffix=function(hostname){var parts=hostname.split(".");var publicSuffix=hostname;var last=parts[parts.length-1];if(parts.length>2&&parts[parts.length-2]==="appspot"&&last==="com"){publicSuffix=parts[parts.length-3]+".appspot.com"}else{if(parts.length>1&&inArray(last,TOP_LEVEL_DOMAINS)){publicSuffix=parts[parts.length-2]+"."+last}}return publicSuffix};cookie.handlePublicSuffixResponse=function(data){cookie.publicSuffix=data.public_suffix;log("Cookie","Public suffix request returned: %s",cookie.publicSuffix);cookie.set(PUBLIC_SUFFIX_COOKIE_NAME,cookie.publicSuffix,PUBLIC_SUFFIX_COOKIE_AGE);if(cookie.publicSuffix!==cookie.guessedPublicSuffix){while(cookie.queue.length>0){var setArguments=cookie.queue.shift();cookie.set(setArguments.name,setArguments.value,setArguments.age)}}cookie.queue=[]};cookie.makePublicSuffixRequest=function(hostname){var apiUrlRoot=data.getApiUrlRoot();var url=apiUrlRoot+"/iapi/public_suffix?host="+encodeURIComponent(hostname);ajax.makeCrossDomainRequest(url,cookie.handlePublicSuffixResponse)};cookie.setOnDomain=function(name,value,domain,age){var parts=[name,"=",encodeURIComponent(value),"; domain=.",domain,"; path=/"];if(age){var futureDate=new Date(+new Date()+age*1000);parts.push("; expires=",futureDate.toUTCString())}document.cookie=parts.join("")};cookie.setApiPublicSuffix=function(newPublicSuffix){cookie.apiPublicSuffix=String(newPublicSuffix)||"";log("Cookie","Api public suffix set to: %s",cookie.apiPublicSuffix)};cookie.guessedPublicSuffix="";cookie.apiPublicSuffix="";cookie.publicSuffix="";cookie.queue=[];user.getBrowserId=function(){user.detectionResults=user.detectionResults||detect();function get(){return user.detectionResults.browserId}user.getBrowserId=get;return get()};user.getBrowserLanguage=function(){var language="";try{language=navigator.userLanguage||window.navigator["language"];language=language.toLowerCase()}catch(error){language=""}return language};user.getBrowserVersion=function(){user.detectionResults=user.detectionResults||detect();function get(){return user.detectionResults.browserVersion}user.getBrowserVersion=get;return get()};user.getClickEventType=function(){var eventType="mousedown";var mobileType=user.getMobileId();if((mobileType==="iphone"||mobileType==="ipad"||mobileType==="ipod")){eventType="touchstart"}return eventType};user.getCurrentUrl=function(){return user.currentUrl||window.location.href};user.getDomain=function(url){if(!url){return""}try{return url.match(/:\/\/(?:www[0-9]?\.)?(.[^/:]+)/)[1]}catch(err){return""}};user.getReferrer=function(){var cookiedReferrer=cookie.get(REFERRER_REDIRECT_COOKIE_NAME);return cookiedReferrer||document.referrer||""};user.getReferringDomain=function(){var referrer=user.getReferrer();return user.getDomain(referrer)};user.getId=function(){var id=cookie.get(USER_ID_COOKIE_NAME);if(!id){id="oeu"+(+new Date())+"r"+Math.random();cookie.set(USER_ID_COOKIE_NAME,id,USER_ID_COOKIE_AGE)}return id};user.getIP=function(){var clientip="";try{clientip=window.optimizely["data"]["visitor"]["ip"]}catch(error){}if(clientip.toUpperCase()==="N/A"){clientip=""}return clientip};user.getLocation=function(){var rawGeoObject={};try{rawGeoObject=window.optimizely["data"]["visitor"]["location"]}catch(error){}var continent="";var country="";var region="";var city="";try{country=rawGeoObject.country.toUpperCase()||""}catch(error){country=""}try{region=rawGeoObject.region.toUpperCase()||""}catch(error){region=""}if(region==="N/A"){region=""}try{city=rawGeoObject.city.toUpperCase()||""}catch(error){city=""}if(city==="N/A"){city=""}try{continent=rawGeoObject.continent.toUpperCase()||""}catch(error){continent=""}if(continent==="N/A"){continent=""}return{city:city,continent:continent,country:country,region:region}};user.getMobileId=function(){user.detectionResults=user.detectionResults||detect();function get(){return user.detectionResults.mobileId}user.getMobileId=get;return get()};user.getNewVsReturning=function(){return user.isReturningUser?"returning":"new"};user.getOS=function(){var osString=navigator.appVersion||"";var os="";if(osString.indexOf("Win")!==-1){os="Windows"}if(osString.indexOf("Mac")!==-1){os="Mac"}if(osString.indexOf("Linux")!==-1){os="Linux"}return os};user.getSourceType=function(){var referrer=user.getReferrer();if(query.getValue("utm_source")||query.getValue("gclid")){return"campaign"}var SEARCH_TESTS=["google\\.\\w{2,3}(\\.\\w{2,3})?/(search|url)","https://(www)?\\.google\\..*?/$","bing\\.\\w{2,3}(\\.\\w{2,3})?/(search|url)","yahoo\\.\\w{2,3}(\\.\\w{2,3})?/search","baidu\\.\\w{2,3}(\\.\\w{2,3})?/s?"];for(var i=0;i<SEARCH_TESTS.length;i++){var searchRegExp=SEARCH_TESTS[i];var match=referrer.match(searchRegExp);if(match){return"search"}}if(referrer&&user.getDomain(referrer)!==user.getDomain(user.getCurrentUrl())){return"referral"}return null};user.isBot=function(){var BOT_LIST=["googlebot","yahoo! slurp","bingbot","msnbot"];var userAgent=navigator.userAgent.toLowerCase();for(var i=0;i<BOT_LIST.length;i++){var botSubstring=BOT_LIST[i];if(userAgent.indexOf(botSubstring)!==-1){return true}}return false};user.isMobile=function(){return user.getMobileId()!=="unknown"};user.initialize=function(){var bucketCookie=cookie.get(BUCKET_COOKIE_NAME);user.isReturningUser=(bucketCookie!==undefined&&bucketCookie!==null);if(user.isBot()){directive.shouldTrackEvents=false}};user.setCurrentUrl=function(url){log("User","Setting current URL to %s",url);user.currentUrl=url};user.currentUrl=undefined;user.isReturningUser=undefined;iapi.evaluateSegments=function(){segmenter.reset();segmenter.initialize()};iapi.initialize=function(){window[GLOBAL]["iapi"]={evaluateSegments:iapi.evaluateSegments}};evaluator.bindTrackElementFromApi=function(elementSelector,eventName){if(!elementSelector||!eventName){return}if(evaluator.isDocumentReady){timer.addEvent("Evaluator","Bound event "+eventName+" to selector "+elementSelector);evaluator.bindTrackElement(elementSelector,eventName)}else{var step={eventName:eventName,selector:elementSelector,type:"event '"+eventName+"' (click goal)",waitUntilSelectorReady:true};timer.addEvent("Evaluator","Add step to bind event "+step.eventName+" to selector "+step.selector);evaluator.steps.push(step)}};evaluator.evaluate=function(experimentIds,activatedExperimentIds){if(!directive.isEnabled){return}if(!isArrayLike(experimentIds)){experimentIds=[];evaluator.tellPreviewAboutExperiments(activatedExperimentIds)}else{evaluator.tellPreviewAboutExperiments(experimentIds)}experimentIds=experimentIds.concat(evaluator.evaluateQueue);evaluator.evaluateQueue=[];for(var i=0;i<experimentIds.length;i++){if(!arrayContains(evaluator.evaluatedExperimentIds,experimentIds[i])){evaluator.evaluatedExperimentIds.push(experimentIds[i])}}var newSteps=plan.getSteps(experimentIds);appendArray(evaluator.steps,newSteps);evaluator.doSteps()};evaluator.doSteps=function(){var shouldWait=false;evaluator.timeoutId=null;timer.addEvent("Evaluator",evaluator.waitCount+" times waited");while(!shouldWait&&evaluator.steps.length>0){timer.addEvent("Evaluator",evaluator.steps.length+" steps remaining");var step=evaluator.steps.shift();shouldWait=evaluator.shouldWaitBeforeStep(step);if(shouldWait){evaluator.steps.unshift(step)}else{if(step.eventName){timer.addEvent("Evaluator","Bound event "+step.eventName+" to selector "+step.selector);var options={};if(step.revenue){options={revenue:step.revenue,experimentIds:step.experimentIds}}evaluator.bindTrackElement(step.selector,step.eventName,options)}else{if(step.code){timer.addEvent("Evaluator","Run code: "+step.code);evaluator.evaluateCode(step.code,step.variationId)}}}}if(shouldWait){var waitInterval=evaluator.waitCount===0?FIRST_EVALUATION_WAIT_INTERVAL:EVALUATION_WAIT_INTERVAL;evaluator.timeoutId=setTimeout(evaluator.doSteps,waitInterval);evaluator.waitCount++}else{timer.addEvent("Evaluator",evaluator.waitCount+" total times waited")}};evaluator.enqueue=function(experimentId){evaluator.evaluateQueue=evaluator.evaluateQueue||[];evaluator.evaluateQueue.push(experimentId)};evaluator.getActiveExperimentIds=function(){return evaluator.evaluatedExperimentIds.concat(evaluator.evaluateQueue)};evaluator.getEvaluatedExperimentIds=function(){return evaluator.evaluatedExperimentIds};evaluator.isInQueue=function(experimentId){return inArray(experimentId,evaluator.evaluateQueue)};evaluator.evaluateCode=function(code,variationId){code=template.render(code);if(redirect.getRedirectURL(code)){timer.addEvent("Evaluator","Redirect detected");if(redirect.okToRedirect(code)){timer.addEvent("Evaluator","OK to redirect");if(!redirect.detectNoCookieRedirect(code)){timer.addEvent("Evaluator","setting a redirect cookie"+(variationId?" for variation: "+variationId:""));redirect.setRedirectCookie(variationId)}redirect.setReferrerCookie()}else{timer.addEvent("Evaluator","NOT OK to redirect");return}}eval("var $j = $;");try{eval(code)}catch(exception){var shouldLog=directive.shouldLog;directive.shouldLog=true;timer.addEvent("Evaluator","Error: "+exception.message);timer.addEvent("Evaluator","Code: "+code);directive.shouldLog=shouldLog;timer.addEvent("Evaluator","Failed to run code: "+exception.message)}};evaluator.bindTrackElement=function(elementSelector,eventName,options){options=options||{};if(evaluator.alreadyBoundClickTrackingEvents[elementSelector]){if(evaluator.alreadyBoundClickTrackingEvents[elementSelector][eventName]){return}}var eventType=user.getClickEventType();var handler=function(){tracker.addLogEvent(eventName,"custom",options)};var elem=$(elementSelector);if(elem.length>0){$(elementSelector).bind(eventType,handler)}else{$(document).delegate(elementSelector,eventType,handler)}if(!evaluator.alreadyBoundClickTrackingEvents[elementSelector]){evaluator.alreadyBoundClickTrackingEvents[elementSelector]={}}evaluator.alreadyBoundClickTrackingEvents[elementSelector][eventName]=eventType};evaluator.handleDocumentReady=function(code){evaluator.isDocumentReady=true;if(evaluator.timeoutId!==null){timer.addEvent("Evaluator","Document is ready");clearTimeout(evaluator.timeoutId);if(evaluator.delayDomExecuteMilliseconds>0){setTimeout(evaluator.doSteps,evaluator.delayDomExecuteMilliseconds)}else{evaluator.doSteps()}}};evaluator.setDelayDomExecute=function(delay){evaluator.delayDomExecuteMilliseconds=delay};evaluator.shouldWaitBeforeStep=function(step){var shouldWait=false;if(step.waitUntilDocumentReady&&!evaluator.isDocumentReady){timer.addEvent("Evaluator","Document not ready yet");shouldWait=true}else{if(step.waitUntilSelectorReady&&!evaluator.isDocumentReady){var selectors=step.selector;if(selectors){selectors=isArrayLike(selectors)?selectors:[selectors];for(var i=0;i<selectors.length;i++){var selector=selectors[i];if(selector===null||selector===undefined||!selector.length){continue}var selection=$(selector);if(selection.length===0){timer.addEvent("Evaluator","'"+selector+"' not found");shouldWait=true}}}}}return shouldWait};evaluator.tellPreviewAboutExperiments=function(experimentIds){if(!experimentIds){experimentIds=data.getExperimentIds()}for(var i=0;i<experimentIds.length;i++){var experimentId=experimentIds[i];var reason=preview.getReason(experimentId);if(reason){preview.addEvent("Not activating "+data.getExperimentString(experimentId)+" because "+reason+".",{type:"explanation"});preview.deleteReason(experimentId)}else{preview.addEvent("Activating "+data.getExperimentString(experimentId)+".",{type:"activation",experimentId:experimentId})}}};evaluator.alreadyBoundClickTrackingEvents={};evaluator.evaluatedExperimentIds=[];evaluator.evaluateQueue=evaluator.evaluateQueue||[];evaluator.delayDomExecuteMilliseconds=0;evaluator.isDocumentReady=false;evaluator.steps=[];evaluator.timeoutId=null;evaluator.waitCount=0;$(evaluator.handleDocumentReady);data.getAdminAccountId=function(){return data.getProperty("admin_account_id")};data.getApiUrlRoot=function(){return data.getUrlRoot("api_host")};data.getClickGoals=function(){if(!data.clickGoalsWithSeparatedSelectors){var clickGoals=data.getProperty("click_goals")||[];data.clickGoalsWithSeparatedSelectors=[];for(var i=0,nClickGoals=clickGoals.length;i<nClickGoals;i++){var goal=clickGoals[i];var selectors=goal.selector.split(SELECTOR_DELIMITER);for(var j=0,nSelectors=selectors.length;j<nSelectors;j++){var selector=selectors[j];if(selector){var goalData={event_name:goal.event_name,selector:selector};if("experiments" in goal){goalData.experiments=goal.experiments}else{if("url_conditions" in goal){goalData.url_conditions=goal.url_conditions}}if("revenue" in goal){goalData.revenue=goal.revenue}data.clickGoalsWithSeparatedSelectors.push(goalData)}}}}return data.clickGoalsWithSeparatedSelectors};data.getConditions=function(objectId,objectType){switch(objectType){case"experiment":return data.getExperimentConditions(objectId);case"segment":return data.getSegmentConditions(objectId);default:return[]}};data.getCustomRevenueGoals=function(){return data.getProperty("custom_revenue_goals")};data.getEnabledExperimentIds=function(){var enabledExperimentIds=filter(data.getExperimentIds(),data.isExperimentEnabled);data.getEnabledExperimentIds=function(){return enabledExperimentIds};return enabledExperimentIds};data.getEnabledVariationIds=function(experimentId){return data.getExperimentProperty(experimentId,"enabled_variation_ids")||[]};data.getExperimentCode=function(experimentId){return data.getExperimentProperty(experimentId,"code")||""};data.getExperimentConditions=function(experimentId){return data.getExperimentProperty(experimentId,"conditions")||[]};data.getGoalExpressions=function(){return data.getProperty("goal_expressions")};data.getProjectClickGoalsWithCustomTargeting=function(){var projectClickGoalsWithCustomTargeting=filter(data.getClickGoals(),function(goal){if(goal.experiments){return false}return condition.testUrls(goal.url_conditions||[])});return projectClickGoalsWithCustomTargeting};data.getSegmentIdByIdentifier=function(segmentIdentifier){var segments=data.getSegments();for(var segmentId in segments){if(Object.prototype.hasOwnProperty.call(segments,segmentId)){var segment=segments[segmentId];if(segment&&segment.api_name===segmentIdentifier){return String(segmentId)}}}return null};data.getSegmentAPIOnly=function(segmentId){return data.getSegmentProperty(segmentId,"is_api_only")||false};data.getSegmentConditions=function(segmentId){return data.getSegmentProperty(segmentId,"add_condition")||[]};data.getSegmentIdentifier=function(segmentId){return data.getSegmentProperty(segmentId,"api_name")||""};data.getSegmentName=function(segmentId){return data.getSegmentProperty(segmentId,"name")||""};data.getSegmentValueType=function(segmentId){return data.getSegmentProperty(segmentId,"segment_value_type")||""};data.getUrlConditions=function(experimentId){var conditions=data.getExperimentConditions(experimentId);var urlConditions=[];each(conditions,function(condition){if(condition.type==="url"){urlConditions.push(conditions)}});return urlConditions};data.getExperimentCss=function(experimentId){return data.getExperimentProperty(experimentId,"css")||""};data.getExperimentEvents=function(experimentId){var eventData={};var dashboardClickGoals=data.getExperimentProperty(experimentId,"events")||{};each(dashboardClickGoals,function(selector,eventName){eventData[selector]=[eventName]});var projectClickGoalsTrackingThisExperiment=filter(data.getClickGoals(),function(goal){if("experiments" in goal){return experimentId in goal.experiments}return false});for(var i=0;i<projectClickGoalsTrackingThisExperiment.length;i++){var goal=projectClickGoalsTrackingThisExperiment[i];if(!eventData[goal.selector]){eventData[goal.selector]=[]}eventData[goal.selector].push({eventName:goal.event_name,revenue:goal.revenue,experimentIds:goal.experiments})}return eventData};data.getExperiments=function(){return data.getProperty("experiments")||{}};data.getExperimentIds=function(){return keys(data.getProperty("experiments")||{})};data.getExperimentIgnorePercentage=function(experimentId){return data.getExperimentProperty(experimentId,"ignore")||0};data.getExperimentManualMode=function(experimentId){return data.getExperimentProperty(experimentId,"manual")||false};data.getExperimentName=function(experimentId){return data.getExperimentProperty(experimentId,"name")||""};data.getExperimentString=function(experimentId){var experimentName=data.getExperimentProperty(experimentId,"name")||"";return'experiment "'+experimentName+'" ('+experimentId+")"};data.getExperimentSectionIds=function(experimentId){return data.getExperimentProperty(experimentId,"section_ids")||[]};data.getExperimentVariationIds=function(experimentId){return data.getExperimentProperty(experimentId,"variation_ids")||[]};data.getExperimentVariationWeights=function(experimentId){return data.getExperimentProperty(experimentId,"variation_weights")||{}};data.getGoogleAnalyticsSlot=function(experimentId){var googleAnalytics=data.getGoogleAnalyticsProperty(experimentId);var slot=0;if(isDefined(googleAnalytics)){slot=googleAnalytics.slot||slot}return slot};data.getGoogleAnalyticsTracker=function(experimentId){var googleAnalytics=data.getGoogleAnalyticsProperty(experimentId);var tracker="";if(isDefined(googleAnalytics)){tracker=googleAnalytics.tracker||tracker}return tracker};data.getIPAnonymization=function(){return !!data.getProperty("ip_anonymization")};data.getLogUrlRoot=function(){return data.getUrlRoot("log_host",false,data.getProjectId())+"/event"};data.getPageviewRevenueGoals=function(){return data.getProperty("pageview_revenue_goals")};data.getProjectId=function(){return data.getProperty("project_id")};data.getRevision=function(){return data.getProperty("revision")};data.getSectionIds=function(){return keys(data.getProperty("sections")||{})};data.getSegments=function(){return data.getProperty("segments")||{}};data.getSegmentIds=function(){return keys(data.getProperty("segments")||{})};data.getExperimentVariationSectionId=function(experimentId,variationPartial){var sectionIds=data.getExperimentSectionIds(experimentId);for(var i=0;i<sectionIds.length;i++){var variationIds=data.getSectionVariationIds(sectionIds[i]);if(arrayContains(variationIds,variationPartial)){return sectionIds[i]}}return""};data.getPublicSuffix=function(domain){var domainToPublicSuffix={};var publicSuffixes=data.getProperty("public_suffixes")||{};each(publicSuffixes,function(publicSuffix,domains){each(domains,function(domain){domainToPublicSuffix[domain]=publicSuffix})});data.getPublicSuffix=function(domain){return domainToPublicSuffix[domain]||""};return data.getPublicSuffix.call(null,domain)};data.getSectionName=function(sectionId){return data.getSectionProperty(sectionId,"name")||""};data.getSectionVariationIds=function(sectionId){return data.getSectionProperty(sectionId,"variation_ids")||[]};data.getSiteCatalystEVar=function(experimentId){return data.getExperimentProperty(experimentId,"site_catalyst_evar")||null};data.getSiteCatalystProp=function(experimentId){return data.getExperimentProperty(experimentId,"site_catalyst_prop")||null};data.getVariations=function(){return data.getProperty("variations")||{}};data.getVariationIds=function(){return keys(data.getProperty("variations")||{})};data.getVariationCode=function(variationId){var codes=[];var variationIds=variationId.split(VARIATION_ID_DELIMITER);each(variationIds,function(variationId){var code=data.getVariationProperty(variationId,"code");if(code){codes.push(code)}});return codes.join("\n")};data.getVariationExperimentId=function(variationId){var experimentIds={};each(data.getExperimentIds(),function(experimentId){each(data.getExperimentSectionIds(experimentId),function(sectionId){each(data.getSectionVariationIds(sectionId),function(variationId){experimentIds[variationId]=experimentId})});each(data.getExperimentVariationIds(experimentId),function(variationId){experimentIds[variationId]=experimentId})});data.getVariationExperimentId=function(variationId){var variationIds=variationId.split(VARIATION_ID_DELIMITER);return experimentIds[variationIds[0]]||""};return data.getVariationExperimentId.call(null,variationId)};data.getVariationIdByIndex=function(experimentId,variationIndex){var variationIds=data.getExperimentVariationIds(experimentId);var variationId=null;try{variationId=variationIds[variationIndex]}catch(e){}return variationId};data.getVariationIndex=function(variationId){var experimentId=data.getVariationExperimentId(variationId);var sectionIds=data.getExperimentSectionIds(experimentId);if(sectionIds.length===0){var expVariationIds=data.getExperimentVariationIds(experimentId);for(var i=0;i<expVariationIds.length;i++){if(expVariationIds[i]===variationId){return i}}}else{var variationIdSplit=variationId.split(VARIATION_ID_DELIMITER);var variationsBySection=[];for(var j=0;j<sectionIds.length;j++){var sectionId=sectionIds[j];var sectionVariationIds=data.getSectionVariationIds(sectionId);for(var k=0;k<sectionVariationIds.length;k++){var thisVariationId=sectionVariationIds[k];if(thisVariationId===variationIdSplit[j]){variationsBySection.push(k)}}}if(variationsBySection!==[]){return variationsBySection}}return -1};data.getVariationName=function(variationId,separator){separator=separator||", ";var namesArray=data.getVariationNamesArray(variationId);return namesArray.join(separator)};data.getVariationNamesArray=function(variationId){var names=[];var variationIds=variationId.split(VARIATION_ID_DELIMITER);each(variationIds,function(variationId){names.push(data.getVariationProperty(variationId,"name")||"Unnamed")});return names};data.getVariationSectionId=function(variationId){var sectionIds={};each(data.getSectionIds(),function(sectionId){each(data.getSectionVariationIds(sectionId),function(variationId){sectionIds[variationId]=sectionId})});data.getVariationSectionId=function(variationId){var variationIds=variationId.split(VARIATION_ID_DELIMITER);return sectionIds[variationIds[0]]||""};return data.getVariationSectionId.call(null,variationId)};data.getVersion=function(){return data.getProperty("version")};data.getWebHost=function(){return data.getProperty("www_host")};data.isExperimentEnabled=function(experimentId){return !!data.getExperimentProperty(experimentId,"enabled")};data.isBlueKaiEnabled=function(){return !!data.getBlueKaiProperty()};data.isChartbeatEnabled=function(experimentId){return !!data.getChartbeatProperty(experimentId)};data.isClickTaleEnabled=function(experimentId){return !!data.getClickTaleProperty(experimentId)};data.isCrazyEggEnabled=function(experimentId){return !!data.getCrazyEggProperty(experimentId)};data.isGeotargetingEnabled=function(experimentOrSegmentId){return !!data.getGeotargetingProperty(experimentOrSegmentId)};data.isGoogleAnalyticsEnabled=function(experimentId){return !!data.getGoogleAnalyticsProperty(experimentId)};data.isInstallationVerified=function(){return !!data.getProperty("installation_verified")};data.isKissMetricsEnabled=function(){return !!data.getProperty("kissmetrics")};data.isMixpanelEnabled=function(experimentId){return !!data.getMixpanelProperty(experimentId)};data.isRemotePublicSuffixEnabled=function(){return !!data.getProperty("remote_public_suffix")};data.isStagingLogEnabled=function(){return !!data.getProperty("use_staging_log")};data.getExperimentProperty=function(experimentId,propertyName){return data.getProperty("experiments",experimentId,propertyName)};data.getBlueKaiProperty=function(){return data.getProperty("bluekai")};data.getChartbeatProperty=function(experimentId){return data.getExperimentProperty(experimentId,"chartbeat")};data.getClickTaleProperty=function(experimentId){return data.getExperimentProperty(experimentId,"clicktale")};data.getCrazyEggProperty=function(experimentId){return data.getExperimentProperty(experimentId,"crazyegg")};data.getGeotargetingProperty=function(experimentOrSegmentId){var property="uses_geotargeting";return data.getExperimentProperty(experimentOrSegmentId,property)||data.getSegmentProperty(experimentOrSegmentId,property)};data.getGoogleAnalyticsProperty=function(experimentId){return data.getExperimentProperty(experimentId,"google_analytics")};data.getMixpanelProperty=function(experimentId){return data.getExperimentProperty(experimentId,"mixpanel")};data.getProperty=function(variableArguments){var object=DATA;var result=each(arguments,function(key){var value=object[key];if(isDefined(value)){object=value}else{return null}});if(result!==null){return object}};data.getSectionProperty=function(sectionId,propertyName){return data.getProperty("sections",sectionId,propertyName)};data.getSegmentProperty=function(segmentId,propertyName){return data.getProperty("segments",segmentId,propertyName)};data.getUrlRoot=function(key,secure,subdomain){var host=data.getProperty(key);if(subdomain){host=subdomain.toString()+"."+host}var protocol=document.location.protocol;if(protocol==="chrome-extension:"){protocol="http:"}if(secure){protocol="https:"}return protocol+"//"+host};data.getVariationProperty=function(variationId,propertyName){return data.getProperty("variations",variationId,propertyName)};data.clickGoalsWithSeparatedSelectors=null;condition.isReadyToTest=function(experimentOrSegmentId){var readyToTest=false;var usesGeotargeting=data.isGeotargetingEnabled(experimentOrSegmentId);if(usesGeotargeting){try{var locationObj=window.optimizely["data"]["visitor"]["location"];if(keys(locationObj)>0&&(locationObj.continent!==""||locationObj.country!==""||locationObj.region!==""||locationObj.city!=="")){readyToTest=true}}catch(error){}}else{readyToTest=true}if(!readyToTest){timer.addEvent("Condition","Not ready to test (geotargeting): "+experimentOrSegmentId)}return readyToTest};condition.passesTests=function(objectId,options){var manualMode=options.manualMode===true;var objectType=options.objectType?options.objectType:"experiment";var isExperiment=objectType==="experiment";var defaultFail=options.defaultFail===true;timer.addEvent("Condition","Testing "+objectType+" "+objectId);var isEnabled=isExperiment&&data.isExperimentEnabled(objectId);var isManualExperiment=isExperiment&&data.getExperimentManualMode(objectId);var conditions=data.getConditions(objectId,objectType);if(isExperiment&&!isEnabled&&directive.previewExperimentId!==objectId){timer.addEvent("Condition","Failed for "+objectType+" "+objectId+" (paused)");preview.setReason(objectId,"it is paused");return false}else{if(isExperiment&&!manualMode&&isManualExperiment){timer.addEvent("Condition"," Failed for "+objectType+" "+objectId+" (manual activation mode)");preview.setReason(objectId,"it is set to use manual activation mode");return false}else{if(!condition.test(conditions,objectId,objectType,defaultFail)){timer.addEvent("Condition","Failed for "+objectType+" "+objectId+" (condition failed)");return false}}}return true};condition.test=function(conditions,objectId,objectType,defaultFail){objectType=objectType||"experiment";var isExperiment=objectType==="experiment";var succeeded=true;if(defaultFail){succeeded=false}var testFunctions=condition.testFunctions;each(conditions,function(condition){var type=condition.type;if(isExperiment&&condition.only_first_time&&plan.containsExperiment(objectId)){timer.addEvent("Condition",type+" condition passed because it only gets checked when bucketing",true)}else{var test=testFunctions[type];var shouldPass=!condition.not;var passed=test(condition);var isUnacceptable=(passed!==shouldPass);var passVerb=passed?"passed":"failed";var shouldPassVerb=shouldPass?"pass":"fail";var verboseReason="the visitor "+passVerb+" a "+type+" targeting condition  when it needed to "+shouldPassVerb;timer.addEvent("Condition","Found that "+verboseReason,!isUnacceptable);if(isUnacceptable){succeeded=false;preview.setReason(objectId,verboseReason);return false}}});return succeeded};condition.testBrowsers=function(condition){var browserId=user.getBrowserId();var browserVersion=user.getBrowserVersion();var passed=false;var mobileId=user.getMobileId();each(condition.values,function(targetedBrowser){if(mobileId!=="unknown"){passed=targetedBrowser==="mobile"||targetedBrowser===mobileId;timer.addEvent("Condition",mobileId,true)}else{if(targetedBrowser.indexOf(browserId)===0){var version=targetedBrowser.substr(browserId.length);passed=version===""||(version<=browserVersion&&browserVersion<Number(version)+1)}}if(passed){return null}});return passed};condition.testCode=function(condition){var code=condition.value;if(code===undefined){return true}try{return Boolean(eval(code))}catch(error){return false}};condition.testCookies=function(condition){var matchesAny=false;var names=condition.names||[];var values=condition.values||[];for(var i=0;i<names.length;i++){var cookieValue=cookie.get(names[i]);if(isDefined(values[i])&&trim(values[i])!==""){matchesAny=matchesAny||(values[i]===cookieValue)}else{matchesAny=matchesAny||(cookieValue!==null&&cookieValue!==undefined)}if(matchesAny){return true}}return false};condition.testCustomTags=function(tagCondition){if(!api.customTags){return false}var tags=tagCondition.values;for(var i=0;i<tags.length;i++){var key=tags[i]["key"],value=tags[i]["value"];if(value===undefined){return Object.prototype.hasOwnProperty.call(api.customTags,key)}else{if(String(api.customTags[key])==value){return true}}}return false};condition.testEvents=function(condition){var customEventCookies=cookie.get(CUSTOM_EVENTS_COOKIE_NAME)||"{}";try{customEventCookies=json.parse(customEventCookies)}catch(e){customEventCookies={}}var triggeredCustomEvents=customEventCookies[user.getId()]||[];if(!isArrayLike(triggeredCustomEvents)){triggeredCustomEvents=[]}var passed=false;each(condition.values,function(eventName){if($.inArray(eventName,triggeredCustomEvents)!==-1){passed=true;return true}});return passed};condition.testIPs=function(condition){var userIp=user.getIP();for(var i=0;i<condition.values.length;i++){var value=condition.values[i];var matchString=value.value;var type=value.match;switch(type){case"exact":if(userIp==matchString&&userIp!=""){return true}break;case"prefix":if(userIp.indexOf(matchString)==0){return true}break;case"regex":try{var regex=RegExp(matchString)}catch(error){return false}if(regex.test(userIp)){return true}break}}return false};condition.testLanguages=function(condition){var browserLanguage=user.getBrowserLanguage();var passed=false;each(condition.values,function(language){passed=language==="any"||browserLanguage.indexOf(language)===0;if(passed){return null}});return passed};condition.testLocations=function(condition){var userLocation=user.getLocation();for(var i=0;i<condition.values.length;i++){var locSplit=condition.values[i].split("|");var country=$.trim(locSplit[0]);var region=$.trim(locSplit[1]);var city=$.trim(locSplit[2]);var continent=$.trim(locSplit[3]);switch(locSplit.length){case 1:if(userLocation.country===country){return true}break;case 2:if(userLocation.region===region&&userLocation.country===country){return true}break;case 3:if(userLocation.city===city&&(userLocation.region===region||""===region)&&userLocation.country===country){return true}break;case 4:if(userLocation.continent===continent){return true}break}}return false};condition.testQueries=function(condition){if(condition.values.length===0){return true}var shouldReturn=false;var queryNameValuePairs=query.getAllParameters();each(condition.values,function(value){var queryKey=value.key;var queryValue=value.value||"";for(var i=0;i<queryNameValuePairs.length;i++){var pair=queryNameValuePairs[i];var pairKey=pair[0];var pairValue=pair[1];if(queryKey!==""&&queryKey===pairKey){if(queryValue===""||queryValue===pairValue){shouldReturn=true;return shouldReturn}}}});return shouldReturn};condition.testReferrers=function(condition){var url=document.referrer;for(var i=0;i<condition.values.length;i++){var value=condition.values[i];var string=value.value;var type=value.match;var matched=optly.match.matchUrl(url,string,type);timer.addEvent("Condition","Testing referrer "+url+" against  "+string+" ("+type+")",true);if(matched){return true}}return false};condition.testSegments=function(condition){var passed=false;var segmentsList=segmenter.getSegmentsList();each(condition.values,function(targetSegmentId){if(arrayContains(segmentsList,targetSegmentId)){passed=true}});return passed};condition.testUrls=function(condition){var url=user.getCurrentUrl();for(var i=0;i<condition.values.length;i++){var value=condition.values[i];var string=value.value;var type=value.match;var matched=optly.match.matchUrl(url,string,type);timer.addEvent("Condition","Testing URL "+url+" against  "+string+" ("+type+")",true);if(matched){return true}}return false};condition.testVisitor=function(condition){var conditionType=condition.value;var newVsReturning=user.getNewVsReturning();switch(conditionType){case"new":if(newVsReturning==="returning"){return false}return true;case"returning":return newVsReturning==="returning"}return true};condition.testFunctions={browser:condition.testBrowsers,code:condition.testCode,cookies:condition.testCookies,custom_tag:condition.testCustomTags,event:condition.testEvents,ip:condition.testIPs,language:condition.testLanguages,location:condition.testLocations,query:condition.testQueries,referrer:condition.testReferrers,segment:condition.testSegments,url:condition.testUrls,visitor:condition.testVisitor};segmenter.initialize=function(){segmenter.loadSegmentsCookie();segmenter.evaluateSegments();segmenter.addChangeHandler(segmenter.saveSegmentsCookie);segmenter.callChangeHandlers();integrator.loadThirdPartySegments()};segmenter.loadSegmentsCookie=function(){timer.addEvent("Segmenter","Loading segments cookie.");var segmentsFromCookie=cookie.get(SEGMENTS_COOKIE_NAME);if(!segmentsFromCookie){return}try{segmentsFromCookie=(json.parse(segmentsFromCookie))}catch(e){segmentsFromCookie={}}each(segmentsFromCookie,function(id,value){timer.addEvent("Segmenter","Segments cookie contains segment id: "+id);segmenter.visitorSegments[id]=value})};segmenter.saveSegmentsCookie=function(){var prunedSegments={};each(segmenter.visitorSegments,function(id,value){if(value){prunedSegments[id]=value}});cookie.set(SEGMENTS_COOKIE_NAME,json.stringify(prunedSegments),SEGMENTS_COOKIE_AGE)};segmenter.addChangeHandler=function(subscriber){segmenter.changeHandlers.push(subscriber)};segmenter.addToSegment=function(segmentIdOrAPIName,segmentValue){var segmentId=data.getSegmentIdByIdentifier(segmentIdOrAPIName)||segmentIdOrAPIName;if(segmentId&&!isNaN(parseInt(segmentId,10))){if(!segmentValue&&segmentValue!==""){segmentValue=true}segmenter.visitorSegments[segmentId]=segmentValue;segmenter.callChangeHandlers()}else{timer.addEvent("Segmenter","Unable to find segment for ID: "+segmentId)}};segmenter.callChangeHandlers=function(){each(segmenter.changeHandlers,function(changeHandler){changeHandler()})};segmenter.evaluateSegment=function(segmentId){timer.addEvent("Segmenter","Evaluating Segment "+segmentId);var addPasses=condition.passesTests(segmentId,{objectType:"segment"});segmenter.tellPreviewAboutSegment(segmentId,"add");if(addPasses){var segmentValue=segmenter.evaluateSegmentValue(segmentId);if(segmentValue!==null){segmenter.addToSegment(segmentId,segmentValue)}}return{addPasses:addPasses,segmentValue:segmentValue}};segmenter.evaluateSegments=function(){timer.addEvent("Segmenter","Evaluating all segments.");var segmentIds=data.getSegmentIds();for(var i=0;i<segmentIds.length;i++){var segmentId=segmentIds[i];if(data.getSegmentAPIOnly(segmentId)){timer.addEvent("Segmenter","Not doing anything since segment "+segmentId+" is api only.")}else{timer.addEvent("Segmenter","Testing whether to add to segment "+segmentId);if(condition.isReadyToTest(segmentId)){segmenter.evaluateSegment(segmentId)}else{api.addGeoDelayedSegment(segmentId)}}}};segmenter.evaluateSegmentValue=function(segmentId){var segmentValueType=data.getSegmentValueType(segmentId);var val=null,fallbackVal=null;switch(segmentValueType){case"browser":val=user.getBrowserId();fallbackVal="unknown";break;case"campaign":val=query.getValue("utm_campaign");fallbackVal="none";break;case"country":val=user.getLocation()["country"];fallbackVal="unknown";break;case"language":val=user.getBrowserLanguage();fallbackVal="none";break;case"mobile":val=user.isMobile();break;case"os":val=user.getOS();fallbackVal="unknown";break;case"referrer":val=user.getReferringDomain();fallbackVal="none";break;case"source_type":val=user.getSourceType();fallbackVal="direct";break;default:return"true"}if(val===null){if(!segmenter.visitorSegments.hasOwnProperty(segmentId)){val=fallbackVal}else{return null}}return segmenter.standardizeValue(val)};segmenter.getSegmentsList=function(){var segmentsList=[];each(segmenter.visitorSegments,function(segmentId,segmentValue){if(segmentValue){segmentsList.push(segmentId)}});return segmentsList};segmenter.getSegmentTrackingData=function(){var segmentsTrackingData={};each(segmenter.visitorSegments,function(segmentId,segmentValue){if(segmentValue){segmentsTrackingData[String(segmentId)]=segmentValue}});return segmentsTrackingData};segmenter.getSegmentValue=function(segmentId){return segmenter.visitorSegments[segmentId]};segmenter.reset=function(){segmenter.visitorSegments={}};segmenter.handleOfflineSegmentResponse=function(data){var segmentId;for(segmentId in data.map){log("Segmenter","Offline segment request returned: %s, %s",segmentId,data.map[segmentId]);segmenter.addToSegment(segmentId,data.map[segmentId])}};segmenter.removeFromSegment=function(segmentIdOrAPIName,saveChanges){var segmentId=data.getSegmentIdByIdentifier(segmentIdOrAPIName)||segmentIdOrAPIName;if(segmenter.visitorSegments[segmentId]){segmenter.visitorSegments[segmentId]=false;if(typeof saveChanges==="undefined"||saveChanges){segmenter.callChangeHandlers()}}else{timer.addEvent("Segmenter","Not removing "+segmentIdOrAPIName+", not found")}};segmenter.removeFromAllSegments=function(){var segmentIds=data.getSegmentIds();each(segmentIds,function(segmentId){segmenter.removeFromSegment(segmentId,false)});segmenter.callChangeHandlers()};segmenter.standardizeValue=function(segmentValue,maxLength){maxLength=maxLength||segmenter.MAX_VALUE_LENGTH;try{segmentValue=decodeURIComponent(segmentValue)}catch(e){}segmentValue=String(segmentValue).toLowerCase().substring(0,maxLength);return encodeURIComponent(segmentValue)};segmenter.tellPreviewAboutSegment=function(segmentId,addOrRemove){var addOrRemoveVerb=addOrRemove==="add"?"adding":"removing";var toOrFromPreposition=addOrRemove==="add"?"to":"from";var reason=preview.getReason(segmentId);if(reason){preview.addEvent("Not "+addOrRemoveVerb+" visitor "+toOrFromPreposition+" segment "+data.getSegmentName(segmentId)+" because "+reason+".",{type:"explanation"});preview.deleteReason(segmentId)}else{preview.addEvent("Segment "+addOrRemove+" condition matches, "+addOrRemoveVerb+toOrFromPreposition+" segment "+data.getSegmentName(segmentId),{type:"explanation"})}};segmenter.changeHandlers=[];segmenter.visitorSegments={};segmenter.MAX_VALUE_LENGTH=20;timer.addEvent=function(category,message,isVerbose){timer.eventQueue.push({date:new Date(),category:category,message:message,isVerbose:isVerbose||false});if(timer.shouldOutputImmediately){timer.flushLogs()}};timer.enableLogging=function(){directive.shouldLog=true};timer.enableVerboseLogging=function(){directive.shouldLog=true;directive.shouldLogVerbosely=true};timer.flushLogs=function(){if(directive.shouldLog){each(timer.eventQueue,function(event){if(!event.logged&&(!event.isVerbose||event.isVerbose===directive.shouldLogVerbosely)){var time=+event.date;var lastTimeDifference=timer.lastTime?time-timer.lastTime:0;var startTimeDifference=timer.startTime?time-timer.startTime:0;var timeString=" [time "+startTimeDifference+" +"+lastTimeDifference+"]";log(event.category,event.message+timeString);timer.lastTime=time;if(!timer.startTime){timer.startTime=time}event.logged=true}});timer.shouldOutputImmediately=true}};timer.lastTime=null;timer.startTime=null;timer.eventQueue=[];timer.shouldOutputImmediately=false;function appendArray(targetArray,sourceArray){targetArray.push.apply(targetArray,sourceArray)}function arrayContains(targetArray,key){for(var i=0;i<targetArray.length;i++){if(key==targetArray[i]){return true}}return false}function chooseWeightedIndex(weightArray){var nElements=weightArray.length;if(nElements===0){return null}if(nElements===1){return 0}var sumWeight=0;for(var i=0;i<nElements;i++){sumWeight+=weightArray[i]}var random=Math.random()*sumWeight;for(var i=0;i<nElements;i++){if(random<weightArray[i]){return i}random-=weightArray[i]}return getRandomNumber(nElements)}function containsString(string,substring){return string.indexOf(substring)!==-1}function containsRegEx(string,regEx){return Boolean(string.match(regEx))}function curry(function_,variableArguments){var boundArguments=slice(arguments,1);return function(){var arguments_=slice(arguments);prependArray(arguments_,boundArguments);return function_.apply(this,arguments_)}}function each(object,function_,context){var value=null;if(isArrayLike(object)){var length=object.length;for(var index=0;index<length;++index){value=function_.call(context,object[index],index);if(isDefined(value)){return value}}}else{for(var key in object){if(Object.prototype.hasOwnProperty.call(object,key)){value=function_.call(context,key,object[key]);if(isDefined(value)){return value}}}}return value}function extend(target,source){each(source,function(key,value){target[key]=value})}function filter(list,predicate){var filtered=[];for(var i=0,len=list.length;i<len;i++){var element=list[i];if(predicate(element)){filtered.push(element)}}return filtered}function format(pattern,variableArguments){var arguments_=arguments;var index=1;return pattern.replace(/%s/g,function(){return arguments_[index++]})}function getRandomNumber(maximum){return Math.floor(Math.random()*maximum)}function inArray(value,array){return each(array,function(item){if(item===value){return true}})||false}function isArrayLike(object){return object&&typeof object==="object"&&object.length&&typeof object.length==="number"}function isDefined(value){return typeof value!=="undefined"}function isNumberLike(object){return(typeof object==="number"||typeof object==="string")&&Number(object)==object}var keys=function(object){keys=(Object.keys)||function(object){var keys_=[];each(object,function(key){keys_.push(key)});return keys_};return keys.call(null,object)};var loadScript=function(scriptUrl){var head=document.head||document.getElementsByTagName("head")[0]||document.documentElement;var script=document.createElement("script");script.src=scriptUrl;script.type="text/javascript";head.appendChild(script)};var log=function(category,message,variableArguments){var console=window.console;if(directive.shouldLog&&console&&console.log){var parameters=slice(arguments,1);parameters[0]="Optimizely / "+category+" / "+message;Function.prototype.apply.call(console.log,console,parameters)}};function prependArray(targetArray,sourceArray){targetArray.unshift.apply(targetArray,sourceArray)}function quote(string){return string.replace(/([\f\n\r\t\\'"])/g,"\\$1")}function slice(array,start,end){return Array.prototype.slice.call(array,start||0,end||array.length)}function trim(string){return string.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")}optly.taint.createDeconstructingFunction=function(originalFunction){return function(object){var shouldDeconstruct=typeof object==="object"&&optly.taint.isObjectPrototypeTainted();if(!shouldDeconstruct){return originalFunction.apply(this,arguments)}else{var result=null;for(var key in object){if(object.hasOwnProperty(key)){result=originalFunction.call(this,key,object[key])}}return result}}};optly.taint.createCleanJQueryEach=function(originalFunction,$){return function(object,callback,args){var shouldClean=(object.length===undefined||$.isFunction(object))&&optly.taint.isObjectPrototypeTainted();if(!shouldClean){originalFunction.apply(this,arguments)}else{if(args){for(var name in object){if(object.hasOwnProperty(name)&&callback.apply(object[name],args)===false){break}}}else{for(var name in object){if(object.hasOwnProperty(name)&&!callback.call(object[name],name,object[name])===false){break}}}}return object}};optly.taint.createCleanJQueryInit=function(originalFunction,$){var callOriginalFunctionRaw=function(selector,context,rootJQuery){return new originalFunction(selector,context,rootJQuery)};var nativeGetElementsByClassName=optly.nativity.getNativeGetElementsByClassName();return function(selector,context,rootJQuery){var callOriginalFunction=callOriginalFunctionRaw;var currentGetByClass=document.getElementsByClassName;if(!optly.nativity.isNativeFunction(currentGetByClass)&&nativeGetElementsByClassName){callOriginalFunction=function(selector,context,rootJQuery){document.getElementsByClassName=nativeGetElementsByClassName;var result=callOriginalFunctionRaw(selector,context,rootJQuery);document.getElementsByClassName=currentGetByClass;return result}}var shouldClean=typeof selector==="string"&&context&&$.type(context)==="object"&&optly.taint.isObjectPrototypeTainted();if(!shouldClean){return callOriginalFunction(selector,context,rootJQuery)}else{var result=callOriginalFunction(selector,undefined,rootJQuery);result.attr(context);return result}}};optly.taint.fixJQueryTaintIssues=function($){$.fn.attr=optly.taint.createDeconstructingFunction($.fn.attr);$.fn.css=optly.taint.createDeconstructingFunction($.fn.css);$.fn.extend=optly.taint.createDeconstructingFunction($.fn.extend);$.each=optly.taint.createCleanJQueryEach($.each,$);$.fn.init=optly.taint.createCleanJQueryInit($.fn.init,$)};optly.taint.isObjectPrototypeTainted=function(){for(var key in {}){return true}return false};optly.domain.check=function(url){var location=optly.domain.getLocation(url);for(var i=0,nRules=optly.domain.PATH_BLACK_LIST.length;i<nRules;i++){var pattern=optly.domain.PATH_BLACK_LIST[i];if(pattern.test(location.pathname)){return false}}for(i=0,nRules=optly.domain.HOST_BLACK_LIST.length;i<nRules;i++){pattern=optly.domain.HOST_BLACK_LIST[i];if(pattern.test(location.hostname)){return false}}var whiteList=new RegExp(optly.domain.WHITE_LIST);return whiteList.test(location.hostname)};optly.domain.getLocation=function(url){var anchor=document.createElement("a");anchor.href=url;return anchor};optly.domain.HOST_BLACK_LIST=[/(edit|preview)(-local)?(-hrd)?\.optimizely\.(com|test)/,/optimizelyedit(-hrd)?\.appspot\.com/,/cdn[^\.]*\.optimizely\.com/];optly.domain.PATH_BLACK_LIST=[/^\/api\/client/];optly.domain.WHITE_LIST="(www-devel.optimizely.com$)|(www-devel.optimizely.appspot.com$)|(www-devel-dot-optimizely.appspot.com$)|(.optimizely.com$)|(.optimizely.at$)|(.optimizely.be$)|(.optimizely.bg$)|(.optimizely.by$)|(.optimizely.ch$)|(.optimizely.cl$)|(.optimizely.co.il$)|(.optimizely.co.nz$)|(.optimizely.co.uk$)|(.optimizely.com.br$)|(.optimizely.com.hr$)|(.optimizely.com.mx$)|(.optimizely.cz$)|(.optimizely.de$)|(.optimizely.es$)|(.optimizely.dk$)|(.optimizely.fr$)|(.optimizely.gr$)|(.optimizely.hk$)|(.optimizely.ie$)|(.optimizely.it$)|(.optimizely.jp$)|(.optimizely.lt$)|(.optimizely.lu$)|(.optimizely.lv$)|(.optimizely.nl$)|(.optimizely.mx$)|(.optimizely.pl$)|(.optimizely.pt$)|(.optimizely.ro$)|(.optimizely.ru$)|(.optimizely.se$)|(.optimizely.sg$)|(.optimisely.com$)|(.optimisely.at$)|(.optimisely.be$)|(.optimisely.bg$)|(.optimisely.by$)|(.optimisely.ch$)|(.optimisely.cl$)|(.optimisely.co.il$)|(.optimisely.co.nz$)|(.optimisely.co.uk$)|(.optimisely.com.br$)|(.optimisely.com.hr$)|(.optimisely.com.mx$)|(.optimisely.cz$)|(.optimisely.de$)|(.optimisely.es$)|(.optimisely.dk$)|(.optimisely.fr$)|(.optimisely.gr$)|(.optimisely.hk$)|(.optimisely.ie$)|(.optimisely.it$)|(.optimisely.jp$)|(.optimisely.lt$)|(.optimisely.lu$)|(.optimisely.lv$)|(.optimisely.nl$)|(.optimisely.mx$)|(.optimisely.pl$)|(.optimisely.pt$)|(.optimisely.ro$)|(.optimisely.ru$)|(.optimisely.se$)|(.optimisely.sg$)|(.optimizely.test$)|(.optimizely.appspot.com$)|(.optimizely-hrd.appspot.com$)|(-dot-optimizely.appspot.com$)|(-dot-optimizely-hrd.appspot.com$)";plan.addChangeHandler=function(changeHandler){plan.changeHandlers.push(changeHandler)};plan.addVariation=function(variationId,source,shouldEvaluate,shouldReplace){shouldEvaluate=(shouldEvaluate===true);shouldReplace=(shouldReplace===true);var added=false;var experimentId=data.getVariationExperimentId(variationId);if(experimentId&&(shouldReplace||!plan.containsExperiment(experimentId))){added=true;if(shouldReplace&&plan.containsExperiment(experimentId)){for(var i=0;i<plan.variations.length;i++){if(plan.variations[i].experimentId===experimentId){plan.variations.splice(i,1)}}}plan.variations.push({experimentId:experimentId,id:variationId,source:source});if(shouldEvaluate){evaluator.enqueue(experimentId)}plan.variationExperimentIds[experimentId]=true;plan.callChangeHandlers();timer.addEvent("Plan","Added experiment "+experimentId+" and variation id "+variationId+" to the plan, source is "+source,true)}return added};plan.buildMultivariateId=function(experimentId,mapping){var variationIds=[];var sectionIds=data.getExperimentSectionIds(experimentId);for(var i=0;i<sectionIds.length;i++){var variationId=mapping[sectionIds[i]];if(variationId===IGNORED_VARIATION_ID){return""}variationIds.push(variationId)}return variationIds.join(VARIATION_ID_DELIMITER)};plan.containsExperiment=function(experimentId){return experimentId in plan.ignoredExperimentIds||experimentId in plan.variationExperimentIds};plan.filterUrlSpecificVariationCode=function(code){var lines=code.split(VARIATION_CODE_DELIMITER);var filteredLines=[];var lineEligibleForInclusion=true;for(var i=0,nLines=lines.length;i<nLines;i++){var line=$.trim(lines[i]);if(line===VARIATION_URL_END){lineEligibleForInclusion=true}else{if(line!==""){var matches=VARIATION_URL_START_RE.exec(line);if(matches&&matches.length===13){var includes=matches[2]?matches[2].split(VARIATION_URL_DELIMITER):[];var excludes=matches[4]?matches[4].split(VARIATION_URL_DELIMITER):[];var match_type=matches[6]?matches[6]:"substring";var include_types=matches[8]?matches[8].split(VARIATION_URL_DELIMITER):[];var exclude_types=matches[10]?matches[10].split(VARIATION_URL_DELIMITER):[];if(includes.length>0){var includeCondition=plan.zipConditions(includes,include_types,match_type);lineEligibleForInclusion=condition.testUrls(includeCondition)}if(lineEligibleForInclusion&&excludes.length>0){var excludeCondition=plan.zipConditions(excludes,exclude_types,match_type);lineEligibleForInclusion=!condition.testUrls(excludeCondition)}}else{if(lineEligibleForInclusion){filteredLines.push(line)}}}}}return filteredLines.join(VARIATION_CODE_DELIMITER)};plan.getProjectClickGoalWithCustomTargetingSteps=function(eventSteps){var goalData=data.getProjectClickGoalsWithCustomTargeting();for(var i=0,nGoals=goalData.length;i<nGoals;i++){var goalStep={eventName:goalData[i]["event_name"],selector:goalData[i]["selector"],type:"event '"+goalData[i]["event_name"]+"' (click goal)",waitUntilSelectorReady:true};if("revenue" in goalData[i]){goalStep.revenue=goalData[i]["revenue"]}eventSteps.push(goalStep)}};plan.getSteps=function(experimentIds){if(experimentIds===undefined){experimentIds=[]}else{if(isNumberLike(experimentIds)){experimentIds=[experimentIds]}}experimentIds=experimentIds;var variationIds=plan.getVariationIds(experimentIds);var eventSteps=[];var forcedSteps=[];var globalSteps=[];var safeSteps=[];plan.getProjectClickGoalWithCustomTargetingSteps(eventSteps);each(experimentIds,function(experimentId){plan.getExperimentSteps(experimentId,eventSteps,globalSteps,forcedSteps,safeSteps)});each(variationIds,function(variationId){plan.getVariationSteps(variationId,forcedSteps,safeSteps)});var steps=[];appendArray(steps,forcedSteps);appendArray(steps,globalSteps);appendArray(steps,safeSteps);appendArray(steps,eventSteps);return steps};plan.getVariationId=function(experimentId){var returnVariationId=null;each(plan.variations,function(variation){if(experimentId==variation.experimentId){returnVariationId=variation.id}});return returnVariationId};plan.getVariationIds=function(experimentIds){var variationIds=[];var shouldAcceptAnyExperiment=!isDefined(experimentIds);experimentIds=experimentIds||[];each(plan.variations,function(variation){if(shouldAcceptAnyExperiment||arrayContains(experimentIds,variation.experimentId)){variationIds.push(variation.id)}});return variationIds};plan.ignoreExperiment=function(experimentId,override){override=(override===true);if(override||!plan.containsExperiment(experimentId)){plan.ignoredExperimentIds[experimentId]=true;plan.callChangeHandlers()}};plan.isExperimentIgnored=function(experimentId){return experimentId in plan.ignoredExperimentIds};plan.removeExperiment=function(experimentId){if(plan.ignoredExperimentIds[experimentId]){delete plan.ignoredExperimentIds[experimentId]}if(plan.variationExperimentIds[experimentId]){delete plan.variationExperimentIds[experimentId]}for(var i=0;i<plan.variations.length;i++){if(plan.variations[i].experimentId===experimentId){plan.variations.splice(i,1)}}plan.callChangeHandlers()};plan.log=function(){if(directive.shouldLog){each(plan.ignoredExperimentIds,function(experimentId){var experimentName=data.getExperimentName(experimentId);timer.addEvent("Plan","Ignore experiment '"+experimentName+"' ("+experimentId+")")});each(plan.variations,function(variation,index){var experimentId=data.getVariationExperimentId(variation.id);var variationName=data.getVariationName(variation.id);timer.addEvent("Plan",data.getExperimentString(experimentId)+' in variation "'+variationName+'" ('+variation.id+")")})}};plan.readCookie=function(){var bucketMap=cookie.get(BUCKET_COOKIE_NAME);if(!bucketMap){return}try{bucketMap=(json.parse(bucketMap))}catch(e){bucketMap={}}var mvtExperiments={};each(bucketMap,function(experimentId,variationId){variationId=String(variationId);var masterExperimentId=data.getVariationExperimentId(variationId);var sectionIds=data.getExperimentSectionIds(masterExperimentId);if(sectionIds.length>1&&variationId.indexOf(VARIATION_ID_DELIMITER)===-1){mvtExperiments[masterExperimentId]=mvtExperiments[masterExperimentId]||{};mvtExperiments[masterExperimentId][experimentId]=variationId}else{if(variationId!==IGNORED_VARIATION_ID){var added=plan.addVariation(variationId,"cookie",false);if(!added){plan.foreignBucketMap[experimentId]=variationId}}else{plan.ignoreExperiment(experimentId)}}});each(mvtExperiments,function(parentExperimentId,mapping){var newId=plan.buildMultivariateId(parentExperimentId,mapping);if(newId.length>0){plan.addVariation(newId,"cookie",false)}else{plan.ignoreExperiment(parentExperimentId)}})};plan.writeCookie=function(){var bucketMap={};each(plan.foreignBucketMap,function(experimentId,variationId){bucketMap[experimentId]=variationId});each(plan.variations,function(variation){var experimentId=data.getVariationExperimentId(variation.id);bucketMap[experimentId]=variation.id});each(plan.ignoredExperimentIds,function(experimentId){bucketMap[experimentId]=IGNORED_VARIATION_ID});cookie.set(BUCKET_COOKIE_NAME,json.stringify(bucketMap),BUCKET_COOKIE_AGE)};plan.callChangeHandlers=function(){each(plan.changeHandlers,function(changeHandler){changeHandler()})};plan.getExperimentSteps=function(experimentId,eventSteps,globalSteps,forcedSteps,safeSteps){var selectors=data.getExperimentEvents(experimentId);each(selectors,function(selector,events){each(events,function(event){eventSteps.push({eventName:event.eventName,experimentIds:event.experimentIds,revenue:event.revenue,selector:selector,type:"event '"+event.eventName+"' (experiment "+experimentId+")",waitUntilSelectorReady:true})})});var css=data.getExperimentCss(experimentId);var code=data.getExperimentCode(experimentId);if(css){globalSteps.push({code:'$("body").append("<style>'+quote(css)+'</style>");',selector:"body",type:"global css (experiment "+experimentId+")",waitUntilSelectorReady:true})}if(code){plan.appendStepsFromCode(code,forcedSteps,safeSteps)}};plan.getVariationSteps=function(variationId,forcedSteps,safeSteps){var code=data.getVariationCode(variationId);code=plan.filterUrlSpecificVariationCode(code);plan.appendStepsFromCode(code,forcedSteps,safeSteps,variationId)};plan.appendStepsFromCode=function(code,forcedSteps,safeSteps,variationId){if(containsString(code,"_optimizely_redirect")){forcedSteps.push({code:code,type:"code forced (redirect)",variationId:variationId})}else{var codeLines=code.split("\n");var isEditorOnly=false;var immediate=false;var immediateCodeLines=[];var jQueryExpression=plan.jQueryExpression;var rearrangeExpression=plan.rearrangeExpression;var nonJQueryCodeLines=[];while(codeLines.length>0){var codeLine=trim(codeLines.shift());var containsInvalidJQuery=nonJQueryCodeLines.length>0;if(codeLine){if(containsRegEx(codeLine,/_optimizely_evaluate\s{0,9}=\s{0,9}force/i)){immediate=true;continue}else{if(containsRegEx(codeLine,/_optimizely_evaluate\s{0,9}=\s{0,9}safe/i)||containsRegEx(codeLine,/_optimizely_evaluate\s{0,9}=\s{0,9}end_force/i)){immediate=false;continue}else{if(containsRegEx(codeLine,/_optimizely_evaluate\s{0,9}=\s{0,9}editor_only/i)){isEditorOnly=true;continue}else{if(containsRegEx(codeLine,/_optimizely_evaluate\s{0,9}=\s{0,9}end_editor_only/i)){isEditorOnly=false;continue}else{if(plan.commentRegex.exec(codeLine)){continue}}}}}if(isEditorOnly){continue}if(immediate){immediateCodeLines.push(codeLine)}else{if(!containsInvalidJQuery){var jQueryMatch=jQueryExpression.exec(codeLine);var selectors=[];if(!jQueryMatch){containsInvalidJQuery=true}else{selectors.push(jQueryMatch[1]);var rearrangeMatch=rearrangeExpression.exec(codeLine);if(rearrangeMatch&&rearrangeMatch.length>4){selectors.push(rearrangeMatch[4])}safeSteps.push({code:codeLine,selector:selectors,type:"safe jquery",waitUntilSelectorReady:true,variationId:variationId})}}if(containsInvalidJQuery){nonJQueryCodeLines.push(codeLine)}}}}if(immediateCodeLines.length>0){forcedSteps.push({code:immediateCodeLines.join("\n"),type:"forced evaluation",variationId:variationId})}if(nonJQueryCodeLines.length>0){safeSteps.push({code:nonJQueryCodeLines.join("\n"),type:"safe non-jquery",waitUntilDocumentReady:true,variationId:variationId})}}};plan.zipConditions=function(urls,matches,defaultMatch){var conditions={values:[]};for(var i=0,nUrls=urls.length;i<nUrls;i++){conditions.values.push({value:urls[i],match:matches[i]||defaultMatch})}return conditions};plan.changeHandlers=[];plan.foreignBucketMap={};plan.ignoredExperimentIds={};plan.rearrangeExpression=/^\$j?\(['"](.+?)['"]\)\.detach\(\)\.(appendTo|insertAfter|insertBefore|prependTo)\(['"](.+?)['"]\);(?:\s|(?:\/\/.*|\/\*(?:[^*]|\*(?!\/))*\*\/))*$/;plan.commentRegex=/^(?:\s|(?:\/\/.*|\/\*(?:[^*]|\*(?!\/))*\*\/))*$/;plan.jQueryExpression=/^\$j?\(['"](.+?)['"]\)\..+;(?:\s|(?:\/\/.*|\/\*(?:[^*]|\*(?!\/))*\*\/))*$/;plan.variationExperimentIds={};plan.variations=[];main=function(){if(!TEST_MODULE){optly.taint.fixJQueryTaintIssues($)}timer.addEvent("Main","Started, revision "+data.getRevision());query.process();cookie.initialize();user.initialize();plan.readCookie();segmenter.initialize();api.initialize();iapi.initialize();main.log();if(directive.scriptToLoad){loadScript(directive.scriptToLoad)}if(directive.isEnabled){distributor.distributeAll();plan.writeCookie();tracker.enableEngagementTracking();if(!directive.shouldSkipPageTracking){if(directive.delayPageviewTracking>0){setTimeout(function(){tracker.addPageviewEvent(document.location.href)},directive.delayPageviewTracking)}else{tracker.addPageviewEvent(document.location.href)}}tracker.sendLogEvents();integrator.makeThirdPartyRequests()}plan.log();if(directive.isEditor){api.finalize()}else{if(directive.isEnabled){evaluator.evaluate();api.finalize();timer.flushLogs();if(!data.isInstallationVerified()){tracker.sendVerificationRequest()}}}preview.initialize();setTimeout(function(){window.optimizelyCode={}},0);setTimeout(function(){try{window.optimizely["iapi"]["geoTimedOut"]=!api.hasLocationDataArrived();window.optimizely["activateGeoDelayedExperiments"]=undefined}catch(error){}},2000);timer.addEvent("Main","End of main")};main.log=function(){timer.addEvent("Info","Is enabled: "+directive.isEnabled);timer.addEvent("Info","Script to load: "+(directive.scriptToLoad||"none"));timer.addEvent("Info","Browser type: "+user.getBrowserId());timer.addEvent("Info","Browser version: "+user.getBrowserVersion());var mobileBrowserType=user.getMobileId();if(mobileBrowserType!=="unknown"){timer.addEvent("Info","Mobile browser type: "+mobileBrowserType)}timer.addEvent("Info","New vs returning: "+user.getNewVsReturning());timer.addEvent("Info","Source type: "+user.getSourceType());timer.addEvent("Info","User ID: "+user.getId())};main();optly.Cleanse.finish()};optimizelyCode({public_suffixes:{"apple.com":["apple.com",".apple.com","store.apple.com"],"(apple.com":["(apple.com"]},log_host:"log.optimizely.com",goal_expressions:{"715790689":["^smallbento\\_clicks$"],"721900742":["^banner\\-click$"],"708710945":["^smallbento\\-link$"],"718030795":["^ribbon\\_clicks$"],"749003052":["^businessclicks$"],"703207792":["^educationclicks$"],"341615730":["^engagement$"],"719385909":["^refurbclicks$"],"740081783":["^banner\\-link\\_clicks$"],"746437369":["^communityclicks$"],"702255930":["^nowtrendingclicks$"],"776980255":["^(https?://)?(www\\.)?store\\.apple\\.com\\/us\\/cart/?(\\?.*)?(#.*)?$"]},api_host:"api.optimizely.com",variations:{"715790688":{code:'$(".ns-buttons > div:eq(1)").replaceWith("<div class=\\"bento ns-buttons\\">\\n\\t<div class=\\"row\\">\\n\\t\\t<style>\\n\\t\\t\\t.bento .tiles .cyber-xl-2013 { width:630px; }\\n\\t\\t</style>\\n\\t\\t<div class=\\"tiles extra-large\\">\\n\\t\\t\\t<div id=\\"coherent_id_16\\" class=\\"store-app-xl-201312 banner clearfix superlink\\">\\n\\t\\t\\t\\t<img class=\\"hero\\" alt=\\"\\" src=\\"http://store.storeimages.cdn-apple.com/3878/as-images.apple.com/is/image/AppleInc/store-app-hero-xl-2013?wid=182&hei=182&fmt=png-alpha&qlt=100\\" width=\\"91\\">\\n\\t\\t\\t\\t\\t<div class=\\"info\\">\\n\\t\\t\\t\\t\\t\\t<h2>\\n\\t\\t\\t\\t\\t\\t\\t<img class=\\"title\\" alt=\\"\\" src=\\"http://store.storeimages.cdn-apple.com/3878/as-images.apple.com/is/image/AppleInc/store-app-title-xl-2013?wid=888&hei=72&fmt=png-alpha&qlt=100\\" width=\\"444\\">\\n\\t\\t\\t\\t\\t\\t\\t\\t<span class=\\"a11y\\">\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tThe Apple Store app for iPad.\\n\\t\\t\\t\\t\\t\\t\\t\\t</span>\\n\\t\\t\\t\\t\\t\\t</h2>\\n\\t\\t\\t\\t\\t\\t\\t<p class=\\"tagline\\">\\n\\t\\t\\t\\t\\t\\t\\t\\tA whole new way to shop.\\n\\t\\t\\t\\t\\t\\t\\t</p>\\n\\t\\t\\t\\t\\t\\t\\t\\t<a id=\\"coherent_id_17\\" class=\\"more superlink\\" href=\\"https://itunes.apple.com/us/app/apple-store-for-ipad/id732164065?mt=8&amp;at=10l7hL&amp;ct=AOS-US-AppPromoHPBanner-iPadMobileSafariOnly\\">\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tDownload now\\n\\t\\t\\t\\t\\t\\t\\t\\t</a>\\n\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t</div>\\n\\t\\t</div>\\n\\t</div>\\n</div>\\n\\n\\n<div class=\\"bento\\">\\n\\t<div class=\\"row\\">\\n\\t\\t\\n\\t\\n\\t\\t<div class=\\"tiles medium\\">\\n<div class=\\"bags-m-201306 superlink\\">\\n\\t<div class=\\"info\\">\\n\\t\\t<h2><a onclick=\\"s_objectID=\'32b77140fb88158301180dca37873c7e\';\\" href=\\"/us/mac/mac-accessories/notebook-cases#!&amp;f=exclusive&amp;fh=36c2%2B3b25\\" class=\\"superlink\\" data-evar1=\\"AOS: home | main-2 | Astro Link | 0 | AOS: home/shop_mac/mac_accessories/notebook_cases\\" data-evar30=\\"home/main-2\\">\\n\\t\\t\\t<img class=\\"ir\\" src=\\"http://store.storeimages.cdn-apple.com/3877/as-images.apple.com/is/image/AppleInc/bags-title-m-201306?wid=275&amp;hei=46&amp;fmt=png-alpha&amp;qlt=95&amp;.v=1371602356754\\" alt=\\"\\" data-scale-params-2=\\"wid=550&amp;hei=92&amp;fmt=png-alpha&amp;qlt=95&amp;.v=1371602356754\\" height=\\"46\\" width=\\"275\\">\\n\\t\\t\\t<span class=\\"a11y\\">Exclusive designer bags.</span>\\n\\t\\t</a></h2>\\n\\t\\t<p class=\\"tagline\\">Fit your fashion - and your Mac.</p>\\n\\t</div>\\n\\t<img class=\\"hero ir\\" src=\\"http://store.storeimages.cdn-apple.com/3877/as-images.apple.com/is/image/AppleInc/bags-hero-m-201306?wid=290&amp;hei=258&amp;fmt=png-alpha&amp;qlt=95&amp;.v=1393488723638\\" alt=\\"\\" data-scale-params-2=\\"wid=580&amp;hei=516&amp;fmt=png-alpha&amp;qlt=95&amp;.v=1393488723638\\" height=\\"258\\" width=\\"290\\">\\n</div>\\n</div>\\n\\t\\n\\t\\n\\t\\n\\n\\t\\t\\n\\t\\n\\t\\t<div class=\\"tiles large\\">\\n\\t<div class=\\"macbook-pro-retina-l-201310 clearfix superlink\\">\\n\\t\\t<img class=\\"hero ir\\" src=\\"http://store.storeimages.cdn-apple.com/3877/as-images.apple.com/is/image/AppleInc/macbook-pro-retina-hero-l-201310?wid=588&amp;hei=189&amp;fmt=jpeg&amp;qlt=95&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,0.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=1387428500959\\" alt=\\"\\" data-scale-params-2=\\"wid=1176&amp;hei=378&amp;fmt=jpeg&amp;qlt=95&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,0.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=1387428500959\\" height=\\"189\\" width=\\"588\\">\\n\\t\\t<div class=\\"info\\">\\n\\t\\t\\t<h2>\\n\\t\\t\\t\\t<img class=\\"title ir\\" src=\\"http://store.storeimages.cdn-apple.com/3877/as-images.apple.com/is/image/AppleInc/macbook-pro-retina-title-l-201310?wid=228&amp;hei=61&amp;fmt=jpeg&amp;qlt=95&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,0.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=1381433522191\\" alt=\\"\\" data-scale-params-2=\\"wid=456&amp;hei=122&amp;fmt=jpeg&amp;qlt=95&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,0.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=1381433522191\\" height=\\"61\\" width=\\"228\\">\\n\\t\\t\\t\\t<span class=\\"a11y\\">MacBook Pro with Retina display</span>\\n\\t\\t\\t</h2>\\n\\t\\t\\t<p class=\\"tagline\\">\\n\\t\\t\\t\\tNow with more power behind every pixel.\\n\\t\\t\\t</p>\\n\\t\\t\\t<a href=\\"/us/buy-mac/macbook-pro\\" class=\\"button merchandising small superlink\\" onclick=\\"s_objectID=\'9da3454afc1750b7d7facfd9e7f7070a\';\\" data-evar1=\\"AOS: home | main-2 | Astro Link | 0 | AOS: home/shop_mac/family/macbook_pro\\" data-evar30=\\"home/main-2\\">From \\n\\t\\n\\t\\n\\t\\n\\t\\n\\t\\n\\t\\t\\n\\t\\t\\t\\n\\t\\t\\t\\t\\n\\t\\t\\t\\t$1299\\n\\t\\t\\t\\t\\n\\t\\t\\t\\t\\n\\t\\t\\t\\t\\n\\t\\t\\t\\t\\n\\t\\t\\t\\n\\t\\t\\t\\n\\t\\t\\t\\n\\t\\t\\n\\t\\t\\n\\t\\t\\n\\t\\t\\n\\t\\t\\n\\t\\t\\n\\t\\t\\n\\t\\t\\n\\t\\t\\n\\t\\t\\n\\t\\t\\n\\t\\t\\t\\n\\t\\t\\t\\n\\t\\t\\n\\t\\t\\n\\t\\t\\n\\t\\t\\n\\t\\t\\n\\t\\t\\n\\t\\t\\n    \\n\\t\\n\\t\\n</a>\\n\\t\\t</div>\\n\\t</div>\\n</div>\\n\\t\\n\\t\\n\\t\\n\\n\\t</div>\\n</div>");',name:"Variation 1 - Banner"},"831760142":{code:'/* _optimizely_variation_url include="apple.com/(us$)|(us\\?revision=.*)" exclude="" include_match_types="regex" exclude_match_types="" id="1392854946629" */\n$("body").prepend("<img src=/us/beacon/vo.png?votkn=221c6536896857894784611708962dd91c0777ad672ea45409de600f416c1540cba7e384e73f8d65e2615338da7ecb690b5b823f3b4ae314738f17db0b3aa82d5d0c66cbe099e84e6ef416699a77fc17e58a6f378f539248bc3074fa3c4105ea-4ad3cdec115de4d5-ea6243ea7fe2486fd6b40d56750930c90c35e91b width=\\"0\\" height=\\"0\\" style=\\"display:none;\\" alt=\\"\\" />");\n$(".compactx1").replaceWith("<p class=\\"compactx1\\"> Get free next day shipping direct to your door on all orders over $25. </p>");\n\nvar priceThreshold = 2500; // PRICE THRESHOLD IN CENTS\nvar promoText = "Free Next Day Shipping";  // NEW TEXT TO APPEND TO SHIPPING DETAILS\nvar currency = "$";\nvar currencyDivider = ",";\n\n// *** DO NOT MODIFY BELOW THIS LINE ***\n\n// UPDATE SLIDER\n$(".slides .info").each(function() {\n  var number = parseFloat($(this).find(".price-current").text().trim().replace(currency,"").replace(currencyDivider,"")) * 100;\n  if (number >= priceThreshold && $(this).find(".ship-promo").length == 1 && $(this).find(".ship-promo.border-right").length == 0 && $(this).find(".ship-promo-opt").length == 0) {\n    $(this).find(".ship-promo").before("<li class=\\"ship-promo border-right\\"><span>" + promoText +"</span></li>");\n  }\n  if (number >= priceThreshold && $(this).find(".ship-promo.border-right").length == 1) {\n    $(this).find(".ship-promo.border-right").replaceWith("<li class=\\"ship-promo border-right\\"><span>" + promoText +"</span></li>");\n  }\n  if (number >= priceThreshold && $(this).find(".ship-promo-opt").length == 1) {\n    $(this).find(".ship-promo-opt").replaceWith("<li class=\\"ship-promo-opt\\"><span>" + promoText +" | </span></li>");\n  }\n});\n\n// UPDATE PINWHEEL\n$(".pinwheel .info").each(function() {\n  var number = parseFloat($(this).find(".price-current").text().trim().replace(currency,"").replace(currencyDivider,"")) * 100;\n  if (number >= priceThreshold && $(this).find(".ship-promo").length == 0) {\n    $(this).find(".ship-time").before("<li class=\\"ship-promo\\">" + promoText + " </li>");\n  }\n  if (number >= priceThreshold && $(this).find(".ship-promo").length == 1) {\n    $(this).find(".ship-promo").replaceWith("<li class=\\"ship-promo\\">" + promoText + " </li>");\n  }\n});\n/* _optimizely_variation_url_end */\n\n/* _optimizely_variation_url include="apple.com/us/(mac)|(ipad)|(iphone)|(ipod)|(appletv)" exclude="" include_match_types="regex" exclude_match_types="" id="1392856196495" */\n$("body").prepend("<img src=/us/beacon/vo.png?votkn=221c6536896857894784611708962dd91c0777ad672ea45409de600f416c1540cba7e384e73f8d65e2615338da7ecb690b5b823f3b4ae314738f17db0b3aa82d5d0c66cbe099e84e6ef416699a77fc17e58a6f378f539248bc3074fa3c4105ea-4ad3cdec115de4d5-ea6243ea7fe2486fd6b40d56750930c90c35e91b width=\\"0\\" height=\\"0\\" style=\\"display:none;\\" alt=\\"\\" />");\n$(".compactx1").replaceWith("<p class=\\"compactx1\\"> Get free next day shipping direct to your door on all orders over $25. </p>");\n\nvar priceThreshold = 2500; // PRICE THRESHOLD IN CENTS\nvar promoText = "Free Next Day Shipping";  // NEW TEXT TO APPEND TO SHIPPING DETAILS\nvar currency = "$";\nvar currencyDivider = ",";\n\n// *** DO NOT MODIFY BELOW THIS LINE ***\n\n// UPDATE SLIDER\n$(".slides .info").each(function() {\n  var number = parseFloat($(this).find(".price-current").text().trim().replace(currency,"").replace(currencyDivider,"")) * 100;\n  if (number >= priceThreshold && $(this).find(".ship-promo").length == 1 && $(this).find(".ship-promo.border-right").length == 0 && $(this).find(".ship-promo-opt").length == 0) {\n    $(this).find(".ship-promo").before("<li class=\\"ship-promo border-right\\"><span>" + promoText +"</span></li>");\n  }\n  if (number >= priceThreshold && $(this).find(".ship-promo.border-right").length == 1) {\n    $(this).find(".ship-promo.border-right").replaceWith("<li class=\\"ship-promo border-right\\"><span>" + promoText +"</span></li>");\n  }\n  if (number >= priceThreshold && $(this).find(".ship-promo-opt").length == 1) {\n    $(this).find(".ship-promo-opt").replaceWith("<li class=\\"ship-promo-opt\\"><span>" + promoText +" | </span></li>");\n  }\n});\n\n// UPDATE PINWHEEL\n$(".pinwheel .info").each(function() {\n  var number = parseFloat($(this).find(".price-current").text().trim().replace(currency,"").replace(currencyDivider,"")) * 100;\n  if (number >= priceThreshold && $(this).find(".ship-promo").length == 0) {\n    $(this).find(".ship-time").before("<li class=\\"ship-promo\\">" + promoText + " </li>");\n  }\n  if (number >= priceThreshold && $(this).find(".ship-promo").length == 1) {\n    $(this).find(".ship-promo").replaceWith("<li class=\\"ship-promo\\">" + promoText + " </li>");\n  }\n});\n/* _optimizely_variation_url_end */\n\n/* _optimizely_variation_url include="apple.com/us/search/.*" exclude="" include_match_types="regex" exclude_match_types="" id="1392860007504" */\n$("body").prepend("<img src=/us/beacon/vo.png?votkn=221c6536896857894784611708962dd91c0777ad672ea45409de600f416c1540cba7e384e73f8d65e2615338da7ecb690b5b823f3b4ae314738f17db0b3aa82d5d0c66cbe099e84e6ef416699a77fc17e58a6f378f539248bc3074fa3c4105ea-4ad3cdec115de4d5-ea6243ea7fe2486fd6b40d56750930c90c35e91b width=\\"0\\" height=\\"0\\" style=\\"display:none;\\" alt=\\"\\" />");\n\nvar priceThreshold = 2500; // PRICE THRESHOLD IN CENTS\nvar promoText = "Free Next Day Shipping";  // NEW TEXT TO APPEND TO SHIPPING DETAILS\nvar currency = "$";\nvar currencyDivider = ",";\n\n// *** DO NOT MODIFY BELOW THIS LINE ***\n\n// UPDATE TILE\n$(".item-offer").each(function() {\n  var number = parseFloat($(this).find(".item-price").text().trim().replace(currency,"").replace(currencyDivider,"")) * 100;\n  if (number >= priceThreshold && $(this).find(".ship-promo").length == 0) {\n    $(this).find(".ship-time").before("<li class=\\"ship-promo\\">" + promoText +"</li>");\n  }\n  if (number >= priceThreshold && $(this).find(".ship-promo").length == 1) {\n    $(this).find(".ship-promo").replaceWith("<li class=\\"ship-promo\\">" + promoText +"</li>");\n  }\n});\n/* _optimizely_variation_url_end */\n\n/* _optimizely_variation_url include="apple.com/us/product/.*" exclude="" include_match_types="regex" exclude_match_types="" id="1392862507129" */\n$("body").prepend("<img src=/us/beacon/vo.png?votkn=221c6536896857894784611708962dd91c0777ad672ea45409de600f416c1540cba7e384e73f8d65e2615338da7ecb690b5b823f3b4ae314738f17db0b3aa82d5d0c66cbe099e84e6ef416699a77fc17e58a6f378f539248bc3074fa3c4105ea-4ad3cdec115de4d5-ea6243ea7fe2486fd6b40d56750930c90c35e91b width=\\"0\\" height=\\"0\\" style=\\"display:none;\\" alt=\\"\\" />");\n\nvar priceThreshold = 2500; // PRICE THRESHOLD IN CENTS\nvar promoText = "Free Next Day Shipping";  // NEW TEXT TO APPEND TO SHIPPING DETAILS\nvar currency = "$";\nvar currencyDivider = ",";\n\n// *** DO NOT MODIFY BELOW THIS LINE ***\n\n// UPDATE PDP\nvar number = parseFloat($(".purchase-info").find($(".current_price > span > span")).text().trim().replace(currency,"").replace(currencyDivider,"")) * 100;\nif (number >= priceThreshold) {\n  $("#free-shipping").replaceWith("<span id=\\"free-shipping\\" class=\\"materializer\\"><span class=\\"freeshipping promo-text\\">" + promoText +"</span></span>");\n}\n/* _optimizely_variation_url_end */\n\n/* _optimizely_variation_url include="(apple.com/us/.*/.*-accessories/.*)|(apple.com/us/browse/home/collections/)|(apple.com/us/accessories/exclusives)" exclude="" include_match_types="regex" exclude_match_types="" id="1392868893445" */\n$("body").prepend("<img src=/us/beacon/vo.png?votkn=221c6536896857894784611708962dd91c0777ad672ea45409de600f416c1540cba7e384e73f8d65e2615338da7ecb690b5b823f3b4ae314738f17db0b3aa82d5d0c66cbe099e84e6ef416699a77fc17e58a6f378f539248bc3074fa3c4105ea-4ad3cdec115de4d5-ea6243ea7fe2486fd6b40d56750930c90c35e91b width=\\"0\\" height=\\"0\\" style=\\"display:none;\\" alt=\\"\\" />");\n\nvar priceThreshold = 2500; // PRICE THRESHOLD IN CENTS\nvar promoText = "Free Next Day Shipping";  // NEW TEXT TO APPEND TO SHIPPING DETAILS\nvar currency = "$";\nvar currencyDivider = ",";\n\n// *** DO NOT MODIFY BELOW THIS LINE ***\n\n// UPDATE TILE\n$(".item-offer").each(function() {\n  var number = parseFloat($(this).find(".item-price").text().trim().replace(currency,"").replace(currencyDivider,"")) * 100;\n  if (number >= priceThreshold && $(this).find(".ship-promo").length == 0) {\n    $(this).find(".ship-time").before("<li class=\\"ship-promo\\">" + promoText +"</li>");\n  }\n  if (number >= priceThreshold && $(this).find(".ship-promo").length == 1) {\n    $(this).find(".ship-promo").replaceWith("<li class=\\"ship-promo\\">" + promoText +"</li>");\n  }\n});\n/* _optimizely_variation_url_end */\n\n/* _optimizely_variation_url include="apple.com/us/.*/.*-accessories" exclude="" include_match_types="regex" exclude_match_types="" id="1392870843280" */\n$("body").prepend("<img src=/us/beacon/vo.png?votkn=221c6536896857894784611708962dd91c0777ad672ea45409de600f416c1540cba7e384e73f8d65e2615338da7ecb690b5b823f3b4ae314738f17db0b3aa82d5d0c66cbe099e84e6ef416699a77fc17e58a6f378f539248bc3074fa3c4105ea-4ad3cdec115de4d5-ea6243ea7fe2486fd6b40d56750930c90c35e91b width=\\"0\\" height=\\"0\\" style=\\"display:none;\\" alt=\\"\\" />");\n\nvar priceThreshold = 2500; // PRICE THRESHOLD IN CENTS\nvar promoText = "Free Next Day Shipping";  // NEW TEXT TO APPEND TO SHIPPING DETAILS\nvar currency = "$";\nvar currencyDivider = ",";\n\n// *** DO NOT MODIFY BELOW THIS LINE ***\n\n// UPDATE TILE\n$(".info").each(function() {\n  var number = parseFloat($(this).find(".price-current").text().trim().replace(currency,"").replace(currencyDivider,"")) * 100;\n  if (number >= priceThreshold && $(this).find(".ship-promo").length == 0) {\n    $(this).find(".ship-time").before("<li class=\\"ship-promo\\">" + promoText +"</li>");\n  }\n  if (number >= priceThreshold && $(this).find(".ship-promo").length == 1) {\n    $(this).find(".ship-promo").replaceWith("<li class=\\"ship-promo\\">" + promoText +"</li>");\n  }\n});\n\n// UPDATE TILE FOR APPLE TV SUB LOB\n$(".item-content").each(function() {\n  var number = parseFloat($(this).find(".item-price").text().trim().replace(currency,"").replace(currencyDivider,"")) * 100;\n  if (number >= priceThreshold && $(this).find(".ship-promo").length == 0) {\n    $(this).find(".ship-time").before("<li class=\\"ship-promo\\">" + promoText +"</li>");\n  }\n  if (number >= priceThreshold && $(this).find(".ship-promo").length == 1) {\n    $(this).find(".ship-promo").replaceWith("<li class=\\"ship-promo\\">" + promoText +"</li>");\n  }\n});\n/* _optimizely_variation_url_end */\n\n/* _optimizely_variation_url include="apple.com/us/trending" exclude="" include_match_types="regex" exclude_match_types="" id="1393298481313" */\n$("body").prepend("<img src=/us/beacon/vo.png?votkn=221c6536896857894784611708962dd91c0777ad672ea45409de600f416c1540cba7e384e73f8d65e2615338da7ecb690b5b823f3b4ae314738f17db0b3aa82d5d0c66cbe099e84e6ef416699a77fc17e58a6f378f539248bc3074fa3c4105ea-4ad3cdec115de4d5-ea6243ea7fe2486fd6b40d56750930c90c35e91b width=\\"0\\" height=\\"0\\" style=\\"display:none;\\" alt=\\"\\" />");\n\nvar priceThreshold = 2500; // PRICE THRESHOLD IN CENTS\nvar promoText = "Free Next Day Shipping";  // NEW TEXT TO APPEND TO SHIPPING DETAILS\nvar currency = "$";\nvar currencyDivider = ",";\nvar matchString = "Available to ship"\n\n// *** DO NOT MODIFY BELOW THIS LINE ***\n\n// UPDATE TILE\n$(".info").each(function() {\n  var number = parseFloat($(this).find(".price-current").text().trim().replace(currency,"").replace(currencyDivider,"")) * 100;\n  var itemName = $(this).find(\'.item-availability > li:eq(0)\').text().trim();\n  if (number >= priceThreshold && itemName.match(matchString)!=null) {\n    $(this).find(".item-availability > li:eq(0)").replaceWith("<li class=\\"ship-promo\\"><span>" + promoText +" | </span></li><li class=\\"ship-promo\\"><span>" + itemName +"</span></li>");\n  }\n  if (number >= priceThreshold && itemName.match(matchString)==null) {\n    $(this).find(".item-availability > li:eq(0)").replaceWith("<li class=\\"ship-promo\\"><span>" + promoText +" | </span></li>");\n  }\n});\n/* _optimizely_variation_url_end */\n\n/* _optimizely_variation_url include="apple.com/us/buy-ip.d/ip.d.*(\\?|\\&)product=.*\\&step=engrave" exclude="" include_match_types="regex" exclude_match_types="" id="1393301783426" */\n$("body").prepend("<img src=/us/beacon/vo.png?votkn=221c6536896857894784611708962dd91c0777ad672ea45409de600f416c1540cba7e384e73f8d65e2615338da7ecb690b5b823f3b4ae314738f17db0b3aa82d5d0c66cbe099e84e6ef416699a77fc17e58a6f378f539248bc3074fa3c4105ea-4ad3cdec115de4d5-ea6243ea7fe2486fd6b40d56750930c90c35e91b width=\\"0\\" height=\\"0\\" style=\\"display:none;\\" alt=\\"\\" />");\n$(".add-engraving > .free-shipping").replaceWith("<p class=\\"free-shipping\\">Free Next Day Shipping</p>");\n$(".skip-engraving > .free-shipping").replaceWith("<p class=\\"free-shipping\\">Free Next Day Shipping</p>");\n/* _optimizely_variation_url_end */',name:"Variation #3"},"842170010":{code:'/* _optimizely_variation_url include="apple.com/(us$)|(us\\?revision=.*)" exclude="" include_match_types="regex" exclude_match_types="" id="1392854946629" */\n\n/* _optimizely_variation_url_end */\n\n/* _optimizely_variation_url include="apple.com/us/(mac)|(ipad)|(iphone)|(ipod)|(appletv)" exclude="" include_match_types="regex" exclude_match_types="" id="1392856196495" */\n\n/* _optimizely_variation_url_end */\n\n/* _optimizely_variation_url include="apple.com/us/search/.*" exclude="" include_match_types="regex" exclude_match_types="" id="1392860007504" */\n\n/* _optimizely_variation_url_end */',name:"Original"},"584470190":{code:'$(".item-offer").each(function() {\n  var number = parseFloat($(this).find(".item-price").text().trim().replace("$","")) * 100;\n  if (number < 5000 && number > 3500 && $(this).find(".ship-promo").length == 0) {\n  \t$(this).find(".ship-time").before("<li class=\\"ship-promo\\">Free Shipping</li>");\n  }\n});',name:"Variation #1"},"829430799":{code:'/* _optimizely_variation_url include="apple.com/(us$)|(us\\?revision=.*)" exclude="" include_match_types="regex" exclude_match_types="" id="1392854946629" */\n$("body").prepend("<img src=/us/beacon/vo.png?votkn=10e168249666bff0473873b366eef97fcc3362277af03759511a6e71c3a215b6347c1892c4e76087b87b312add8e3bbea9f749e36e7588d4e50b6104b6ce32876feee6c6b7ba8844798a49afd95e6bf5040acb034bcde06f21fd88903f4f3faa8d785f15db29b765-abe65359a548ed7e-597d0c02651f0120cfe3fc0655c6426a0a46d68f width=\\"0\\" height=\\"0\\" style=\\"display:none;\\" alt=\\"\\" />");\n$(".compactx1").replaceWith("<p class=\\"compactx1\\"> Get free shipping direct to your door on everything. </p>");\n\nvar priceThreshold = 0; // PRICE THRESHOLD IN CENTS\nvar promoText = "Free Shipping";  // NEW TEXT TO APPEND TO SHIPPING DETAILS\nvar currency = "$";\nvar currencyDivider = ",";\n\n// *** DO NOT MODIFY BELOW THIS LINE ***\n\n// UPDATE SLIDER\n$(".slides .info").each(function() {\n  var number = parseFloat($(this).find(".price-current").text().trim().replace(currency,"").replace(currencyDivider,"")) * 100;\n  if (number >= priceThreshold && $(this).find(".ship-promo").length == 1 && $(this).find(".ship-promo.border-right").length == 0 && $(this).find(".ship-promo-opt").length == 0) {\n    $(this).find(".ship-promo").before("<li class=\\"ship-promo border-right\\"><span>" + promoText +"</span></li>");\n  }\n  if (number >= priceThreshold && $(this).find(".ship-promo.border-right").length == 1) {\n    $(this).find(".ship-promo.border-right").replaceWith("<li class=\\"ship-promo border-right\\"><span>" + promoText +"</span></li>");\n  }\n  if (number >= priceThreshold && $(this).find(".ship-promo-opt").length == 1) {\n    $(this).find(".ship-promo-opt").replaceWith("<li class=\\"ship-promo-opt\\"><span>" + promoText +" | </span></li>");\n  }\n});\n\n// UPDATE PINWHEEL\n$(".pinwheel .info").each(function() {\n  var number = parseFloat($(this).find(".price-current").text().trim().replace(currency,"").replace(currencyDivider,"")) * 100;\n  if (number >= priceThreshold && $(this).find(".ship-promo").length == 0) {\n    $(this).find(".ship-time").before("<li class=\\"ship-promo\\">" + promoText + " </li>");\n  }\n  if (number >= priceThreshold && $(this).find(".ship-promo").length == 1) {\n    $(this).find(".ship-promo").replaceWith("<li class=\\"ship-promo\\">" + promoText + " </li>");\n  }\n});\n\n// UPDATE SLIDER AND PINWHEEL AGAIN WHEN PAGE LOAD IS COMPLETE\n$(document).ready(function() {\n\n// UPDATE SLIDER\n$(".slides .info").each(function() {\n  var number = parseFloat($(this).find(".price-current").text().trim().replace(currency,"").replace(currencyDivider,"")) * 100;\n  if (number >= priceThreshold && $(this).find(".ship-promo").length == 1 && $(this).find(".ship-promo.border-right").length == 0 && $(this).find(".ship-promo-opt").length == 0) {\n    $(this).find(".ship-promo").before("<li class=\\"ship-promo border-right\\"><span>" + promoText +"</span></li>");\n  }\n  if (number >= priceThreshold && $(this).find(".ship-promo.border-right").length == 1) {\n    $(this).find(".ship-promo.border-right").replaceWith("<li class=\\"ship-promo border-right\\"><span>" + promoText +"</span></li>");\n  }\n  if (number >= priceThreshold && $(this).find(".ship-promo-opt").length == 1) {\n    $(this).find(".ship-promo-opt").replaceWith("<li class=\\"ship-promo-opt\\"><span>" + promoText +" | </span></li>");\n  }\n});\n\n// UPDATE PINWHEEL\n$(".pinwheel .info").each(function() {\n  var number = parseFloat($(this).find(".price-current").text().trim().replace(currency,"").replace(currencyDivider,"")) * 100;\n  if (number >= priceThreshold && $(this).find(".ship-promo").length == 0) {\n    $(this).find(".ship-time").before("<li class=\\"ship-promo\\">" + promoText + " </li>");\n  }\n  if (number >= priceThreshold && $(this).find(".ship-promo").length == 1) {\n    $(this).find(".ship-promo").replaceWith("<li class=\\"ship-promo\\">" + promoText + " </li>");\n  }\n});\n  \n});\n/* _optimizely_variation_url_end */\n\n/* _optimizely_variation_url include="apple.com/us/(mac)|(ipad)|(iphone)|(ipod)|(appletv)" exclude="" include_match_types="regex" exclude_match_types="" id="1392856196495" */\n$("body").prepend("<img src=/us/beacon/vo.png?votkn=10e168249666bff0473873b366eef97fcc3362277af03759511a6e71c3a215b6347c1892c4e76087b87b312add8e3bbea9f749e36e7588d4e50b6104b6ce32876feee6c6b7ba8844798a49afd95e6bf5040acb034bcde06f21fd88903f4f3faa8d785f15db29b765-abe65359a548ed7e-597d0c02651f0120cfe3fc0655c6426a0a46d68f width=\\"0\\" height=\\"0\\" style=\\"display:none;\\" alt=\\"\\" />");\n$(".compactx1").replaceWith("<p class=\\"compactx1\\"> Get free shipping direct to your door on everything. </p>");\n\nvar priceThreshold = 0; // PRICE THRESHOLD IN CENTS\nvar promoText = "Free Shipping";  // NEW TEXT TO APPEND TO SHIPPING DETAILS\nvar currency = "$";\nvar currencyDivider = ",";\n\n// *** DO NOT MODIFY BELOW THIS LINE ***\n\n// UPDATE SLIDER\n$(".slides .info").each(function() {\n  var number = parseFloat($(this).find(".price-current").text().trim().replace(currency,"").replace(currencyDivider,"")) * 100;\n  if (number >= priceThreshold && $(this).find(".ship-promo").length == 1 && $(this).find(".ship-promo.border-right").length == 0 && $(this).find(".ship-promo-opt").length == 0) {\n    $(this).find(".ship-promo").before("<li class=\\"ship-promo border-right\\"><span>" + promoText +"</span></li>");\n  }\n  if (number >= priceThreshold && $(this).find(".ship-promo.border-right").length == 1) {\n    $(this).find(".ship-promo.border-right").replaceWith("<li class=\\"ship-promo border-right\\"><span>" + promoText +"</span></li>");\n  }\n  if (number >= priceThreshold && $(this).find(".ship-promo-opt").length == 1) {\n    $(this).find(".ship-promo-opt").replaceWith("<li class=\\"ship-promo-opt\\"><span>" + promoText +" | </span></li>");\n  }\n});\n\n// UPDATE PINWHEEL\n$(".pinwheel .info").each(function() {\n  var number = parseFloat($(this).find(".price-current").text().trim().replace(currency,"").replace(currencyDivider,"")) * 100;\n  if (number >= priceThreshold && $(this).find(".ship-promo").length == 0) {\n    $(this).find(".ship-time").before("<li class=\\"ship-promo\\">" + promoText + " </li>");\n  }\n  if (number >= priceThreshold && $(this).find(".ship-promo").length == 1) {\n    $(this).find(".ship-promo").replaceWith("<li class=\\"ship-promo\\">" + promoText + " </li>");\n  }\n});\n\n// UPDATE SLIDER AND PINWHEEL AGAIN WHEN PAGE LOAD IS COMPLETE\n$(document).ready(function() {\n\n// UPDATE SLIDER\n$(".slides .info").each(function() {\n  var number = parseFloat($(this).find(".price-current").text().trim().replace(currency,"").replace(currencyDivider,"")) * 100;\n  if (number >= priceThreshold && $(this).find(".ship-promo").length == 1 && $(this).find(".ship-promo.border-right").length == 0 && $(this).find(".ship-promo-opt").length == 0) {\n    $(this).find(".ship-promo").before("<li class=\\"ship-promo border-right\\"><span>" + promoText +"</span></li>");\n  }\n  if (number >= priceThreshold && $(this).find(".ship-promo.border-right").length == 1) {\n    $(this).find(".ship-promo.border-right").replaceWith("<li class=\\"ship-promo border-right\\"><span>" + promoText +"</span></li>");\n  }\n  if (number >= priceThreshold && $(this).find(".ship-promo-opt").length == 1) {\n    $(this).find(".ship-promo-opt").replaceWith("<li class=\\"ship-promo-opt\\"><span>" + promoText +" | </span></li>");\n  }\n});\n\n// UPDATE PINWHEEL\n$(".pinwheel .info").each(function() {\n  var number = parseFloat($(this).find(".price-current").text().trim().replace(currency,"").replace(currencyDivider,"")) * 100;\n  if (number >= priceThreshold && $(this).find(".ship-promo").length == 0) {\n    $(this).find(".ship-time").before("<li class=\\"ship-promo\\">" + promoText + " </li>");\n  }\n  if (number >= priceThreshold && $(this).find(".ship-promo").length == 1) {\n    $(this).find(".ship-promo").replaceWith("<li class=\\"ship-promo\\">" + promoText + " </li>");\n  }\n});\n  \n});\n/* _optimizely_variation_url_end */\n\n/* _optimizely_variation_url include="apple.com/us/search/.*" exclude="" include_match_types="regex" exclude_match_types="" id="1392860007504" */\n$("body").prepend("<img src=/us/beacon/vo.png?votkn=10e168249666bff0473873b366eef97fcc3362277af03759511a6e71c3a215b6347c1892c4e76087b87b312add8e3bbea9f749e36e7588d4e50b6104b6ce32876feee6c6b7ba8844798a49afd95e6bf5040acb034bcde06f21fd88903f4f3faa8d785f15db29b765-abe65359a548ed7e-597d0c02651f0120cfe3fc0655c6426a0a46d68f width=\\"0\\" height=\\"0\\" style=\\"display:none;\\" alt=\\"\\" />");\n\nvar priceThreshold = 0; // PRICE THRESHOLD IN CENTS\nvar promoText = "Free Shipping";  // NEW TEXT TO APPEND TO SHIPPING DETAILS\nvar currency = "$";\nvar currencyDivider = ",";\n\n// *** DO NOT MODIFY BELOW THIS LINE ***\n\n// UPDATE TILE\n$(".item-offer").each(function() {\n  var number = parseFloat($(this).find(".item-price").text().trim().replace(currency,"").replace(currencyDivider,"")) * 100;\n  if (number >= priceThreshold && $(this).find(".ship-promo").length == 0) {\n    $(this).find(".ship-time").before("<li class=\\"ship-promo\\">" + promoText +"</li>");\n  }\n  if (number >= priceThreshold && $(this).find(".ship-promo").length == 1) {\n    $(this).find(".ship-promo").replaceWith("<li class=\\"ship-promo\\">" + promoText +"</li>");\n  }\n});\n/* _optimizely_variation_url_end */\n\n/* _optimizely_variation_url include="apple.com/us/product/.*" exclude="" include_match_types="regex" exclude_match_types="" id="1392862507129" */\n$("body").prepend("<img src=/us/beacon/vo.png?votkn=10e168249666bff0473873b366eef97fcc3362277af03759511a6e71c3a215b6347c1892c4e76087b87b312add8e3bbea9f749e36e7588d4e50b6104b6ce32876feee6c6b7ba8844798a49afd95e6bf5040acb034bcde06f21fd88903f4f3faa8d785f15db29b765-abe65359a548ed7e-597d0c02651f0120cfe3fc0655c6426a0a46d68f width=\\"0\\" height=\\"0\\" style=\\"display:none;\\" alt=\\"\\" />");\n\nvar priceThreshold = 0; // PRICE THRESHOLD IN CENTS\nvar promoText = "Free Shipping";  // NEW TEXT TO APPEND TO SHIPPING DETAILS\nvar currency = "$";\nvar currencyDivider = ",";\n\n// *** DO NOT MODIFY BELOW THIS LINE ***\n\n// UPDATE PDP\nvar number = parseFloat($(".purchase-info").find($(".current_price > span > span")).text().trim().replace(currency,"").replace(currencyDivider,"")) * 100;\nif (number >= priceThreshold) {\n  $("#free-shipping").replaceWith("<span id=\\"free-shipping\\" class=\\"materializer\\"><span class=\\"freeshipping promo-text\\">" + promoText +"</span></span>");\n}\n/* _optimizely_variation_url_end */\n\n/* _optimizely_variation_url include="(apple.com/us/.*/.*-accessories/.*)|(apple.com/us/browse/home/collections/)|(apple.com/us/accessories/exclusives)" exclude="" include_match_types="regex" exclude_match_types="" id="1392868893445" */\n$("body").prepend("<img src=/us/beacon/vo.png?votkn=10e168249666bff0473873b366eef97fcc3362277af03759511a6e71c3a215b6347c1892c4e76087b87b312add8e3bbea9f749e36e7588d4e50b6104b6ce32876feee6c6b7ba8844798a49afd95e6bf5040acb034bcde06f21fd88903f4f3faa8d785f15db29b765-abe65359a548ed7e-597d0c02651f0120cfe3fc0655c6426a0a46d68f width=\\"0\\" height=\\"0\\" style=\\"display:none;\\" alt=\\"\\" />");\n\nvar priceThreshold = 0; // PRICE THRESHOLD IN CENTS\nvar promoText = "Free Shipping";  // NEW TEXT TO APPEND TO SHIPPING DETAILS\nvar currency = "$";\nvar currencyDivider = ",";\n\n// *** DO NOT MODIFY BELOW THIS LINE ***\n\n// UPDATE TILE\n$(".item-offer").each(function() {\n  var number = parseFloat($(this).find(".item-price").text().trim().replace(currency,"").replace(currencyDivider,"")) * 100;\n  if (number >= priceThreshold && $(this).find(".ship-promo").length == 0) {\n    $(this).find(".ship-time").before("<li class=\\"ship-promo\\">" + promoText +"</li>");\n  }\n  if (number >= priceThreshold && $(this).find(".ship-promo").length == 1) {\n    $(this).find(".ship-promo").replaceWith("<li class=\\"ship-promo\\">" + promoText +"</li>");\n  }\n});\n/* _optimizely_variation_url_end */\n\n/* _optimizely_variation_url include="apple.com/us/.*/.*-accessories" exclude="" include_match_types="regex" exclude_match_types="" id="1392870843280" */\n$("body").prepend("<img src=/us/beacon/vo.png?votkn=10e168249666bff0473873b366eef97fcc3362277af03759511a6e71c3a215b6347c1892c4e76087b87b312add8e3bbea9f749e36e7588d4e50b6104b6ce32876feee6c6b7ba8844798a49afd95e6bf5040acb034bcde06f21fd88903f4f3faa8d785f15db29b765-abe65359a548ed7e-597d0c02651f0120cfe3fc0655c6426a0a46d68f width=\\"0\\" height=\\"0\\" style=\\"display:none;\\" alt=\\"\\" />");\n\nvar priceThreshold = 0; // PRICE THRESHOLD IN CENTS\nvar promoText = "Free Shipping";  // NEW TEXT TO APPEND TO SHIPPING DETAILS\nvar currency = "$";\nvar currencyDivider = ",";\n\n// *** DO NOT MODIFY BELOW THIS LINE ***\n\n// UPDATE TILE\n$(".info").each(function() {\n  var number = parseFloat($(this).find(".price-current").text().trim().replace(currency,"").replace(currencyDivider,"")) * 100;\n  if (number >= priceThreshold && $(this).find(".ship-promo").length == 0) {\n    $(this).find(".ship-time").before("<li class=\\"ship-promo\\">" + promoText +"</li>");\n  }\n  if (number >= priceThreshold && $(this).find(".ship-promo").length == 1) {\n    $(this).find(".ship-promo").replaceWith("<li class=\\"ship-promo\\">" + promoText +"</li>");\n  }\n});\n\n// UPDATE TILE FOR APPLE TV SUB LOB\n$(".item-content").each(function() {\n  var number = parseFloat($(this).find(".item-price").text().trim().replace(currency,"").replace(currencyDivider,"")) * 100;\n  if (number >= priceThreshold && $(this).find(".ship-promo").length == 0) {\n    $(this).find(".ship-time").before("<li class=\\"ship-promo\\">" + promoText +"</li>");\n  }\n  if (number >= priceThreshold && $(this).find(".ship-promo").length == 1) {\n    $(this).find(".ship-promo").replaceWith("<li class=\\"ship-promo\\">" + promoText +"</li>");\n  }\n});\n/* _optimizely_variation_url_end */\n\n/* _optimizely_variation_url include="apple.com/us/trending" exclude="" include_match_types="regex" exclude_match_types="" id="1393298481313" */\n$("body").prepend("<img src=/us/beacon/vo.png?votkn=cea644052daa8befa64ed1413789080e8629bfdbf66019dc83d283b09079f57ff68e41e51e0fc4d1783d26b28caad62833cf1fab34b68472266bc7b462c7101027d87973e28651e1-405ac984a70546ba-11304e7f673acf062e5c18f744ef90eca0e83d30 width=\\"0\\" height=\\"0\\" style=\\"display:none;\\" alt=\\"\\" />");\n\nvar priceThreshold = 0; // PRICE THRESHOLD IN CENTS\nvar promoText = "Free Shipping";  // NEW TEXT TO APPEND TO SHIPPING DETAILS\nvar currency = "$";\nvar currencyDivider = ",";\nvar matchString = "Available to ship"\n\n// *** DO NOT MODIFY BELOW THIS LINE ***\n\n// UPDATE TILE\n$(".info").each(function() {\n  var number = parseFloat($(this).find(".price-current").text().trim().replace(currency,"").replace(currencyDivider,"")) * 100;\n  var itemName = $(this).find(\'.item-availability > li:eq(0)\').text().trim();\n  if (number >= priceThreshold && itemName.match(matchString)!=null) {\n    $(this).find(".item-availability > li:eq(0)").replaceWith("<li class=\\"ship-promo\\"><span>" + promoText +" | </span></li><li class=\\"ship-promo\\"><span>" + itemName +"</span></li>");\n  }\n  if (number >= priceThreshold && itemName.match(matchString)==null) {\n    $(this).find(".item-availability > li:eq(0)").replaceWith("<li class=\\"ship-promo\\"><span>" + promoText +" | </span></li>");\n  }\n});\n/* _optimizely_variation_url_end */\n\n/* _optimizely_variation_url include="apple.com/us/buy-ip.d/ip.d.*(\\?|\\&)product=.*\\&step=engrave" exclude="" include_match_types="regex" exclude_match_types="" id="1393301783426" */\n$("body").prepend("<img src=/us/beacon/vo.png?votkn=cea644052daa8befa64ed1413789080e8629bfdbf66019dc83d283b09079f57ff68e41e51e0fc4d1783d26b28caad62833cf1fab34b68472266bc7b462c7101027d87973e28651e1-405ac984a70546ba-11304e7f673acf062e5c18f744ef90eca0e83d30 width=\\"0\\" height=\\"0\\" style=\\"display:none;\\" alt=\\"\\" />");\n\nvar promoText = "Free Shipping";  // NEW TEXT TO APPEND TO SHIPPING DETAILS\n\n$(".add-engraving > .free-shipping").replaceWith("<p class=\\"free-shipping\\">" + promoText + "</p>");\n$(".skip-engraving > .free-shipping").replaceWith("<p class=\\"free-shipping\\">" + promoText + "</p>");\n/* _optimizely_variation_url_end */',name:"Variation #4"},"739991793":{code:'$(".ns-buttons > div:eq(1) > div:eq(0)").replaceWith("<div class=\\"row\\">\\n\\t\\t\\n\\t\\n\\t\\t<div class=\\"tiles small\\">\\n\\t\\t\\t\\n\\t\\n\\t\\t<div class=\\"apple-store-app-s-2013-holiday superlink\\" id=\\"coherent_id_40\\">\\n\\t<div class=\\"info\\">\\n\\t\\t<h2>\\n\\t\\t\\t<img class=\\"title ir\\" src=\\"http://store.storeimages.cdn-apple.com/3793/as-images.apple.com/is/image/AppleInc/store-app-title-ipad-m-2013?wid=299&amp;hei=26&amp;fmt=png-alpha&amp;qlt=95&amp;.v=1387836210635\\" alt=\\"\\" data-scale-params-2=\\"wid=598&amp;hei=52&amp;fmt=png-alpha&amp;qlt=95&amp;.v=1387836210635\\" height=\\"26\\" width=\\"285\\"> <span class=\\"a11y\\">The Apple Store app for iPad.</span>\\n\\t\\t</h2>\\n\\t\\t<p class=\\"tagline\\">A whole new way to shop.</p>\\n      <a onclick=\\"s_objectID=\'4946bdec30917b51b87400a97dbfb5ea\';\\" href=\\"https://itunes.apple.com/us/app/apple-store-for-ipad/id732164065?mt=8&amp;at=10l7hL&amp;ct=AOS-US-AppPromoHPSmallTile-iPadMobileSafariOnly\\" class=\\"superlink more\\" data-evar1=\\"AOS: home/shop_ipad | main-1 | Astro Link | 0 | AOS: app/apple-store-for-ipad/id732164065?mt=8&amp;at=10l7hL&amp;ct=AOS-US-AppPromoHPSmallTile-iPadMobileSafariOnly\\" data-evar30=\\"home/shop_ipad/main-1\\" id=\\"coherent_id_41\\">Download now<span class=\\"a11y\\"> Apple Store app for iPad</span></a>\\n\\t</div>\\n\\t<img class=\\"hero ir\\" src=\\"http://store.storeimages.cdn-apple.com/3793/as-images.apple.com/is/image/AppleInc/store-app-hero-s-2013?wid=79&amp;hei=79&amp;fmt=png-alpha&amp;qlt=95&amp;.v=1383255730401\\" alt=\\"\\" data-scale-params-2=\\"wid=158&amp;hei=158&amp;fmt=png-alpha&amp;qlt=95&amp;.v=1383255730401\\" height=\\"79\\" width=\\"79\\">\\n</div>\\n\\t\\n\\t\\n\\t\\n\\n\\t\\t\\t\\n\\t\\n\\t\\t<div class=\\"mkbags-s-201403a superlink\\" id=\\"coherent_id_20\\">\\n\\t<div class=\\"info\\">\\n\\t\\t<h2><a href=\\"/us/mac/mac-accessories/notebook-cases#!&amp;f=exclusive&amp;fh=36c2%2B3b25\\" class=\\"superlink\\" id=\\"coherent_id_21\\"><img src=\\"http://store.storeimages.cdn-apple.com/3877/as-images.apple.com/is/image/AppleInc/styles-title-s-201403a?wid=326&amp;fmt=png-alpha&amp;qlt=95\\" alt=\\"\\" width=\\"275\\"><span class=\\"a11y\\">Exclusive styles.</span></a></h2>\\n\\t\\t<p class=\\"tagline\\">Sleeves, bags, and cases for Mac. Exclusive to the Apple Store.</p>\\n\\t</div>\\n\\t<img class=\\"hero\\" src=\\"http://store.storeimages.cdn-apple.com/3877/as-images.apple.com/is/image/AppleInc/H9990-hero-s-201403a?wid=326&amp;hei=190&amp;fmt=png-alpha&amp;qlt=95\\" alt=\\"\\" width=\\"203\\">\\n</div>\\n\\t\\n\\t\\n\\t\\n\\n\\t\\t</div>\\n\\t\\n\\t\\n\\t\\n\\n\\t\\t\\n\\t\\n\\t\\t<div class=\\"tiles large\\">\\n\\t<div class=\\"macbook-pro-retina-l-201310 clearfix superlink\\">\\n\\t\\t<img class=\\"hero ir\\" src=\\"http://store.storeimages.cdn-apple.com/3877/as-images.apple.com/is/image/AppleInc/macbook-pro-retina-hero-l-201310?wid=588&amp;hei=189&amp;fmt=jpeg&amp;qlt=95&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,0.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=1387428500959\\" alt=\\"\\" data-scale-params-2=\\"wid=1176&amp;hei=378&amp;fmt=jpeg&amp;qlt=95&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,0.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=1387428500959\\" height=\\"189\\" width=\\"588\\">\\n\\t\\t<div class=\\"info\\">\\n\\t\\t\\t<h2>\\n\\t\\t\\t\\t<img class=\\"title ir\\" src=\\"http://store.storeimages.cdn-apple.com/3877/as-images.apple.com/is/image/AppleInc/macbook-pro-retina-title-l-201310?wid=228&amp;hei=61&amp;fmt=jpeg&amp;qlt=95&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,0.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=1381433522191\\" alt=\\"\\" data-scale-params-2=\\"wid=456&amp;hei=122&amp;fmt=jpeg&amp;qlt=95&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,0.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=1381433522191\\" height=\\"61\\" width=\\"228\\">\\n\\t\\t\\t\\t<span class=\\"a11y\\">MacBook Pro with Retina display</span>\\n\\t\\t\\t</h2>\\n\\t\\t\\t<p class=\\"tagline\\">\\n\\t\\t\\t\\tNow with more power behind every pixel.\\n\\t\\t\\t</p>\\n\\t\\t\\t<a href=\\"/us/buy-mac/macbook-pro\\" class=\\"button merchandising small superlink\\" onclick=\\"s_objectID=\'9da3454afc1750b7d7facfd9e7f7070a\';\\" data-evar1=\\"AOS: home | main-2 | Astro Link | 0 | AOS: home/shop_mac/family/macbook_pro\\" data-evar30=\\"home/main-2\\">From \\n\\t\\n\\t\\n\\t\\n\\t\\n\\t\\n\\t\\t\\n\\t\\t\\t\\n\\t\\t\\t\\t\\n\\t\\t\\t\\t$1299\\n\\t\\t\\t\\t\\n\\t\\t\\t\\t\\n\\t\\t\\t\\t\\n\\t\\t\\t\\t\\n\\t\\t\\t\\n\\t\\t\\t\\n\\t\\t\\t\\n\\t\\t\\n\\t\\t\\n\\t\\t\\n\\t\\t\\n\\t\\t\\n\\t\\t\\n\\t\\t\\n\\t\\t\\n\\t\\t\\n\\t\\t\\n\\t\\t\\n\\t\\t\\t\\n\\t\\t\\t\\n\\t\\t\\n\\t\\t\\n\\t\\t\\n\\t\\t\\n\\t\\t\\n\\t\\t\\n\\t\\t\\n    \\n\\t\\n\\t\\n</a>\\n\\t\\t</div>\\n\\t</div>\\n</div>\\n\\t\\n\\t</div>");',name:"Variation #2 - Tile"},"567991315":{name:"Original"},"842670190":{code:'/* _optimizely_variation_url include="apple.com/(us$)|(us\\?revision=.*)" exclude="" include_match_types="regex" exclude_match_types="" id="1392854946629" */\n\n/* _optimizely_variation_url_end */\n\n/* _optimizely_variation_url include="apple.com/us/iphone" exclude="" include_match_types="regex" exclude_match_types="" id="1392856196495" */\n\n/* _optimizely_variation_url_end */\n\n/* _optimizely_variation_url include="apple.com/us/buy-iphone/iphone.*/(8gb)|(16gb)|(32gb)|(64gb).*" exclude="" include_match_types="regex" exclude_match_types="" id="1392856550570" */\n\n/* _optimizely_variation_url_end */\n\n/* _optimizely_variation_url include="apple.com/us/buy-iphone/iphone.*\\?cppart=.*\\&product=.*\\&step=.*" exclude="" include_match_types="regex" exclude_match_types="" id="1392857762511" */\n\n/* _optimizely_variation_url_end */\n\n/* _optimizely_variation_url include="apple.com/us/search/.*" exclude="" include_match_types="regex" exclude_match_types="" id="1392858065250" */\n\n/* _optimizely_variation_url_end */',name:"Original"},"748231703":{name:"Original"},"850260184":{code:'/* _optimizely_variation_url include="apple.com/(us$)|(us\\?revision=.*)" exclude="" include_match_types="regex" exclude_match_types="" id="1392854946629" */\n$("body").prepend("<img src=/us/beacon/vo.png?votkn=47d069d109250abe247f5aafcb33903c98c990519e2409dd2494ba495e241ca572944056f053622d3e9fd46ddb632bc97caf13cb96c14eba36c76f008ad42b3c2d420c4091726d89-6be29c0eb48ff005-28c0d83b00e2d558e0c930fada077e71f4a3a321 width=\\"0\\" height=\\"0\\" style=\\"display:none;\\" alt=\\"\\" />");\n$(".ribbon-one a.superlink").replaceWith("<a href=\\"/us/browse/campaigns/shipping_and_returns\\" class=\\"superlink\\" onclick=\\"s_objectID=\'2d5e71d5c0ee4a172123a32bd1b7aa1e\';\\" data-evar1=\\"AOS: home | main-1 | Astro Link | 0 | AOS: campaigns/shipping_and_returns\\" data-evar30=\\"home/main-1\\">Free next day shipping on all iPhones. Free returns.</a>");\n$(".compactx1").replaceWith("<p class=\\"compactx1\\"> Get free next day shipping direct to your door on all iPhone models. </p>");\n/* _optimizely_variation_url_end */\n\n/* _optimizely_variation_url include="apple.com/us/iphone" exclude="" include_match_types="regex" exclude_match_types="" id="1392856196495" */\n$("body").prepend("<img src=/us/beacon/vo.png?votkn=47d069d109250abe247f5aafcb33903c98c990519e2409dd2494ba495e241ca572944056f053622d3e9fd46ddb632bc97caf13cb96c14eba36c76f008ad42b3c2d420c4091726d89-6be29c0eb48ff005-28c0d83b00e2d558e0c930fada077e71f4a3a321 width=\\"0\\" height=\\"0\\" style=\\"display:none;\\" alt=\\"\\" />");\n$(".ribbon > div:eq(0) > div:eq(0) > h3:eq(0) > a:eq(0)").replaceWith("<a href=\\"/us/browse/campaigns/shipping_and_returns\\" class=\\"superlink\\" onclick=\\"s_objectID=\'f3c9f31d1bfd20efbc39d8bbb8bee89b\';\\" data-evar1=\\"AOS: home/shop_iphone | main-1 | Astro Link | 0 | AOS: campaigns/shipping_and_returns\\" data-evar30=\\"home/shop_iphone/main-1\\">Free next day shipping on all iPhones. Free returns.</a>");\n$(".compactx1").replaceWith("<p class=\\"compactx1\\"> Get free next day shipping direct to your door on all iPhone models. </p>");\n/* _optimizely_variation_url_end */\n\n/* _optimizely_variation_url include="apple.com/us/buy-iphone/iphone.*/(8gb)|(16gb)|(32gb)|(64gb).*" exclude="" include_match_types="regex" exclude_match_types="" id="1392856550570" */\n$("body").prepend("<img src=/us/beacon/vo.png?votkn=47d069d109250abe247f5aafcb33903c98c990519e2409dd2494ba495e241ca572944056f053622d3e9fd46ddb632bc97caf13cb96c14eba36c76f008ad42b3c2d420c4091726d89-6be29c0eb48ff005-28c0d83b00e2d558e0c930fada077e71f4a3a321 width=\\"0\\" height=\\"0\\" style=\\"display:none;\\" alt=\\"\\" />");\n\n$(".free-shipping").replaceWith("<span class=\\"free-shipping\\">Free Next Day Shipping</span>");\n/* _optimizely_variation_url_end */\n\n/* _optimizely_variation_url include="apple.com/us/buy-iphone/iphone.*\\?cppart=.*\\&product=.*\\&step=.*" exclude="" include_match_types="regex" exclude_match_types="" id="1392857762511" */\n$("body").prepend("<img src=/us/beacon/vo.png?votkn=47d069d109250abe247f5aafcb33903c98c990519e2409dd2494ba495e241ca572944056f053622d3e9fd46ddb632bc97caf13cb96c14eba36c76f008ad42b3c2d420c4091726d89-6be29c0eb48ff005-28c0d83b00e2d558e0c930fada077e71f4a3a321 width=\\"0\\" height=\\"0\\" style=\\"display:none;\\" alt=\\"\\" />");\n$(".free-shipping").replaceWith("<span class=\\"free-shipping\\">&nbsp;Free Next Day Shipping</span>");\n/* _optimizely_variation_url_end */\n\n/* _optimizely_variation_url include="apple.com/us/search/.*" exclude="" include_match_types="regex" exclude_match_types="" id="1392858065250" */\n$("body").prepend("<img src=/us/beacon/vo.png?votkn=47d069d109250abe247f5aafcb33903c98c990519e2409dd2494ba495e241ca572944056f053622d3e9fd46ddb632bc97caf13cb96c14eba36c76f008ad42b3c2d420c4091726d89-6be29c0eb48ff005-28c0d83b00e2d558e0c930fada077e71f4a3a321 width=\\"0\\" height=\\"0\\" style=\\"display:none;\\" alt=\\"\\" />");\n$(".item-content").each(function() {\nvar itemName = $(this).find(\'.item-title\').text().trim();\nif(itemName.match("iPhone.*(8GB|16GB|32GB|64GB)")!=null)\n{\n$(this).find(\'.ship-promo\').text(\'Free Next Day Shipping\');\n}\n});\n/* _optimizely_variation_url_end */',name:"Variation #1"},"713660730":{code:'$(".ribbon").replaceWith("<div class=\\"ribbon clearfix\\">\\n\\t\\t\\n\\t\\n\\t\\t\\n\\t\\t<div class=\\"gs grid-1of2 ribbon-one\\">\\n\\t<div class=\\"item superlink\\">\\n\\t\\t\\n\\t\\n\\t\\t<img class=\\"ir\\" src=\\"http://store.storeimages.cdn-apple.com/3793/as-images.apple.com/is/image/AppleInc/shipping-ribbon-2013?wid=15&amp;hei=22&amp;fmt=jpeg&amp;qlt=95&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,0.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=1370019730981\\" alt=\\"\\" data-scale-params-2=\\"wid=30&amp;hei=44&amp;fmt=jpeg&amp;qlt=95&amp;op_sharpen=0&amp;resMode=bicub&amp;op_usm=0.5,0.5,0,0&amp;iccEmbed=0&amp;layer=comp&amp;.v=1370019730981\\" height=\\"22\\" width=\\"15\\">\\n<h3>\\n\\t<a onclick=\\"s_objectID=\'2d5e71d5c0ee4a172123a32bd1b7aa1e\';\\" href=\\"/us/browse/campaigns/shipping_and_returns\\" class=\\"superlink\\" data-evar1=\\"AOS: home | main-1 | Astro Link | 0 | AOS: campaigns/shipping_and_returns\\" data-evar30=\\"home/main-1\\">Free shipping. Free returns.</a>\\n</h3>\\n<p class=\\"compactx1\\">\\n\\tGet free shipping direct to your door on all orders over $50.\\n</p>\\n\\t\\n\\t\\n\\t\\n\\n\\t</div>\\n</div>\\n<div class=\\"gs grid-1of2 ribbon-two\\">\\n\\t<div class=\\"item superlink\\">\\n\\t\\t\\n\\t\\n\\t\\t<img class=\\"ir\\" src=\\"http://store.storeimages.cdn-apple.com/3793/as-images.apple.com/is/image/AppleInc/storeapp-ribbon-201311?wid=21&amp;hei=22&amp;fmt=png-alpha&amp;qlt=95&amp;.v=1383255702296\\" alt=\\"\\" data-scale-params-2=\\"wid=42&amp;hei=44&amp;fmt=png-alpha&amp;qlt=95&amp;.v=1383255702296\\" height=\\"22\\" width=\\"21\\"> \\n<h3><a href=\\"http://itunes.apple.com/app/apple-store-for-ipad/id732164065?mt=8&amp;at=10l7hL&amp;ct=AOS-US-AppPromoHPRibbon-iPadMobileSafariOnly\\" class=\\"superlink\\" onclick=\\"s_objectID=\'b4803b395db34fcf59a8856ff9f19d48\';\\" data-evar1=\\"AOS: home | main-1 | Astro Link | 0 | AOS: app/apple-store-for-ipad/id732164065?mt=8&amp;at=10l7hL&amp;ct=AOS-US-AppPromoHPRibbon-iPadMobileSafariOnly\\" data-evar30=\\"home/main-1\\">The Apple Store app for iPad.</a></h3>\\n<p>Enhance your shopping experience with the new app.</p>\\n\\t\\n\\t\\n\\t\\n\\n\\t</div>\\n</div>\\n\\n\\t\\n\\t\\n\\t\\n\\n\\t</div>");',name:"Variation #3 - Ribbon"},"696726683":{code:'$("li.tile-11").detach().insertBefore("li.tile-8");\n$("li.tile-12").detach().insertBefore("li.tile-8");\n$("li.tile-10").detach().insertBefore("li.tile-8");',name:"Variation #1"},"739960733":{name:"Original"},"827521438":{code:'/* _optimizely_variation_url include="apple.com/(us$)|(us\\?revision=.*)" exclude="" include_match_types="regex" exclude_match_types="" id="1392854946629" */\n$("body").prepend("<img src=/us/beacon/vo.png?votkn=cea644052daa8befa64ed1413789080e8629bfdbf66019dc83d283b09079f57ff68e41e51e0fc4d1783d26b28caad62833cf1fab34b68472266bc7b462c7101027d87973e28651e1-405ac984a70546ba-11304e7f673acf062e5c18f744ef90eca0e83d30 width=\\"0\\" height=\\"0\\" style=\\"display:none;\\" alt=\\"\\" />");\n$(".compactx1").replaceWith("<p class=\\"compactx1\\"> Get free shipping direct to your door on all orders over $25. </p>");\n\nvar priceThreshold = 2500; // PRICE THRESHOLD IN CENTS\nvar promoText = "Free Shipping";  // NEW TEXT TO APPEND TO SHIPPING DETAILS\nvar currency = "$";\nvar currencyDivider = ",";\n\n// *** DO NOT MODIFY BELOW THIS LINE ***\n\n// UPDATE SLIDER\n$(".slides .info").each(function() {\n  var number = parseFloat($(this).find(".price-current").text().trim().replace(currency,"").replace(currencyDivider,"")) * 100;\n  if (number >= priceThreshold && $(this).find(".ship-promo").length == 1 && $(this).find(".ship-promo.border-right").length == 0 && $(this).find(".ship-promo-opt").length == 0) {\n    $(this).find(".ship-promo").before("<li class=\\"ship-promo border-right\\"><span>" + promoText +"</span></li>");\n  }\n  if (number >= priceThreshold && $(this).find(".ship-promo.border-right").length == 1) {\n    $(this).find(".ship-promo.border-right").replaceWith("<li class=\\"ship-promo border-right\\"><span>" + promoText +"</span></li>");\n  }\n  if (number >= priceThreshold && $(this).find(".ship-promo-opt").length == 1) {\n    $(this).find(".ship-promo-opt").replaceWith("<li class=\\"ship-promo-opt\\"><span>" + promoText +" | </span></li>");\n  }\n});\n\n// UPDATE PINWHEEL\n$(".pinwheel .info").each(function() {\n  var number = parseFloat($(this).find(".price-current").text().trim().replace(currency,"").replace(currencyDivider,"")) * 100;\n  if (number >= priceThreshold && $(this).find(".ship-promo").length == 0) {\n    $(this).find(".ship-time").before("<li class=\\"ship-promo\\">" + promoText + " </li>");\n  }\n  if (number >= priceThreshold && $(this).find(".ship-promo").length == 1) {\n    $(this).find(".ship-promo").replaceWith("<li class=\\"ship-promo\\">" + promoText + " </li>");\n  }\n});\n\n// UPDATE SLIDER AND PINWHEEL AGAIN WHEN PAGE LOAD IS COMPLETE\n$(document).ready(function() {\n\n// UPDATE SLIDER\n$(".slides .info").each(function() {\n  var number = parseFloat($(this).find(".price-current").text().trim().replace(currency,"").replace(currencyDivider,"")) * 100;\n  if (number >= priceThreshold && $(this).find(".ship-promo").length == 1 && $(this).find(".ship-promo.border-right").length == 0 && $(this).find(".ship-promo-opt").length == 0) {\n    $(this).find(".ship-promo").before("<li class=\\"ship-promo border-right\\"><span>" + promoText +"</span></li>");\n  }\n  if (number >= priceThreshold && $(this).find(".ship-promo.border-right").length == 1) {\n    $(this).find(".ship-promo.border-right").replaceWith("<li class=\\"ship-promo border-right\\"><span>" + promoText +"</span></li>");\n  }\n  if (number >= priceThreshold && $(this).find(".ship-promo-opt").length == 1) {\n    $(this).find(".ship-promo-opt").replaceWith("<li class=\\"ship-promo-opt\\"><span>" + promoText +" | </span></li>");\n  }\n});\n\n// UPDATE PINWHEEL\n$(".pinwheel .info").each(function() {\n  var number = parseFloat($(this).find(".price-current").text().trim().replace(currency,"").replace(currencyDivider,"")) * 100;\n  if (number >= priceThreshold && $(this).find(".ship-promo").length == 0) {\n    $(this).find(".ship-time").before("<li class=\\"ship-promo\\">" + promoText + " </li>");\n  }\n  if (number >= priceThreshold && $(this).find(".ship-promo").length == 1) {\n    $(this).find(".ship-promo").replaceWith("<li class=\\"ship-promo\\">" + promoText + " </li>");\n  }\n});\n  \n});\n/* _optimizely_variation_url_end */\n\n/* _optimizely_variation_url include="apple.com/us/(mac)|(ipad)|(iphone)|(ipod)|(appletv)" exclude="" include_match_types="regex" exclude_match_types="" id="1392856196495" */\n$("body").prepend("<img src=/us/beacon/vo.png?votkn=cea644052daa8befa64ed1413789080e8629bfdbf66019dc83d283b09079f57ff68e41e51e0fc4d1783d26b28caad62833cf1fab34b68472266bc7b462c7101027d87973e28651e1-405ac984a70546ba-11304e7f673acf062e5c18f744ef90eca0e83d30 width=\\"0\\" height=\\"0\\" style=\\"display:none;\\" alt=\\"\\" />");\n$(".compactx1").replaceWith("<p class=\\"compactx1\\"> Get free shipping direct to your door on all orders over $25. </p>");\n\nvar priceThreshold = 2500; // PRICE THRESHOLD IN CENTS\nvar promoText = "Free Shipping";  // NEW TEXT TO APPEND TO SHIPPING DETAILS\nvar currency = "$";\nvar currencyDivider = ",";\n\n// *** DO NOT MODIFY BELOW THIS LINE ***\n\n// UPDATE SLIDER\n$(".slides .info").each(function() {\n  var number = parseFloat($(this).find(".price-current").text().trim().replace(currency,"").replace(currencyDivider,"")) * 100;\n  if (number >= priceThreshold && $(this).find(".ship-promo").length == 1 && $(this).find(".ship-promo.border-right").length == 0 && $(this).find(".ship-promo-opt").length == 0) {\n    $(this).find(".ship-promo").before("<li class=\\"ship-promo border-right\\"><span>" + promoText +"</span></li>");\n  }\n  if (number >= priceThreshold && $(this).find(".ship-promo.border-right").length == 1) {\n    $(this).find(".ship-promo.border-right").replaceWith("<li class=\\"ship-promo border-right\\"><span>" + promoText +"</span></li>");\n  }\n  if (number >= priceThreshold && $(this).find(".ship-promo-opt").length == 1) {\n    $(this).find(".ship-promo-opt").replaceWith("<li class=\\"ship-promo-opt\\"><span>" + promoText +" | </span></li>");\n  }\n});\n\n// UPDATE PINWHEEL\n$(".pinwheel .info").each(function() {\n  var number = parseFloat($(this).find(".price-current").text().trim().replace(currency,"").replace(currencyDivider,"")) * 100;\n  if (number >= priceThreshold && $(this).find(".ship-promo").length == 0) {\n    $(this).find(".ship-time").before("<li class=\\"ship-promo\\">" + promoText + " </li>");\n  }\n  if (number >= priceThreshold && $(this).find(".ship-promo").length == 1) {\n    $(this).find(".ship-promo").replaceWith("<li class=\\"ship-promo\\">" + promoText + " </li>");\n  }\n});\n\n// UPDATE SLIDER AND PINWHEEL AGAIN WHEN PAGE LOAD IS COMPLETE\n$(document).ready(function() {\n\n// UPDATE SLIDER\n$(".slides .info").each(function() {\n  var number = parseFloat($(this).find(".price-current").text().trim().replace(currency,"").replace(currencyDivider,"")) * 100;\n  if (number >= priceThreshold && $(this).find(".ship-promo").length == 1 && $(this).find(".ship-promo.border-right").length == 0 && $(this).find(".ship-promo-opt").length == 0) {\n    $(this).find(".ship-promo").before("<li class=\\"ship-promo border-right\\"><span>" + promoText +"</span></li>");\n  }\n  if (number >= priceThreshold && $(this).find(".ship-promo.border-right").length == 1) {\n    $(this).find(".ship-promo.border-right").replaceWith("<li class=\\"ship-promo border-right\\"><span>" + promoText +"</span></li>");\n  }\n  if (number >= priceThreshold && $(this).find(".ship-promo-opt").length == 1) {\n    $(this).find(".ship-promo-opt").replaceWith("<li class=\\"ship-promo-opt\\"><span>" + promoText +" | </span></li>");\n  }\n});\n\n// UPDATE PINWHEEL\n$(".pinwheel .info").each(function() {\n  var number = parseFloat($(this).find(".price-current").text().trim().replace(currency,"").replace(currencyDivider,"")) * 100;\n  if (number >= priceThreshold && $(this).find(".ship-promo").length == 0) {\n    $(this).find(".ship-time").before("<li class=\\"ship-promo\\">" + promoText + " </li>");\n  }\n  if (number >= priceThreshold && $(this).find(".ship-promo").length == 1) {\n    $(this).find(".ship-promo").replaceWith("<li class=\\"ship-promo\\">" + promoText + " </li>");\n  }\n});\n  \n});\n/* _optimizely_variation_url_end */\n\n/* _optimizely_variation_url include="apple.com/us/search/.*" exclude="" include_match_types="regex" exclude_match_types="" id="1392860007504" */\n$("body").prepend("<img src=/us/beacon/vo.png?votkn=cea644052daa8befa64ed1413789080e8629bfdbf66019dc83d283b09079f57ff68e41e51e0fc4d1783d26b28caad62833cf1fab34b68472266bc7b462c7101027d87973e28651e1-405ac984a70546ba-11304e7f673acf062e5c18f744ef90eca0e83d30 width=\\"0\\" height=\\"0\\" style=\\"display:none;\\" alt=\\"\\" />");\n\nvar priceThreshold = 2500; // PRICE THRESHOLD IN CENTS\nvar promoText = "Free Shipping";  // NEW TEXT TO APPEND TO SHIPPING DETAILS\nvar currency = "$";\nvar currencyDivider = ",";\n\n// *** DO NOT MODIFY BELOW THIS LINE ***\n\n// UPDATE TILE\n$(".item-offer").each(function() {\n  var number = parseFloat($(this).find(".item-price").text().trim().replace(currency,"").replace(currencyDivider,"")) * 100;\n  if (number >= priceThreshold && $(this).find(".ship-promo").length == 0) {\n    $(this).find(".ship-time").before("<li class=\\"ship-promo\\">" + promoText +"</li>");\n  }\n  if (number >= priceThreshold && $(this).find(".ship-promo").length == 1) {\n    $(this).find(".ship-promo").replaceWith("<li class=\\"ship-promo\\">" + promoText +"</li>");\n  }\n});\n/* _optimizely_variation_url_end */\n\n/* _optimizely_variation_url include="apple.com/us/product/.*" exclude="" include_match_types="regex" exclude_match_types="" id="1392862507129" */\n$("body").prepend("<img src=/us/beacon/vo.png?votkn=cea644052daa8befa64ed1413789080e8629bfdbf66019dc83d283b09079f57ff68e41e51e0fc4d1783d26b28caad62833cf1fab34b68472266bc7b462c7101027d87973e28651e1-405ac984a70546ba-11304e7f673acf062e5c18f744ef90eca0e83d30 width=\\"0\\" height=\\"0\\" style=\\"display:none;\\" alt=\\"\\" />");\n\nvar priceThreshold = 2500; // PRICE THRESHOLD IN CENTS\nvar promoText = "Free Shipping";  // NEW TEXT TO APPEND TO SHIPPING DETAILS\nvar currency = "$";\nvar currencyDivider = ",";\n\n// *** DO NOT MODIFY BELOW THIS LINE ***\n\n// UPDATE PDP\nvar number = parseFloat($(".purchase-info").find($(".current_price > span > span")).text().trim().replace(currency,"").replace(currencyDivider,"")) * 100;\nif (number >= priceThreshold) {\n  $("#free-shipping").replaceWith("<span id=\\"free-shipping\\" class=\\"materializer\\"><span class=\\"freeshipping promo-text\\">" + promoText +"</span></span>");\n}\n/* _optimizely_variation_url_end */\n\n/* _optimizely_variation_url include="(apple.com/us/.*/.*-accessories/.*)|(apple.com/us/browse/home/collections/)|(apple.com/us/accessories/exclusives)" exclude="" include_match_types="regex" exclude_match_types="" id="1392868893445" */\n$("body").prepend("<img src=/us/beacon/vo.png?votkn=cea644052daa8befa64ed1413789080e8629bfdbf66019dc83d283b09079f57ff68e41e51e0fc4d1783d26b28caad62833cf1fab34b68472266bc7b462c7101027d87973e28651e1-405ac984a70546ba-11304e7f673acf062e5c18f744ef90eca0e83d30 width=\\"0\\" height=\\"0\\" style=\\"display:none;\\" alt=\\"\\" />");\n\nvar priceThreshold = 2500; // PRICE THRESHOLD IN CENTS\nvar promoText = "Free Shipping";  // NEW TEXT TO APPEND TO SHIPPING DETAILS\nvar currency = "$";\nvar currencyDivider = ",";\n\n// *** DO NOT MODIFY BELOW THIS LINE ***\n\n// UPDATE TILE\n$(".item-offer").each(function() {\n  var number = parseFloat($(this).find(".item-price").text().trim().replace(currency,"").replace(currencyDivider,"")) * 100;\n  if (number >= priceThreshold && $(this).find(".ship-promo").length == 0) {\n    $(this).find(".ship-time").before("<li class=\\"ship-promo\\">" + promoText +"</li>");\n  }\n  if (number >= priceThreshold && $(this).find(".ship-promo").length == 1) {\n    $(this).find(".ship-promo").replaceWith("<li class=\\"ship-promo\\">" + promoText +"</li>");\n  }\n});\n/* _optimizely_variation_url_end */\n\n/* _optimizely_variation_url include="apple.com/us/.*/.*-accessories" exclude="" include_match_types="regex" exclude_match_types="" id="1392870843280" */\n$("body").prepend("<img src=/us/beacon/vo.png?votkn=cea644052daa8befa64ed1413789080e8629bfdbf66019dc83d283b09079f57ff68e41e51e0fc4d1783d26b28caad62833cf1fab34b68472266bc7b462c7101027d87973e28651e1-405ac984a70546ba-11304e7f673acf062e5c18f744ef90eca0e83d30 width=\\"0\\" height=\\"0\\" style=\\"display:none;\\" alt=\\"\\" />");\n\nvar priceThreshold = 2500; // PRICE THRESHOLD IN CENTS\nvar promoText = "Free Shipping";  // NEW TEXT TO APPEND TO SHIPPING DETAILS\nvar currency = "$";\nvar currencyDivider = ",";\n\n// *** DO NOT MODIFY BELOW THIS LINE ***\n\n// UPDATE TILE\n$(".info").each(function() {\n  var number = parseFloat($(this).find(".price-current").text().trim().replace(currency,"").replace(currencyDivider,"")) * 100;\n  if (number >= priceThreshold && $(this).find(".ship-promo").length == 0) {\n    $(this).find(".ship-time").before("<li class=\\"ship-promo\\">" + promoText +"</li>");\n  }\n  if (number >= priceThreshold && $(this).find(".ship-promo").length == 1) {\n    $(this).find(".ship-promo").replaceWith("<li class=\\"ship-promo\\">" + promoText +"</li>");\n  }\n});\n\n// UPDATE TILE FOR APPLE TV SUB LOB\n$(".item-content").each(function() {\n  var number = parseFloat($(this).find(".item-price").text().trim().replace(currency,"").replace(currencyDivider,"")) * 100;\n  if (number >= priceThreshold && $(this).find(".ship-promo").length == 0) {\n    $(this).find(".ship-time").before("<li class=\\"ship-promo\\">" + promoText +"</li>");\n  }\n  if (number >= priceThreshold && $(this).find(".ship-promo").length == 1) {\n    $(this).find(".ship-promo").replaceWith("<li class=\\"ship-promo\\">" + promoText +"</li>");\n  }\n});\n/* _optimizely_variation_url_end */\n\n/* _optimizely_variation_url include="apple.com/us/trending" exclude="" include_match_types="regex" exclude_match_types="" id="1393298481313" */\n$("body").prepend("<img src=/us/beacon/vo.png?votkn=cea644052daa8befa64ed1413789080e8629bfdbf66019dc83d283b09079f57ff68e41e51e0fc4d1783d26b28caad62833cf1fab34b68472266bc7b462c7101027d87973e28651e1-405ac984a70546ba-11304e7f673acf062e5c18f744ef90eca0e83d30 width=\\"0\\" height=\\"0\\" style=\\"display:none;\\" alt=\\"\\" />");\n\nvar priceThreshold = 2500; // PRICE THRESHOLD IN CENTS\nvar promoText = "Free Shipping";  // NEW TEXT TO APPEND TO SHIPPING DETAILS\nvar currency = "$";\nvar currencyDivider = ",";\nvar matchString = "Available to ship"\n\n// *** DO NOT MODIFY BELOW THIS LINE ***\n\n// UPDATE TILE\n$(".info").each(function() {\n  var number = parseFloat($(this).find(".price-current").text().trim().replace(currency,"").replace(currencyDivider,"")) * 100;\n  var itemName = $(this).find(\'.item-availability > li:eq(0)\').text().trim();\n  if (number >= priceThreshold && itemName.match(matchString)!=null) {\n    $(this).find(".item-availability > li:eq(0)").replaceWith("<li class=\\"ship-promo\\"><span>" + promoText +" | </span></li><li class=\\"ship-promo\\"><span>" + itemName +"</span></li>");\n  }\n  if (number >= priceThreshold && itemName.match(matchString)==null) {\n    $(this).find(".item-availability > li:eq(0)").replaceWith("<li class=\\"ship-promo\\"><span>" + promoText +" | </span></li>");\n  }\n});\n/* _optimizely_variation_url_end */\n\n/* _optimizely_variation_url include="apple.com/us/buy-ip.d/ip.d.*(\\?|\\&)product=.*\\&step=engrave" exclude="" include_match_types="regex" exclude_match_types="" id="1393301783426" */\n$("body").prepend("<img src=/us/beacon/vo.png?votkn=cea644052daa8befa64ed1413789080e8629bfdbf66019dc83d283b09079f57ff68e41e51e0fc4d1783d26b28caad62833cf1fab34b68472266bc7b462c7101027d87973e28651e1-405ac984a70546ba-11304e7f673acf062e5c18f744ef90eca0e83d30 width=\\"0\\" height=\\"0\\" style=\\"display:none;\\" alt=\\"\\" />");\n\nvar promoText = "Free Shipping";  // NEW TEXT TO APPEND TO SHIPPING DETAILS\n\n$(".add-engraving > .free-shipping").replaceWith("<p class=\\"free-shipping\\">" + promoText + "</p>");\n$(".skip-engraving > .free-shipping").replaceWith("<p class=\\"free-shipping\\">" + promoText + "</p>");\n/* _optimizely_variation_url_end */',name:"Variation #2"}},installation_verified:true,experiments:{"842730040":{name:"demoiphoneusconman140305",manual:true,enabled:true,site_catalyst_evar:52,conditions:[{type:"code",value:'var optlyaovtm = 0; //1 = ALWAYS ON, 0 = OBEY TIMER\nvar optlytmb = 1398668400000; //BEGIN TIME IN MILLISECONDS 4/28/2014 12:00:00 AM\nvar optlytme = 1399359599000; //END TIME IN MILLISECONDS 5/5/2014 11:59:59 PM\nvar currentExperimentId = 842730040, expArray = [842730040, 849170741]; \n\n// *** DO NOT MODIFY BELOW THIS LINE ***\n\n//soft time logic \nvar optlytm = false; \nif(window.optimizely_tm >= optlytmb && window.optimizely_tm <= optlytme){\n\toptlytm = true;\n} \n \n//mutual exclusion logic \nvar optlyme = false; \nvar bucketsCookie = document.cookie.match("optimizelyBuckets=([^;]*)"); \nif (bucketsCookie) {\n\tvar bucketsString = decodeURIComponent(bucketsCookie[1]), bucketsJSON = $.parseJSON(bucketsString) || {}; \n\tfor (var i = 0; i < expArray.length; i++) { \n\t\tvar experimentId = expArray[i]; \n\t\tvar experimentAssigned = bucketsJSON.hasOwnProperty(experimentId), experimentBucketed = experimentAssigned ? bucketsJSON[experimentId] != 0 : !1; \n\t\tif (experimentBucketed) { \n\t\t\twindow.optimizely["__groupA"] = expArray[i]; \n\t\t\tbreak; \n\t\t} \n\t} \n} \nwindow.optimizely["__groupA"] = window.optimizely["__groupA"] || expArray[Math.floor(Math.random()*expArray.length)]; \noptlyme = window.optimizely["__groupA"] == currentExperimentId; \n\n//return val \n(optlytm && optlyme) || (optlyaovtm && optlyme)'},{values:[""],type:"cookies",names:["optly_apple_test"]},{values:[{match:"regex",value:"apple.com/(us$)|(us\\?revision=.*)"},{match:"regex",value:"apple.com/us/iphone"},{match:"regex",value:"apple.com/us/buy-iphone/iphone.*/(8gb)|(16gb)|(32gb)|(64gb).*"},{match:"regex",value:"apple.com/us/buy-iphone/iphone.*\\?cppart=.*\\&product=.*\\&step=.*"},{match:"regex",value:"apple.com/us/search/.*"}],type:"url"},{only_first_time:true,type:"visitor",value:"all"}],enabled_variation_ids:["850260184"],variation_weights:{"850260184":10000},variation_ids:["842670190","850260184"]},"579710937":{name:"Free Shipping $35 - $50 [Optimizely Support]",conditions:[{values:[{match:"simple",value:"http://store.apple.com/us/ipad/ipad-accessories/cases#!&s=priceHL"}],type:"url"},{only_first_time:true,type:"visitor",value:"all"}],enabled_variation_ids:["567991315","584470190"],variation_ids:["567991315","584470190"]},"739950725":{name:"Dieteruscon140314 (1)",site_catalyst_evar:53,conditions:[{values:["ipad"],type:"browser"},{values:[{match:"regex",value:"apple.com/us$"}],type:"url"},{only_first_time:true,type:"visitor",value:"all"}],enabled_variation_ids:["715790688","739960733","739991793","713660730"],variation_ids:["715790688","739960733","739991793","713660730"]},"849170741":{name:"demothreshusconman140305",manual:true,enabled:true,site_catalyst_evar:52,conditions:[{type:"code",value:'var optlyaovtm = 0; //1 = ALWAYS ON, 0 = OBEY TIMER\nvar optlytmb = 1398668400000; //BEGIN TIME IN MILLISECONDS 4/28/2014 12:00:00 AM\nvar optlytme = 1399359599000; //END TIME IN MILLISECONDS 5/5/2014 11:59:59 PM\nvar currentExperimentId = 849170741, expArray = [842730040, 849170741]; \n\n// *** DO NOT MODIFY BELOW THIS LINE ***\n\n//soft time logic \nvar optlytm = false; \nif(window.optimizely_tm >= optlytmb && window.optimizely_tm <= optlytme){\n\toptlytm = true;\n} \n \n//mutual exclusion logic \nvar optlyme = false; \nvar bucketsCookie = document.cookie.match("optimizelyBuckets=([^;]*)"); \nif (bucketsCookie) {\n\tvar bucketsString = decodeURIComponent(bucketsCookie[1]), bucketsJSON = $.parseJSON(bucketsString) || {}; \n\tfor (var i = 0; i < expArray.length; i++) { \n\t\tvar experimentId = expArray[i]; \n\t\tvar experimentAssigned = bucketsJSON.hasOwnProperty(experimentId), experimentBucketed = experimentAssigned ? bucketsJSON[experimentId] != 0 : !1; \n\t\tif (experimentBucketed) { \n\t\t\twindow.optimizely["__groupA"] = expArray[i]; \n\t\t\tbreak; \n\t\t} \n\t} \n} \nwindow.optimizely["__groupA"] = window.optimizely["__groupA"] || expArray[Math.floor(Math.random()*expArray.length)]; \noptlyme = window.optimizely["__groupA"] == currentExperimentId; \n\n//return val \n(optlytm && optlyme) || (optlyaovtm && optlyme)'},{values:[""],type:"cookies",names:["optly_apple_test"]},{values:[{match:"regex",value:"apple.com/(us$)|(us\\?revision=.*)"},{match:"regex",value:"apple.com/us/(mac)|(ipad)|(iphone)|(ipod)|(appletv)"},{match:"regex",value:"apple.com/us/search/.*"},{match:"regex",value:"apple.com/us/product/.*"},{match:"regex",value:"(apple.com/us/.*/.*-accessories/.*)|(apple.com/us/browse/home/collections/)|(apple.com/us/accessories/exclusives)"},{match:"regex",value:"apple.com/us/.*/.*-accessories"},{match:"regex",value:"apple.com/us/trending"},{match:"regex",value:"apple.com/us/buy-ip.d/ip.d.*(\\?|\\&)product=.*\\&step=engrave"}],type:"url"},{only_first_time:true,type:"visitor",value:"all"}],enabled_variation_ids:["829430799"],variation_weights:{"829430799":10000},variation_ids:["842170010","827521438","831760142","829430799"]},"698469559":{name:"maclatnavuscon140324 (1)",site_catalyst_evar:53,conditions:[{values:[{match:"regex",value:".apple.com/us.*mac"}],type:"url"},{only_first_time:true,type:"visitor",value:"all"}],enabled_variation_ids:["748231703","696726683"],variation_ids:["748231703","696726683"]}},click_goals:[{event_name:"nowtrendingclicks",experiments:{"698469559":true},selector:".tiles-12 > .tile-8"},{event_name:"educationclicks",experiments:{"698469559":true},selector:".tiles-12 > .tile-11"},{event_name:"smallbento-link",experiments:{"739950725":true},selector:"#coherent_id_41"},{event_name:"smallbento_clicks",experiments:{"739950725":true},selector:"#coherent_id_40"},{event_name:"ribbon_clicks",experiments:{"739950725":true},selector:".superlink-hover"},{event_name:"refurbclicks",experiments:{"698469559":true},selector:".tiles-12 > .tile-10"},{event_name:"banner-click",experiments:{"739950725":true},selector:"#coherent_id_16"},{event_name:"banner-link_clicks",experiments:{"739950725":true},selector:"#coherent_id_17"},{event_name:"communityclicks",experiments:{"698469559":true},selector:".tiles-12 > .tile-9"},{event_name:"businessclicks",experiments:{"698469559":true},selector:".tiles-12 > .tile-12"}],version:"www-master-1441.375394960321180055",admin_account_id:199382811,blacklisted_experiments:[655404545,556611080,559430159,572653074,550830613,429754394,432490013,441710114,550231078,552100394,555851308,586640430,547860021,529660487,551831114,556290636,787326544,867411538,536718009,590760537,569181276,585600501,537362040,403091579,575030409,799263882,553100940,594872465,545062546,547112090,521120413,541903525,787749030,555851432,539893941,791942329,568800955,758004414,574830785,382632132,551451336,545371850,547814606,546161878,590310103,543313630,579130085,538932967,531191528,389440236,537614573,591611121,589310194,592830202,431350526,539502335,524090625,554662659,521440470,592880940,540802007,555340556,745112848,553402135,589930287,692601120,536261084,582081322,521310507,557745452,554260271,541980470,537460036,587500357,555754314,872170315,542136654,537950034,552360277,404021590,538162528,538231137,567411555,569471334,585660264,576970605,540907374,524330356,550762385,713550227,555760538,552560542,581740479,554420646,538141614,538184113,554510324,586350011,538291189,581190597,399451078,539382217,758360013,592910288,549534162,547702743,566350811,542947804,696582944,546492387,545671140,594350565,432282599,569930218,651453010,543910382,674831343,570371568,631130100,545380341,902150649],www_host:"www.optimizely.com",project_id:341800575,segments:{"856540696":{name:"Trigger Manual Activation Call",api_name:"trigger_manual_activation_call_2_2_3_1",add_condition:[{type:"code",value:'window.optimizely.push(["activate"]);\nfalse;'},{only_first_time:true,type:"visitor",value:"all"}],id:856540696},"341793217":{name:"Source Type",segment_value_type:"source_type",api_name:"optimizely_source_type",id:341793217},"341824156":{name:"Browser",segment_value_type:"browser",api_name:"optimizely_browser",id:341824156},"341794206":{name:"Mobile Visitors",segment_value_type:"mobile",api_name:"optimizely_mobile",id:341794206},"341932127":{name:"Campaign",segment_value_type:"campaign",api_name:"optimizely_campaign",id:341932127}},revision:26});
