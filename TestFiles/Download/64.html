window.$P=function(){};(function(c,d,b,a,f){a.TrendingWidget=b.Control.extend({defaults:{listSelector:".trending-container",viewDetailSelector:".view-button-container a",productDetailsSelector:".product-details",tileSelector:".trending-container .tile",tileSelected:false,slideContainer:".slide-box",slides:"div.slides > div",slidesSelector:"div.slides",pageOffset:1,currentPage:b.compute(null),slideControlSelector:".slide-box-controls",slideBoxControllerButton:".slide-box-controls .control-button",data:null,seeAllSelector:".see-all a",pageName:c.s.pageName,slideTouchSelector:"div.slides.touch"}},{OMNITURE_FEATURE_NAME:"Trending Widget",OMNITURE_PROPERTY_NAME:"eVar6",keyboardHandler:b.compute(false),init:function(){this.renderTemplate();this.initSlideController();if(d.AsSupport.touch){d(this.options.slidesSelector).css("transform","translateX(0)")}},renderTemplate:function(){var i=this.options.data.results,h=i.viewType,j=this.element.find(this.options.listSelector),g;g=b.view("{{"+h+"}}",i);j.html(g)},"{slideBoxControllerButton} click":function(g,h){h.preventDefault()},initSlideController:function(){var i=b.compute(null),h=b.compute(null);var g=this;this.slideBox=new a.SlideBox(this.options.slideContainer,{currentPage:this.options.currentPage,numberOfPages:h,pageOffset:this.options.pageOffset,isDisabledWhileZoomed:true,isDefaultDraggingDisabled:false,defaultTransitionDuration:600,slides:this.options.slides,slidesContainer:this.options.slidesSelector,keyboardFlag:g.keyboardHandler,slideSelector:this.options.slideTouchSelector});this.controls=new a.SlideBoxNextPrevButtons(this.options.slideControlSelector,{currentPage:this.options.currentPage,numberOfPages:h,pageOffset:this.options.pageOffset,keyboardFlag:g.keyboardHandler,callback:b.proxy(this.fireOmnitureForArrow,this)})},keydown:function(g,h){this.keyboardHandler(true)},"{seeAllSelector} click":"showTrendingFeedPage","{currentPage} change":"currentPageChanged",currentPageChanged:function(j,g,i,h){if(d.AsSupport.touch){if(h!==f){d("div.slides > div:eq("+h+")").removeClass("visible")}d("div.slides > div:eq("+i+")").addClass("visible")}},"{viewDetailSelector} focus":function(g,h){g.parents(this.options.productDetailsSelector).addClass("focus")},"{viewDetailSelector} blur":function(g,h){g.parents(this.options.productDetailsSelector).removeClass("focus")},"{tileSelector} mouseleave":function(g,h){this.element.find(".product-details.focus").removeClass("focus");g.find(".view-button-container a").blur()},"{viewDetailSelector} click":function(i,j){if(d.AsSupport.touch&&!d(i).hasClass("enabled")){j.preventDefault();return}var g=j.metaKey||j.ctrlKey;if(!g){j.preventDefault()}var h=i.closest(".product-details");var k=b.data(h,"productData");b.ajax({url:k.info.clickThruUrl});a.Tracking.trackPage({eVar31:k.info.evarData});if(!g){c.setTimeout(function(){d.AsEnv.doRedirect(k.info.url)},500)}},"{viewDetailSelector} touchstart":function(g,h){if(!this.options.tileSelected){h.preventDefault()}},"{tileSelector} touchmove":function(g,h){this.touchmove=true},"{tileSelector} touchend":function(i,m){if(!this.touchmove){var l=d(i).data("lastTouch")||0,h=new Date().getTime(),n=h-l;if(n>20&&n<500){d(i).data("lastTouch",0);m.stopPropagation()}else{var k=this;d(i).data("lastTouch",h);var g=d(i).hasClass("display-trending-info");var j=this.element.find(".trending-container .tile.display-trending-info");if(j){j.find(this.options.productDetailsSelector).removeClass("show");c.setTimeout(function(){j.removeClass("display-trending-info")},500)}this.element.find(".view-button-container a.enabled").removeClass("enabled");if(!g){d(i).addClass("display-trending-info");c.setTimeout(function(){d(i).find(k.options.productDetailsSelector).addClass("show")},10);this.options.tileSelected=true;m.stopPropagation();c.setTimeout(function(){d(i).find(".view-button-container a").addClass("enabled")},500)}else{this.options.tileSelected=false;d(i).find(".view-button-container a").addClass("enabled");m.stopPropagation()}}}this.touchmove=false},"{document.body} touchend":function(h,g){if(this.options.tileSelected){var i=this.element.find(".trending-container .tile.display-trending-info");if(i){i.find(this.options.productDetailsSelector).removeClass("show");c.setTimeout(function(){i.removeClass("display-trending-info")},500)}this.options.tileSelected=false}},fireOmnitureForArrow:function(h,i){var g={};if(h&&h.hasClass("next")){g.action="Right Arrow"}else{if(h&&h.hasClass("previous")){g.action="Left Arrow"}}this.fireEvent(g)},showTrendingFeedPage:function(h,i){var g=i.metaKey||i.ctrlKey;if(!g){i.preventDefault()}this.fireEvent({action:"See All"});if(!g){c.setTimeout(function(){c.location.href=h.attr("href")},500)}},fireEvent:function(g){g=g||{action:"unknown"};g.eVar=this.OMNITURE_PROPERTY_NAME;g.page=this.options.pageName;g.feature=this.OMNITURE_FEATURE_NAME;d.AsMetrics.fireMicroEvent(g)}})})(this,jQuery,can,as);(function(c,d,b,a,f){a.SlideBox=b.Control.extend({defaults:{containerWidth:978,touchDragThreshold:70,touchMinSnapbackTime:10,touchMaxSnapbackTime:200,touchMaxVelocity:0,timePerTabKey:100,transitionDuration:500,defaultTransitionDuration:0,resistance:0.38,transitionEnd:d.AsSupport.transitionEndName,isDefaultDraggingDisabled:true,isDisabledWhileZoomed:false,currentPage:b.compute(null),numberOfPages:b.compute(null),keyboardFlag:b.compute(false),pageOffset:1,slidesContainer:" > ul",slides:" > ul > li",slideSelector:"ul.touch"}},{cssTransition:false,lastTabTime:0,tabLockedUntil:0,calculatePosition:function(g){return -1*this._points[g]},isClick:false,init:function(){this._points=[];this.slidesContainer=this.element.find(this.options.slidesContainer);this.slides=this.element.find(this.options.slides);this.totalSlides=this.slides.size();this.touch.timing=this.options.transitionDuration;this.options.currentPage(0);if(d.AsSupport.transition&&d.AsSupport.transform){this.cssTransition=true}if(d.AsSupport.isMobileIos||d.AsSupport.isIpad||d.AsSupport.isAndroidMobile){this.element.addClass("touch");this.slidesContainer.addClass("touch");this.touchMode=true}this.reset();this.calculateTransitionPoints()},calculateTransitionPoints:function(){var h=this,j=(this.slidesContainer.offset())?this.slidesContainer.offset().left:0,g=0,i=[],k;d.each(this.slides,function(m,l){g=d(l).offset().left-j;i.push(g)});if(this.totalSlides>0){k=g+d(this.slides[this.totalSlides-1]).outerWidth()-this.element.outerWidth()}d.each(i,function(m,l){if(l<k){h._points.push(parseInt(l,10))}});if(k>0){this._points.push(parseInt(k,10))}this.options.numberOfPages(this._points.length)},"{window} pageshow":"reset",reset:function(){this.touch.transition=false;this.touch={id:null,sX:0,sY:0,eX:null,eY:null,eT:null,v:[0,0,0],timing:500,lastOffset:null,transitionTimer:null,otherTouches:false}},"li mousedown":function(g,h){this.isClick=true},"li focus":function(i,k){if(!this.isClick){var j=this.slidesContainer.offset().left,g=i.offset().left-j,h=this.getPageForOffset(g);if(h!==null){this.options.currentPage(h)}}this.isClick=false}," scroll":function(h,g){g.preventDefault();g.stopPropagation();this.element.prop("scrollLeft",0)},touch:{id:null,sX:0,sY:0,eX:null,eY:null,eT:null,v:[0,0,0],timing:500,lastOffset:null,transitionTimer:null,otherTouches:false},touchMode:false,"{document} touchstart":"updateOtherTouches","{document} touchend":"updateOtherTouches","{slideSelector} touchstart":"touchMoved","{slideSelector} touchmove":"touchMoved","{slideSelector} touchend":"touchMoved","{slideSelector} touchcancel":"touchMoved",touchSlide:function(h,j){var i=this.calculatePosition(j);this.touch.transition=true;if(this.touch.lastOffset!==null){var g=(this.options.touchMaxSnapbackTime-this.options.touchMinSnapbackTime);var k=1-(Math.abs(i-this.touch.lastOffset)/this.options.containerWidth);k=k*g+this.options.touchMaxSnapbackTime;this.touch.timing=k;this.touch.lastOffset=null}var l=this.touch.timing+"ms";h.css("transitionDuration",l);h.css("transform","translateX("+i+"px)");this.touch.transitionTimer=(new Date()).getTime()+(this.options.defaultTransitionDuration>this.touch.timing?this.options.defaultTransitionDuration:this.touch.timing)},updateOtherTouches:function(h,i){var g=i.originalEvent;this.touch.otherTouches=g.touches&&g.touches.length>1},touchMoved:function(g,i){if(this.options.numberOfPages()<=1||(this.options.isDisabledWhileZoomed&&this.isZoomed())){return}var o=i.originalEvent;var n=o.touches&&o.touches.length===1&&!this.touch.otherTouches;var k=false;if(i.type==="touchmove"&&n&&this.options.isDefaultDraggingDisabled){i.preventDefault()}var q=this.touch.id;var m=this.options.currentPage();if((new Date()).getTime()>this.touch.transitionTimer){this.touch.transition=false}if(this.touch.transition){return}var h=this.touch.eX;this.updateCoordinatesAndVelocity(o,n);var j=this.calculateDeltaOffset(h);var p=this.calculateVerticalOffset();if((Math.abs(p)<Math.abs(j)||Math.abs(j)>5)&&!this.options.isDefaultDraggingDisabled){i.preventDefault()}if(this.touch.id!==null&&this.touch.eX){var l=this.calculatePosition(m);this.touch.lastOffset=l+j;g.css("transform","translateX("+this.touch.lastOffset+"px)");if(l<0&&Math.abs(l)<j){this.touch.lastOffset=0}}if(this.touch.id===null&&q!==null){this.snapToPage(g,i,j)}},updateCoordinatesAndVelocity:function(h,p){var o=this.touch.eX,g=this.touch.eT;if(this.touch.id===null&&p){this.touch.id=h.touches[0].identifier;this.touch.sX=h.touches[0].pageX;this.touch.sY=h.touches[0].pageY}else{if(p){var n=false;for(var l=0;l<h.touches.length;l++){if(this.touch.id===h.touches[l].identifier){n=true;this.touch.eX=h.touches[l].pageX;this.touch.eY=h.touches[l].pageY;break}}if(!n){this.touch.id=null;this.touch.eX=null;this.touch.eY=null}}else{if(!h.touches||!p){this.touch.id=null;this.touch.eX=null;this.touch.eY=null}}}this.touch.eT=(new Date()).getTime()/1000;if(this.touch.eX&&o&&g){var m=(this.touch.eX-o)/(this.touch.eT-g);for(var k=this.touch.v.length-1;k>=0;k-=1){if(k===0){this.touch.v[k]=m}else{this.touch.v[k]=this.touch.v[k-1]}}}},calculateDeltaOffset:function(h){h=(h===null)?this.touch.sX:h;var k=this.touch.eX?this.touch.eX:h;var g=(k!==0)?k-this.touch.sX:this.touch.sX;var i=this.options.currentPage();var m=this.options.numberOfPages();var j=this.options.containerWidth;if((i===0&&g>0)||(i+1===m&&g<0)){var l=g<0?-1:1;g=Math.min(Math.abs(g),j);g=Math.min(this.options.resistance*j*Math.sin(Math.PI*g/(2*j)),g);g=g*l}return g},calculateVerticalOffset:function(){var h=this.touch.eY;var g=(h!==null)?h-this.touch.sY:0;var i=this.options.containerWidth;var j=g<0?-1:1;g=Math.min(Math.abs(g),i);g=Math.min(this.options.resistance*i*Math.sin(Math.PI*g/(2*i)),g);g=g*j;return g},getPageForOffset:function(k,j){var l=this._points.length,g;for(var h=l;h>=0;h--){if(k===this._points[h]){return h}else{if(k>this._points[h]){if(h===l-1){return l-1}else{g=(j)?this._points[h]+this.options.touchDragThreshold:this._points[h+1]-this.options.touchDragThreshold;return(k>=g)?(h+1):h}}}}return 0},snapToPage:function(l,n,m){var k=this.options.currentPage(),o=this.options.numberOfPages(),g,j=0;this.touch.sX=null;this.touch.sY=null;for(var h=0;h<this.touch.v.length;h+=1){j+=this.touch.v[h];this.touch.v[h]=0}j=j/this.touch.v.length;if(m<0&&k+1<o){n.preventDefault();g=this.getPageForOffset(Math.abs(this.touch.lastOffset),true);this.options.currentPage(g);if(g===k){this.touchSlide(l,this.options.currentPage())}}else{if(k-1>=0&&m>0){n.preventDefault();g=this.getPageForOffset(Math.abs(this.touch.lastOffset),false);this.options.currentPage(g);if(g===k){this.touchSlide(l,this.options.currentPage())}}else{this.touchSlide(l,this.options.currentPage())}}},"{slideSelector} {transitionEnd}":function(h,g){if(h[0]!==g.target){return}this.touch.transition=false;h.css("transitionDuration","0s")},"{currentPage} change":"currentPageChanged",currentPageChanged:function(k,g,i,h){if(!this.touchMode){this.slide(i)}else{var j=this.element.find(this.options.slideSelector);if(j&&j.length>0){this.touchSlide(j,i)}}},slide:function(i){var h=this.options.numberOfPages()>1;var g=this.calculatePosition(i);if(this.options.keyboardFlag()){h=false}if(this.cssTransition){this.slidesContainer.css("transitionDuration",h?this.options.transitionDuration+"ms":"0s");this.slidesContainer.css("transform","translateX("+g+"px)")}else{if(h){this.slidesContainer.animate({left:g},this.options.transitionDuration)}else{this.slidesContainer.css("left",g+"px")}}this.tabLockedUntil=(new Date()).getTime()+this.options.transitionDuration},isZoomed:function(){return(document.documentElement.clientWidth/c.innerWidth)>1}})}(this,jQuery,can,as));(function(c,d,b,a,f){a.SlideBoxNextPrevButtons=b.Control.extend({defaults:{nextButtonSelector:".next",previousButtonSelector:".previous",inactiveButtonClass:"inactive",currentPage:b.compute(null),numberOfPages:b.compute(null),pageOffset:1,keyboardFlag:b.compute(false),callback:b.noop}},{init:function(){this.nextButton=this.element.find(this.options.nextButtonSelector);this.previousButton=this.element.find(this.options.previousButtonSelector);this.updateButtons(null,null,this.options.currentPage())},"{nextButtonSelector} click":"nextPage","{previousButtonSelector} click":"previousPage","{currentPage} change":"updateButtons",nextPage:function(h,i){this.options.keyboardFlag(false);var g=this.options.currentPage(),j=this.options.numberOfPages();if(g<j-this.options.pageOffset){this.options.currentPage(g+this.options.pageOffset)}else{if(g<j-1){this.options.currentPage(g+(j-1)-g)}}this.options.callback(h,i)},previousPage:function(h,i){this.options.keyboardFlag(false);var g=this.options.currentPage();if(g>0){this.options.currentPage(g-this.options.pageOffset);if(g-this.options.pageOffset<0){this.options.currentPage(0)}}this.options.callback(h,i)},updateButtons:function(h,i,g){if(g<this.options.numberOfPages()-this.options.pageOffset){this.activate(this.nextButton)}else{if(g<this.options.numberOfPages()-1){this.activate(this.nextButton)}else{this.deActivate(this.nextButton)}}if(g>0){this.activate(this.previousButton)}else{this.deActivate(this.previousButton)}},activate:function(g){if(d(g).prop("tagName")==="A"){d(g).removeClass(this.options.inactiveButtonClass).attr("aria-hidden",false).removeAttr("tabindex")}else{d(g).prop("disabled",false).removeClass(this.options.inactiveButtonClass)}},deActivate:function(g){if(d(g).prop("tagName")==="A"){d(g).addClass(this.options.inactiveButtonClass).attr("aria-hidden",true).attr("tabindex",-1)}else{d(g).prop("disabled",true).addClass(this.options.inactiveButtonClass)}}})}(this,jQuery,can,as));
